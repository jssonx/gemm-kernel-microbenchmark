Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 9.72 MB
Max memory reserved: 22.00 MB
Average grouped_gemm time: 62.728 μs

======================
Average nn.Linear time: 153.329 μs
Average a @ b time: 81.642 μs
Average bmm time: 20.130 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.444
Speedup (a @ b / grouped_gemm): 1.302
Speedup (bmm / grouped_gemm): 0.321

======================
TFLOPS (grouped_gemm): 0.144
TFLOPS (nn.Linear): 0.059
TFLOPS (a @ b): 0.111
TFLOPS (bmm): 0.449

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 11.11 MB
Max memory reserved: 24.00 MB
Average grouped_gemm time: 61.944 μs

======================
Average nn.Linear time: 151.434 μs
Average a @ b time: 83.354 μs
Average bmm time: 21.167 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.445
Speedup (a @ b / grouped_gemm): 1.346
Speedup (bmm / grouped_gemm): 0.342

======================
TFLOPS (grouped_gemm): 0.224
TFLOPS (nn.Linear): 0.092
TFLOPS (a @ b): 0.167
TFLOPS (bmm): 0.656

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 14.21 MB
Max memory reserved: 26.00 MB
Average grouped_gemm time: 62.826 μs

======================
Average nn.Linear time: 152.583 μs
Average a @ b time: 81.518 μs
Average bmm time: 22.287 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.429
Speedup (a @ b / grouped_gemm): 1.298
Speedup (bmm / grouped_gemm): 0.355

======================
TFLOPS (grouped_gemm): 0.572
TFLOPS (nn.Linear): 0.235
TFLOPS (a @ b): 0.441
TFLOPS (bmm): 1.611

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 20.63 MB
Max memory reserved: 30.00 MB
Average grouped_gemm time: 71.161 μs

======================
Average nn.Linear time: 163.062 μs
Average a @ b time: 87.194 μs
Average bmm time: 23.468 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.291
Speedup (a @ b / grouped_gemm): 1.225
Speedup (bmm / grouped_gemm): 0.330

======================
TFLOPS (grouped_gemm): 1.194
TFLOPS (nn.Linear): 0.521
TFLOPS (a @ b): 0.974
TFLOPS (bmm): 3.619

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 32.68 MB
Max memory reserved: 34.00 MB
Average grouped_gemm time: 79.620 μs

======================
Average nn.Linear time: 153.425 μs
Average a @ b time: 80.509 μs
Average bmm time: 28.462 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.927
Speedup (a @ b / grouped_gemm): 1.011
Speedup (bmm / grouped_gemm): 0.357

======================
TFLOPS (grouped_gemm): 2.015
TFLOPS (nn.Linear): 1.046
TFLOPS (a @ b): 1.993
TFLOPS (bmm): 5.637

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 54.96 MB
Max memory reserved: 70.00 MB
Average grouped_gemm time: 95.103 μs

======================
Average nn.Linear time: 151.627 μs
Average a @ b time: 80.745 μs
Average bmm time: 33.743 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.594
Speedup (a @ b / grouped_gemm): 0.849
Speedup (bmm / grouped_gemm): 0.355

======================
TFLOPS (grouped_gemm): 2.470
TFLOPS (nn.Linear): 1.549
TFLOPS (a @ b): 2.909
TFLOPS (bmm): 6.961

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 98.97 MB
Max memory reserved: 132.00 MB
Average grouped_gemm time: 133.281 μs

======================
Average nn.Linear time: 152.545 μs
Average a @ b time: 92.039 μs
Average bmm time: 52.509 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.145
Speedup (a @ b / grouped_gemm): 0.691
Speedup (bmm / grouped_gemm): 0.394

======================
TFLOPS (grouped_gemm): 5.783
TFLOPS (nn.Linear): 5.052
TFLOPS (a @ b): 8.374
TFLOPS (bmm): 14.677

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 98.97 MB
Max memory reserved: 132.00 MB
Average grouped_gemm time: 78.833 μs

======================
Average nn.Linear time: 152.218 μs
Average a @ b time: 88.813 μs
Average bmm time: 22.871 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.931
Speedup (a @ b / grouped_gemm): 1.127
Speedup (bmm / grouped_gemm): 0.290

======================
TFLOPS (grouped_gemm): 0.434
TFLOPS (nn.Linear): 0.225
TFLOPS (a @ b): 0.385
TFLOPS (bmm): 1.496

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 98.97 MB
Max memory reserved: 132.00 MB
Average grouped_gemm time: 78.902 μs

======================
Average nn.Linear time: 176.477 μs
Average a @ b time: 97.542 μs
Average bmm time: 23.077 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.237
Speedup (a @ b / grouped_gemm): 1.236
Speedup (bmm / grouped_gemm): 0.292

======================
TFLOPS (grouped_gemm): 1.316
TFLOPS (nn.Linear): 0.588
TFLOPS (a @ b): 1.064
TFLOPS (bmm): 4.498

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 98.97 MB
Max memory reserved: 132.00 MB
Average grouped_gemm time: 78.797 μs

======================
Average nn.Linear time: 149.775 μs
Average a @ b time: 83.995 μs
Average bmm time: 27.070 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.901
Speedup (a @ b / grouped_gemm): 1.066
Speedup (bmm / grouped_gemm): 0.344

======================
TFLOPS (grouped_gemm): 1.836
TFLOPS (nn.Linear): 0.966
TFLOPS (a @ b): 1.723
TFLOPS (bmm): 5.346

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 98.97 MB
Max memory reserved: 132.00 MB
Average grouped_gemm time: 102.806 μs

======================
Average nn.Linear time: 150.383 μs
Average a @ b time: 80.206 μs
Average bmm time: 32.578 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.463
Speedup (a @ b / grouped_gemm): 0.780
Speedup (bmm / grouped_gemm): 0.317

======================
TFLOPS (grouped_gemm): 4.161
TFLOPS (nn.Linear): 2.845
TFLOPS (a @ b): 5.334
TFLOPS (bmm): 13.132

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 117.93 MB
Max memory reserved: 180.00 MB
Average grouped_gemm time: 123.086 μs

======================
Average nn.Linear time: 147.536 μs
Average a @ b time: 88.603 μs
Average bmm time: 55.101 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.199
Speedup (a @ b / grouped_gemm): 0.720
Speedup (bmm / grouped_gemm): 0.448

======================
TFLOPS (grouped_gemm): 7.156
TFLOPS (nn.Linear): 5.970
TFLOPS (a @ b): 9.941
TFLOPS (bmm): 15.985

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 227.59 MB
Max memory reserved: 312.00 MB
Average grouped_gemm time: 168.753 μs

======================
Average nn.Linear time: 153.739 μs
Average a @ b time: 169.249 μs
Average bmm time: 86.040 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.911
Speedup (a @ b / grouped_gemm): 1.003
Speedup (bmm / grouped_gemm): 0.510

======================
TFLOPS (grouped_gemm): 10.961
TFLOPS (nn.Linear): 12.031
TFLOPS (a @ b): 10.929
TFLOPS (bmm): 21.498

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 391.35 MB
Max memory reserved: 566.00 MB
Average grouped_gemm time: 258.868 μs

======================
Average nn.Linear time: 156.696 μs
Average a @ b time: 200.868 μs
Average bmm time: 151.598 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.605
Speedup (a @ b / grouped_gemm): 0.776
Speedup (bmm / grouped_gemm): 0.586

======================
TFLOPS (grouped_gemm): 11.994
TFLOPS (nn.Linear): 19.814
TFLOPS (a @ b): 15.457
TFLOPS (bmm): 20.481

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 391.35 MB
Max memory reserved: 566.00 MB
Average grouped_gemm time: 152.416 μs

======================
Average nn.Linear time: 176.888 μs
Average a @ b time: 103.788 μs
Average bmm time: 32.995 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.161
Speedup (a @ b / grouped_gemm): 0.681
Speedup (bmm / grouped_gemm): 0.216

======================
TFLOPS (grouped_gemm): 1.926
TFLOPS (nn.Linear): 1.660
TFLOPS (a @ b): 2.829
TFLOPS (bmm): 8.898

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 391.35 MB
Max memory reserved: 566.00 MB
Average grouped_gemm time: 153.255 μs

======================
Average nn.Linear time: 178.168 μs
Average a @ b time: 109.448 μs
Average bmm time: 39.706 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.163
Speedup (a @ b / grouped_gemm): 0.714
Speedup (bmm / grouped_gemm): 0.259

======================
TFLOPS (grouped_gemm): 3.695
TFLOPS (nn.Linear): 3.178
TFLOPS (a @ b): 5.173
TFLOPS (bmm): 14.261

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 391.35 MB
Max memory reserved: 566.00 MB
Average grouped_gemm time: 154.612 μs

======================
Average nn.Linear time: 178.106 μs
Average a @ b time: 125.082 μs
Average bmm time: 64.619 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.152
Speedup (a @ b / grouped_gemm): 0.809
Speedup (bmm / grouped_gemm): 0.418

======================
TFLOPS (grouped_gemm): 6.945
TFLOPS (nn.Linear): 6.029
TFLOPS (a @ b): 8.584
TFLOPS (bmm): 16.617

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 391.35 MB
Max memory reserved: 566.00 MB
Average grouped_gemm time: 256.686 μs

======================
Average nn.Linear time: 176.330 μs
Average a @ b time: 173.550 μs
Average bmm time: 111.496 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.687
Speedup (a @ b / grouped_gemm): 0.676
Speedup (bmm / grouped_gemm): 0.434

======================
TFLOPS (grouped_gemm): 8.432
TFLOPS (nn.Linear): 12.274
TFLOPS (a @ b): 12.471
TFLOPS (bmm): 19.411

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 561.38 MB
Max memory reserved: 886.00 MB
Average grouped_gemm time: 359.623 μs

======================
Average nn.Linear time: 192.668 μs
Average a @ b time: 224.228 μs
Average bmm time: 184.214 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.536
Speedup (a @ b / grouped_gemm): 0.624
Speedup (bmm / grouped_gemm): 0.512

======================
TFLOPS (grouped_gemm): 13.622
TFLOPS (nn.Linear): 25.427
TFLOPS (a @ b): 21.848
TFLOPS (bmm): 26.594

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1111.15 MB
Max memory reserved: 1654.00 MB
Average grouped_gemm time: 568.042 μs

======================
Average nn.Linear time: 409.460 μs
Average a @ b time: 399.764 μs
Average bmm time: 338.125 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.721
Speedup (a @ b / grouped_gemm): 0.704
Speedup (bmm / grouped_gemm): 0.595

======================
TFLOPS (grouped_gemm): 10.987
TFLOPS (nn.Linear): 15.242
TFLOPS (a @ b): 15.612
TFLOPS (bmm): 18.458

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 979.936 μs

======================
Average nn.Linear time: 666.735 μs
Average a @ b time: 657.845 μs
Average bmm time: 678.313 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.680
Speedup (a @ b / grouped_gemm): 0.671
Speedup (bmm / grouped_gemm): 0.692

======================
TFLOPS (grouped_gemm): 16.778
TFLOPS (nn.Linear): 24.660
TFLOPS (a @ b): 24.993
TFLOPS (bmm): 24.239

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 61.462 μs

======================
Average nn.Linear time: 155.580 μs
Average a @ b time: 82.009 μs
Average bmm time: 18.899 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.531
Speedup (a @ b / grouped_gemm): 1.334
Speedup (bmm / grouped_gemm): 0.307

======================
TFLOPS (grouped_gemm): 0.318
TFLOPS (nn.Linear): 0.126
TFLOPS (a @ b): 0.238
TFLOPS (bmm): 1.033

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 60.370 μs

======================
Average nn.Linear time: 154.152 μs
Average a @ b time: 82.362 μs
Average bmm time: 20.168 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.553
Speedup (a @ b / grouped_gemm): 1.364
Speedup (bmm / grouped_gemm): 0.334

======================
TFLOPS (grouped_gemm): 0.467
TFLOPS (nn.Linear): 0.183
TFLOPS (a @ b): 0.342
TFLOPS (bmm): 1.397

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 59.972 μs

======================
Average nn.Linear time: 166.388 μs
Average a @ b time: 89.467 μs
Average bmm time: 21.195 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.774
Speedup (a @ b / grouped_gemm): 1.492
Speedup (bmm / grouped_gemm): 0.353

======================
TFLOPS (grouped_gemm): 0.796
TFLOPS (nn.Linear): 0.287
TFLOPS (a @ b): 0.533
TFLOPS (bmm): 2.251

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 65.916 μs

======================
Average nn.Linear time: 152.755 μs
Average a @ b time: 80.700 μs
Average bmm time: 25.587 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.317
Speedup (a @ b / grouped_gemm): 1.224
Speedup (bmm / grouped_gemm): 0.388

======================
TFLOPS (grouped_gemm): 2.521
TFLOPS (nn.Linear): 1.088
TFLOPS (a @ b): 2.059
TFLOPS (bmm): 6.495

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 73.073 μs

======================
Average nn.Linear time: 152.659 μs
Average a @ b time: 79.770 μs
Average bmm time: 31.645 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.089
Speedup (a @ b / grouped_gemm): 1.092
Speedup (bmm / grouped_gemm): 0.433

======================
TFLOPS (grouped_gemm): 3.372
TFLOPS (nn.Linear): 1.614
TFLOPS (a @ b): 3.089
TFLOPS (bmm): 7.787

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 88.532 μs

======================
Average nn.Linear time: 152.357 μs
Average a @ b time: 80.945 μs
Average bmm time: 31.106 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.721
Speedup (a @ b / grouped_gemm): 0.914
Speedup (bmm / grouped_gemm): 0.351

======================
TFLOPS (grouped_gemm): 7.485
TFLOPS (nn.Linear): 4.350
TFLOPS (a @ b): 8.187
TFLOPS (bmm): 21.304

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 118.682 μs

======================
Average nn.Linear time: 155.325 μs
Average a @ b time: 88.530 μs
Average bmm time: 54.049 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.309
Speedup (a @ b / grouped_gemm): 0.746
Speedup (bmm / grouped_gemm): 0.455

======================
TFLOPS (grouped_gemm): 6.834
TFLOPS (nn.Linear): 5.222
TFLOPS (a @ b): 9.162
TFLOPS (bmm): 15.006

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 75.052 μs

======================
Average nn.Linear time: 165.961 μs
Average a @ b time: 90.168 μs
Average bmm time: 21.203 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.211
Speedup (a @ b / grouped_gemm): 1.201
Speedup (bmm / grouped_gemm): 0.283

======================
TFLOPS (grouped_gemm): 0.954
TFLOPS (nn.Linear): 0.431
TFLOPS (a @ b): 0.794
TFLOPS (bmm): 3.375

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 76.001 μs

======================
Average nn.Linear time: 181.484 μs
Average a @ b time: 101.013 μs
Average bmm time: 22.082 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.388
Speedup (a @ b / grouped_gemm): 1.329
Speedup (bmm / grouped_gemm): 0.291

======================
TFLOPS (grouped_gemm): 2.463
TFLOPS (nn.Linear): 1.031
TFLOPS (a @ b): 1.853
TFLOPS (bmm): 8.476

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 76.253 μs

======================
Average nn.Linear time: 154.891 μs
Average a @ b time: 82.262 μs
Average bmm time: 26.736 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.031
Speedup (a @ b / grouped_gemm): 1.079
Speedup (bmm / grouped_gemm): 0.351

======================
TFLOPS (grouped_gemm): 7.364
TFLOPS (nn.Linear): 3.625
TFLOPS (a @ b): 6.826
TFLOPS (bmm): 21.002

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 98.236 μs

======================
Average nn.Linear time: 152.628 μs
Average a @ b time: 80.218 μs
Average bmm time: 35.391 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.554
Speedup (a @ b / grouped_gemm): 0.817
Speedup (bmm / grouped_gemm): 0.360

======================
TFLOPS (grouped_gemm): 12.809
TFLOPS (nn.Linear): 8.244
TFLOPS (a @ b): 15.686
TFLOPS (bmm): 35.554

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 122.688 μs

======================
Average nn.Linear time: 146.689 μs
Average a @ b time: 89.211 μs
Average bmm time: 58.124 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.196
Speedup (a @ b / grouped_gemm): 0.727
Speedup (bmm / grouped_gemm): 0.474

======================
TFLOPS (grouped_gemm): 13.692
TFLOPS (nn.Linear): 11.452
TFLOPS (a @ b): 18.830
TFLOPS (bmm): 28.901

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 169.904 μs

======================
Average nn.Linear time: 176.215 μs
Average a @ b time: 203.235 μs
Average bmm time: 88.358 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.037
Speedup (a @ b / grouped_gemm): 1.196
Speedup (bmm / grouped_gemm): 0.520

======================
TFLOPS (grouped_gemm): 17.108
TFLOPS (nn.Linear): 16.495
TFLOPS (a @ b): 14.302
TFLOPS (bmm): 32.896

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 258.782 μs

======================
Average nn.Linear time: 156.505 μs
Average a @ b time: 197.852 μs
Average bmm time: 157.101 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.605
Speedup (a @ b / grouped_gemm): 0.765
Speedup (bmm / grouped_gemm): 0.607

======================
TFLOPS (grouped_gemm): 15.827
TFLOPS (nn.Linear): 26.170
TFLOPS (a @ b): 20.701
TFLOPS (bmm): 26.071

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 152.528 μs

======================
Average nn.Linear time: 176.184 μs
Average a @ b time: 101.318 μs
Average bmm time: 32.725 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.155
Speedup (a @ b / grouped_gemm): 0.664
Speedup (bmm / grouped_gemm): 0.215

======================
TFLOPS (grouped_gemm): 3.891
TFLOPS (nn.Linear): 3.369
TFLOPS (a @ b): 5.858
TFLOPS (bmm): 18.136

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 153.165 μs

======================
Average nn.Linear time: 174.482 μs
Average a @ b time: 110.943 μs
Average bmm time: 41.623 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.139
Speedup (a @ b / grouped_gemm): 0.724
Speedup (bmm / grouped_gemm): 0.272

======================
TFLOPS (grouped_gemm): 6.189
TFLOPS (nn.Linear): 5.433
TFLOPS (a @ b): 8.544
TFLOPS (bmm): 22.774

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 154.634 μs

======================
Average nn.Linear time: 171.230 μs
Average a @ b time: 129.423 μs
Average bmm time: 67.539 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.107
Speedup (a @ b / grouped_gemm): 0.837
Speedup (bmm / grouped_gemm): 0.437

======================
TFLOPS (grouped_gemm): 15.786
TFLOPS (nn.Linear): 14.256
TFLOPS (a @ b): 18.861
TFLOPS (bmm): 36.143

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 256.298 μs

======================
Average nn.Linear time: 177.443 μs
Average a @ b time: 182.247 μs
Average bmm time: 117.414 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.692
Speedup (a @ b / grouped_gemm): 0.711
Speedup (bmm / grouped_gemm): 0.458

======================
TFLOPS (grouped_gemm): 19.900
TFLOPS (nn.Linear): 28.743
TFLOPS (a @ b): 27.985
TFLOPS (bmm): 43.438

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 360.398 μs

======================
Average nn.Linear time: 199.494 μs
Average a @ b time: 225.325 μs
Average bmm time: 190.012 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.554
Speedup (a @ b / grouped_gemm): 0.625
Speedup (bmm / grouped_gemm): 0.527

======================
TFLOPS (grouped_gemm): 19.831
TFLOPS (nn.Linear): 35.826
TFLOPS (a @ b): 31.719
TFLOPS (bmm): 37.614

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1940.70 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 572.283 μs

======================
Average nn.Linear time: 411.775 μs
Average a @ b time: 403.905 μs
Average bmm time: 349.207 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.720
Speedup (a @ b / grouped_gemm): 0.706
Speedup (bmm / grouped_gemm): 0.610

======================
TFLOPS (grouped_gemm): 27.792
TFLOPS (nn.Linear): 38.625
TFLOPS (a @ b): 39.378
TFLOPS (bmm): 45.545

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 990.038 μs

======================
Average nn.Linear time: 676.498 μs
Average a @ b time: 667.779 μs
Average bmm time: 690.210 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.683
Speedup (a @ b / grouped_gemm): 0.674
Speedup (bmm / grouped_gemm): 0.697

======================
TFLOPS (grouped_gemm): 33.807
TFLOPS (nn.Linear): 49.476
TFLOPS (a @ b): 50.122
TFLOPS (bmm): 48.493

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 59.412 μs

======================
Average nn.Linear time: 165.272 μs
Average a @ b time: 87.483 μs
Average bmm time: 19.886 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.782
Speedup (a @ b / grouped_gemm): 1.472
Speedup (bmm / grouped_gemm): 0.335

======================
TFLOPS (grouped_gemm): 0.506
TFLOPS (nn.Linear): 0.182
TFLOPS (a @ b): 0.344
TFLOPS (bmm): 1.513

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 59.927 μs

======================
Average nn.Linear time: 156.972 μs
Average a @ b time: 83.258 μs
Average bmm time: 21.477 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.619
Speedup (a @ b / grouped_gemm): 1.389
Speedup (bmm / grouped_gemm): 0.358

======================
TFLOPS (grouped_gemm): 0.934
TFLOPS (nn.Linear): 0.357
TFLOPS (a @ b): 0.672
TFLOPS (bmm): 2.606

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 60.534 μs

======================
Average nn.Linear time: 156.484 μs
Average a @ b time: 81.503 μs
Average bmm time: 25.048 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.585
Speedup (a @ b / grouped_gemm): 1.346
Speedup (bmm / grouped_gemm): 0.414

======================
TFLOPS (grouped_gemm): 2.373
TFLOPS (nn.Linear): 0.918
TFLOPS (a @ b): 1.763
TFLOPS (bmm): 5.735

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 2998.00 MB
Average grouped_gemm time: 67.675 μs

======================
Average nn.Linear time: 155.904 μs
Average a @ b time: 81.329 μs
Average bmm time: 31.531 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.304
Speedup (a @ b / grouped_gemm): 1.202
Speedup (bmm / grouped_gemm): 0.466

======================
TFLOPS (grouped_gemm): 4.703
TFLOPS (nn.Linear): 2.041
TFLOPS (a @ b): 3.913
TFLOPS (bmm): 10.093

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 74.468 μs

======================
Average nn.Linear time: 151.577 μs
Average a @ b time: 79.975 μs
Average bmm time: 44.003 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.035
Speedup (a @ b / grouped_gemm): 1.074
Speedup (bmm / grouped_gemm): 0.591

======================
TFLOPS (grouped_gemm): 7.801
TFLOPS (nn.Linear): 3.832
TFLOPS (a @ b): 7.264
TFLOPS (bmm): 13.202

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 88.630 μs

======================
Average nn.Linear time: 152.454 μs
Average a @ b time: 82.202 μs
Average bmm time: 39.046 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.720
Speedup (a @ b / grouped_gemm): 0.927
Speedup (bmm / grouped_gemm): 0.441

======================
TFLOPS (grouped_gemm): 9.607
TFLOPS (nn.Linear): 5.585
TFLOPS (a @ b): 10.358
TFLOPS (bmm): 21.806

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 122.418 μs

======================
Average nn.Linear time: 153.332 μs
Average a @ b time: 110.071 μs
Average bmm time: 63.896 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.253
Speedup (a @ b / grouped_gemm): 0.899
Speedup (bmm / grouped_gemm): 0.522

======================
TFLOPS (grouped_gemm): 21.405
TFLOPS (nn.Linear): 17.090
TFLOPS (a @ b): 23.806
TFLOPS (bmm): 41.010

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 73.810 μs

======================
Average nn.Linear time: 180.728 μs
Average a @ b time: 106.072 μs
Average bmm time: 21.863 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.449
Speedup (a @ b / grouped_gemm): 1.437
Speedup (bmm / grouped_gemm): 0.296

======================
TFLOPS (grouped_gemm): 2.919
TFLOPS (nn.Linear): 1.192
TFLOPS (a @ b): 2.031
TFLOPS (bmm): 9.856

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 75.266 μs

======================
Average nn.Linear time: 187.359 μs
Average a @ b time: 106.566 μs
Average bmm time: 26.295 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.489
Speedup (a @ b / grouped_gemm): 1.416
Speedup (bmm / grouped_gemm): 0.349

======================
TFLOPS (grouped_gemm): 5.726
TFLOPS (nn.Linear): 2.300
TFLOPS (a @ b): 4.044
TFLOPS (bmm): 16.389

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 76.537 μs

======================
Average nn.Linear time: 163.536 μs
Average a @ b time: 87.345 μs
Average bmm time: 35.388 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.137
Speedup (a @ b / grouped_gemm): 1.141
Speedup (bmm / grouped_gemm): 0.462

======================
TFLOPS (grouped_gemm): 12.659
TFLOPS (nn.Linear): 5.925
TFLOPS (a @ b): 11.093
TFLOPS (bmm): 27.379

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 97.778 μs

======================
Average nn.Linear time: 154.355 μs
Average a @ b time: 81.818 μs
Average bmm time: 49.174 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.579
Speedup (a @ b / grouped_gemm): 0.837
Speedup (bmm / grouped_gemm): 0.503

======================
TFLOPS (grouped_gemm): 17.083
TFLOPS (nn.Linear): 10.822
TFLOPS (a @ b): 20.416
TFLOPS (bmm): 33.969

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 126.863 μs

======================
Average nn.Linear time: 150.328 μs
Average a @ b time: 99.020 μs
Average bmm time: 76.954 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.185
Speedup (a @ b / grouped_gemm): 0.781
Speedup (bmm / grouped_gemm): 0.607

======================
TFLOPS (grouped_gemm): 30.053
TFLOPS (nn.Linear): 25.362
TFLOPS (a @ b): 38.504
TFLOPS (bmm): 49.544

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 170.605 μs

======================
Average nn.Linear time: 163.896 μs
Average a @ b time: 180.409 μs
Average bmm time: 99.094 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.961
Speedup (a @ b / grouped_gemm): 1.057
Speedup (bmm / grouped_gemm): 0.581

======================
TFLOPS (grouped_gemm): 34.665
TFLOPS (nn.Linear): 36.084
TFLOPS (a @ b): 32.781
TFLOPS (bmm): 59.680

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 260.911 μs

======================
Average nn.Linear time: 182.753 μs
Average a @ b time: 216.818 μs
Average bmm time: 162.432 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.700
Speedup (a @ b / grouped_gemm): 0.831
Speedup (bmm / grouped_gemm): 0.623

======================
TFLOPS (grouped_gemm): 29.961
TFLOPS (nn.Linear): 42.774
TFLOPS (a @ b): 36.054
TFLOPS (bmm): 48.126

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 153.294 μs

======================
Average nn.Linear time: 183.089 μs
Average a @ b time: 105.388 μs
Average bmm time: 35.918 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.194
Speedup (a @ b / grouped_gemm): 0.687
Speedup (bmm / grouped_gemm): 0.234

======================
TFLOPS (grouped_gemm): 8.496
TFLOPS (nn.Linear): 7.113
TFLOPS (a @ b): 12.357
TFLOPS (bmm): 36.259

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 153.461 μs

======================
Average nn.Linear time: 174.401 μs
Average a @ b time: 116.069 μs
Average bmm time: 51.937 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.136
Speedup (a @ b / grouped_gemm): 0.756
Speedup (bmm / grouped_gemm): 0.338

======================
TFLOPS (grouped_gemm): 13.146
TFLOPS (nn.Linear): 11.568
TFLOPS (a @ b): 17.382
TFLOPS (bmm): 38.844

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 154.753 μs

======================
Average nn.Linear time: 174.453 μs
Average a @ b time: 129.941 μs
Average bmm time: 85.032 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.127
Speedup (a @ b / grouped_gemm): 0.840
Speedup (bmm / grouped_gemm): 0.549

======================
TFLOPS (grouped_gemm): 18.159
TFLOPS (nn.Linear): 16.109
TFLOPS (a @ b): 21.627
TFLOPS (bmm): 33.049

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 256.929 μs

======================
Average nn.Linear time: 170.944 μs
Average a @ b time: 182.180 μs
Average bmm time: 143.819 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.665
Speedup (a @ b / grouped_gemm): 0.709
Speedup (bmm / grouped_gemm): 0.560

======================
TFLOPS (grouped_gemm): 33.107
TFLOPS (nn.Linear): 49.759
TFLOPS (a @ b): 46.690
TFLOPS (bmm): 59.144

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 361.807 μs

======================
Average nn.Linear time: 247.817 μs
Average a @ b time: 244.234 μs
Average bmm time: 265.014 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.685
Speedup (a @ b / grouped_gemm): 0.675
Speedup (bmm / grouped_gemm): 0.732

======================
TFLOPS (grouped_gemm): 47.483
TFLOPS (nn.Linear): 69.325
TFLOPS (a @ b): 70.342
TFLOPS (bmm): 64.826

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1971.25 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 570.035 μs

======================
Average nn.Linear time: 430.400 μs
Average a @ b time: 425.537 μs
Average bmm time: 369.315 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.755
Speedup (a @ b / grouped_gemm): 0.747
Speedup (bmm / grouped_gemm): 0.648

======================
TFLOPS (grouped_gemm): 38.968
TFLOPS (nn.Linear): 51.610
TFLOPS (a @ b): 52.200
TFLOPS (bmm): 60.147

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 994.229 μs

======================
Average nn.Linear time: 718.572 μs
Average a @ b time: 709.820 μs
Average bmm time: 662.122 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.723
Speedup (a @ b / grouped_gemm): 0.714
Speedup (bmm / grouped_gemm): 0.666

======================
TFLOPS (grouped_gemm): 45.005
TFLOPS (nn.Linear): 62.269
TFLOPS (a @ b): 63.037
TFLOPS (bmm): 67.578

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 61.338 μs

======================
Average nn.Linear time: 164.461 μs
Average a @ b time: 87.276 μs
Average bmm time: 21.112 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.681
Speedup (a @ b / grouped_gemm): 1.423
Speedup (bmm / grouped_gemm): 0.344

======================
TFLOPS (grouped_gemm): 1.112
TFLOPS (nn.Linear): 0.415
TFLOPS (a @ b): 0.782
TFLOPS (bmm): 3.231

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 63.362 μs

======================
Average nn.Linear time: 152.836 μs
Average a @ b time: 80.459 μs
Average bmm time: 25.263 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.412
Speedup (a @ b / grouped_gemm): 1.270
Speedup (bmm / grouped_gemm): 0.399

======================
TFLOPS (grouped_gemm): 2.106
TFLOPS (nn.Linear): 0.873
TFLOPS (a @ b): 1.658
TFLOPS (bmm): 5.282

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 60.582 μs

======================
Average nn.Linear time: 152.965 μs
Average a @ b time: 80.659 μs
Average bmm time: 31.493 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.525
Speedup (a @ b / grouped_gemm): 1.331
Speedup (bmm / grouped_gemm): 0.520

======================
TFLOPS (grouped_gemm): 4.383
TFLOPS (nn.Linear): 1.736
TFLOPS (a @ b): 3.292
TFLOPS (bmm): 8.432

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 67.444 μs

======================
Average nn.Linear time: 151.980 μs
Average a @ b time: 81.499 μs
Average bmm time: 44.205 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.253
Speedup (a @ b / grouped_gemm): 1.208
Speedup (bmm / grouped_gemm): 0.655

======================
TFLOPS (grouped_gemm): 8.792
TFLOPS (nn.Linear): 3.902
TFLOPS (a @ b): 7.276
TFLOPS (bmm): 13.414

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 77.975 μs

======================
Average nn.Linear time: 159.826 μs
Average a @ b time: 85.082 μs
Average bmm time: 72.827 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.050
Speedup (a @ b / grouped_gemm): 1.091
Speedup (bmm / grouped_gemm): 0.934

======================
TFLOPS (grouped_gemm): 19.311
TFLOPS (nn.Linear): 9.421
TFLOPS (a @ b): 17.698
TFLOPS (bmm): 20.676

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 96.331 μs

======================
Average nn.Linear time: 153.742 μs
Average a @ b time: 98.498 μs
Average bmm time: 58.765 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.596
Speedup (a @ b / grouped_gemm): 1.022
Speedup (bmm / grouped_gemm): 0.610

======================
TFLOPS (grouped_gemm): 27.518
TFLOPS (nn.Linear): 17.242
TFLOPS (a @ b): 26.912
TFLOPS (bmm): 45.108

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 128.517 μs

======================
Average nn.Linear time: 158.317 μs
Average a @ b time: 131.555 μs
Average bmm time: 93.727 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.232
Speedup (a @ b / grouped_gemm): 1.024
Speedup (bmm / grouped_gemm): 0.729

======================
TFLOPS (grouped_gemm): 35.125
TFLOPS (nn.Linear): 28.513
TFLOPS (a @ b): 34.314
TFLOPS (bmm): 48.162

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 75.285 μs

======================
Average nn.Linear time: 182.350 μs
Average a @ b time: 103.309 μs
Average bmm time: 26.028 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.422
Speedup (a @ b / grouped_gemm): 1.372
Speedup (bmm / grouped_gemm): 0.346

======================
TFLOPS (grouped_gemm): 3.750
TFLOPS (nn.Linear): 1.548
TFLOPS (a @ b): 2.733
TFLOPS (bmm): 10.847

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 76.077 μs

======================
Average nn.Linear time: 184.171 μs
Average a @ b time: 103.419 μs
Average bmm time: 27.382 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.421
Speedup (a @ b / grouped_gemm): 1.359
Speedup (bmm / grouped_gemm): 0.360

======================
TFLOPS (grouped_gemm): 4.145
TFLOPS (nn.Linear): 1.712
TFLOPS (a @ b): 3.049
TFLOPS (bmm): 11.517

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 75.502 μs

======================
Average nn.Linear time: 149.214 μs
Average a @ b time: 79.911 μs
Average bmm time: 38.316 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.976
Speedup (a @ b / grouped_gemm): 1.058
Speedup (bmm / grouped_gemm): 0.507

======================
TFLOPS (grouped_gemm): 29.165
TFLOPS (nn.Linear): 14.757
TFLOPS (a @ b): 27.556
TFLOPS (bmm): 57.469

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 98.572 μs

======================
Average nn.Linear time: 151.136 μs
Average a @ b time: 87.564 μs
Average bmm time: 61.045 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.533
Speedup (a @ b / grouped_gemm): 0.888
Speedup (bmm / grouped_gemm): 0.619

======================
TFLOPS (grouped_gemm): 27.732
TFLOPS (nn.Linear): 18.087
TFLOPS (a @ b): 31.219
TFLOPS (bmm): 44.781

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 125.051 μs

======================
Average nn.Linear time: 152.314 μs
Average a @ b time: 115.018 μs
Average bmm time: 124.798 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.218
Speedup (a @ b / grouped_gemm): 0.920
Speedup (bmm / grouped_gemm): 0.998

======================
TFLOPS (grouped_gemm): 55.393
TFLOPS (nn.Linear): 45.478
TFLOPS (a @ b): 60.224
TFLOPS (bmm): 55.505

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 172.269 μs

======================
Average nn.Linear time: 206.745 μs
Average a @ b time: 204.804 μs
Average bmm time: 133.464 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.200
Speedup (a @ b / grouped_gemm): 1.189
Speedup (bmm / grouped_gemm): 0.775

======================
TFLOPS (grouped_gemm): 85.240
TFLOPS (nn.Linear): 71.026
TFLOPS (a @ b): 71.699
TFLOPS (bmm): 110.024

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 266.807 μs

======================
Average nn.Linear time: 257.690 μs
Average a @ b time: 265.710 μs
Average bmm time: 220.587 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.966
Speedup (a @ b / grouped_gemm): 0.996
Speedup (bmm / grouped_gemm): 0.827

======================
TFLOPS (grouped_gemm): 87.896
TFLOPS (nn.Linear): 91.006
TFLOPS (a @ b): 88.259
TFLOPS (bmm): 106.313

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 154.653 μs

======================
Average nn.Linear time: 173.829 μs
Average a @ b time: 116.918 μs
Average bmm time: 47.488 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.124
Speedup (a @ b / grouped_gemm): 0.756
Speedup (bmm / grouped_gemm): 0.307

======================
TFLOPS (grouped_gemm): 15.120
TFLOPS (nn.Linear): 13.452
TFLOPS (a @ b): 20.000
TFLOPS (bmm): 49.240

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 155.125 μs

======================
Average nn.Linear time: 174.463 μs
Average a @ b time: 121.331 μs
Average bmm time: 79.913 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.125
Speedup (a @ b / grouped_gemm): 0.782
Speedup (bmm / grouped_gemm): 0.515

======================
TFLOPS (grouped_gemm): 21.577
TFLOPS (nn.Linear): 19.185
TFLOPS (a @ b): 27.586
TFLOPS (bmm): 41.884

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 155.575 μs

======================
Average nn.Linear time: 168.862 μs
Average a @ b time: 164.907 μs
Average bmm time: 117.211 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.085
Speedup (a @ b / grouped_gemm): 1.060
Speedup (bmm / grouped_gemm): 0.753

======================
TFLOPS (grouped_gemm): 70.959
TFLOPS (nn.Linear): 65.375
TFLOPS (a @ b): 66.943
TFLOPS (bmm): 94.184

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 258.465 μs

======================
Average nn.Linear time: 211.411 μs
Average a @ b time: 212.038 μs
Average bmm time: 186.257 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.818
Speedup (a @ b / grouped_gemm): 0.820
Speedup (bmm / grouped_gemm): 0.721

======================
TFLOPS (grouped_gemm): 60.108
TFLOPS (nn.Linear): 73.486
TFLOPS (a @ b): 73.269
TFLOPS (bmm): 83.410

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 364.022 μs

======================
Average nn.Linear time: 284.517 μs
Average a @ b time: 277.722 μs
Average bmm time: 361.598 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.782
Speedup (a @ b / grouped_gemm): 0.763
Speedup (bmm / grouped_gemm): 0.993

======================
TFLOPS (grouped_gemm): 72.912
TFLOPS (nn.Linear): 93.286
TFLOPS (a @ b): 95.569
TFLOPS (bmm): 73.401

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2010.04 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 605.693 μs

======================
Average nn.Linear time: 642.581 μs
Average a @ b time: 621.724 μs
Average bmm time: 629.663 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.061
Speedup (a @ b / grouped_gemm): 1.026
Speedup (bmm / grouped_gemm): 1.040

======================
TFLOPS (grouped_gemm): 123.095
TFLOPS (nn.Linear): 116.029
TFLOPS (a @ b): 119.921
TFLOPS (bmm): 118.409

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 1041.572 μs

======================
Average nn.Linear time: 966.520 μs
Average a @ b time: 952.606 μs
Average bmm time: 1216.776 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.928
Speedup (a @ b / grouped_gemm): 0.915
Speedup (bmm / grouped_gemm): 1.168

======================
TFLOPS (grouped_gemm): 117.940
TFLOPS (nn.Linear): 127.098
TFLOPS (a @ b): 128.954
TFLOPS (bmm): 100.958

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 62.129 μs

======================
Average nn.Linear time: 166.276 μs
Average a @ b time: 89.259 μs
Average bmm time: 25.122 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.676
Speedup (a @ b / grouped_gemm): 1.437
Speedup (bmm / grouped_gemm): 0.404

======================
TFLOPS (grouped_gemm): 2.082
TFLOPS (nn.Linear): 0.778
TFLOPS (a @ b): 1.449
TFLOPS (bmm): 5.150

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 61.052 μs

======================
Average nn.Linear time: 164.845 μs
Average a @ b time: 89.693 μs
Average bmm time: 31.769 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.700
Speedup (a @ b / grouped_gemm): 1.469
Speedup (bmm / grouped_gemm): 0.520

======================
TFLOPS (grouped_gemm): 5.294
TFLOPS (nn.Linear): 1.961
TFLOPS (a @ b): 3.604
TFLOPS (bmm): 10.174

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 62.258 μs

======================
Average nn.Linear time: 150.354 μs
Average a @ b time: 79.913 μs
Average bmm time: 38.738 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.415
Speedup (a @ b / grouped_gemm): 1.284
Speedup (bmm / grouped_gemm): 0.622

======================
TFLOPS (grouped_gemm): 7.129
TFLOPS (nn.Linear): 2.952
TFLOPS (a @ b): 5.554
TFLOPS (bmm): 11.457

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 69.594 μs

======================
Average nn.Linear time: 152.984 μs
Average a @ b time: 82.581 μs
Average bmm time: 67.708 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.198
Speedup (a @ b / grouped_gemm): 1.187
Speedup (bmm / grouped_gemm): 0.973

======================
TFLOPS (grouped_gemm): 14.570
TFLOPS (nn.Linear): 6.628
TFLOPS (a @ b): 12.279
TFLOPS (bmm): 14.976

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 78.604 μs

======================
Average nn.Linear time: 160.778 μs
Average a @ b time: 86.770 μs
Average bmm time: 116.668 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.045
Speedup (a @ b / grouped_gemm): 1.104
Speedup (bmm / grouped_gemm): 1.484

======================
TFLOPS (grouped_gemm): 24.119
TFLOPS (nn.Linear): 11.792
TFLOPS (a @ b): 21.849
TFLOPS (bmm): 16.250

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 118.468 μs

======================
Average nn.Linear time: 153.689 μs
Average a @ b time: 128.043 μs
Average bmm time: 93.663 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.297
Speedup (a @ b / grouped_gemm): 1.081
Speedup (bmm / grouped_gemm): 0.791

======================
TFLOPS (grouped_gemm): 42.450
TFLOPS (nn.Linear): 32.722
TFLOPS (a @ b): 39.276
TFLOPS (bmm): 53.692

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 155.573 μs

======================
Average nn.Linear time: 155.358 μs
Average a @ b time: 145.719 μs
Average bmm time: 148.828 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.999
Speedup (a @ b / grouped_gemm): 0.937
Speedup (bmm / grouped_gemm): 0.957

======================
TFLOPS (grouped_gemm): 38.051
TFLOPS (nn.Linear): 38.104
TFLOPS (a @ b): 40.624
TFLOPS (bmm): 39.776

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 75.536 μs

======================
Average nn.Linear time: 176.339 μs
Average a @ b time: 99.795 μs
Average bmm time: 25.151 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.335
Speedup (a @ b / grouped_gemm): 1.321
Speedup (bmm / grouped_gemm): 0.333

======================
TFLOPS (grouped_gemm): 6.023
TFLOPS (nn.Linear): 2.580
TFLOPS (a @ b): 4.559
TFLOPS (bmm): 18.089

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 75.874 μs

======================
Average nn.Linear time: 165.675 μs
Average a @ b time: 93.005 μs
Average bmm time: 39.070 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.184
Speedup (a @ b / grouped_gemm): 1.226
Speedup (bmm / grouped_gemm): 0.515

======================
TFLOPS (grouped_gemm): 21.911
TFLOPS (nn.Linear): 10.035
TFLOPS (a @ b): 17.876
TFLOPS (bmm): 42.553

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 76.728 μs

======================
Average nn.Linear time: 147.774 μs
Average a @ b time: 87.483 μs
Average bmm time: 53.289 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.926
Speedup (a @ b / grouped_gemm): 1.140
Speedup (bmm / grouped_gemm): 0.695

======================
TFLOPS (grouped_gemm): 47.230
TFLOPS (nn.Linear): 24.523
TFLOPS (a @ b): 41.424
TFLOPS (bmm): 68.004

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 101.390 μs

======================
Average nn.Linear time: 150.776 μs
Average a @ b time: 106.354 μs
Average bmm time: 86.310 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.487
Speedup (a @ b / grouped_gemm): 1.049
Speedup (bmm / grouped_gemm): 0.851

======================
TFLOPS (grouped_gemm): 67.296
TFLOPS (nn.Linear): 45.253
TFLOPS (a @ b): 64.155
TFLOPS (bmm): 79.053

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 147.111 μs

======================
Average nn.Linear time: 166.492 μs
Average a @ b time: 132.477 μs
Average bmm time: 147.669 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.132
Speedup (a @ b / grouped_gemm): 0.901
Speedup (bmm / grouped_gemm): 1.004

======================
TFLOPS (grouped_gemm): 85.961
TFLOPS (nn.Linear): 75.954
TFLOPS (a @ b): 95.457
TFLOPS (bmm): 85.636

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 240.037 μs

======================
Average nn.Linear time: 252.435 μs
Average a @ b time: 253.994 μs
Average bmm time: 229.080 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.052
Speedup (a @ b / grouped_gemm): 1.058
Speedup (bmm / grouped_gemm): 0.954

======================
TFLOPS (grouped_gemm): 103.007
TFLOPS (nn.Linear): 97.948
TFLOPS (a @ b): 97.346
TFLOPS (bmm): 107.934

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 389.428 μs

======================
Average nn.Linear time: 384.035 μs
Average a @ b time: 392.992 μs
Average bmm time: 397.494 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.986
Speedup (a @ b / grouped_gemm): 1.009
Speedup (bmm / grouped_gemm): 1.021

======================
TFLOPS (grouped_gemm): 132.710
TFLOPS (nn.Linear): 134.574
TFLOPS (a @ b): 131.507
TFLOPS (bmm): 130.018

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 157.161 μs

======================
Average nn.Linear time: 175.714 μs
Average a @ b time: 129.273 μs
Average bmm time: 85.018 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.118
Speedup (a @ b / grouped_gemm): 0.823
Speedup (bmm / grouped_gemm): 0.541

======================
TFLOPS (grouped_gemm): 27.182
TFLOPS (nn.Linear): 24.312
TFLOPS (a @ b): 33.046
TFLOPS (bmm): 50.247

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 155.029 μs

======================
Average nn.Linear time: 174.754 μs
Average a @ b time: 135.198 μs
Average bmm time: 84.651 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.127
Speedup (a @ b / grouped_gemm): 0.872
Speedup (bmm / grouped_gemm): 0.546

======================
TFLOPS (grouped_gemm): 39.635
TFLOPS (nn.Linear): 35.162
TFLOPS (a @ b): 45.449
TFLOPS (bmm): 72.589

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 158.675 μs

======================
Average nn.Linear time: 233.355 μs
Average a @ b time: 226.154 μs
Average bmm time: 182.345 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.471
Speedup (a @ b / grouped_gemm): 1.425
Speedup (bmm / grouped_gemm): 1.149

======================
TFLOPS (grouped_gemm): 139.780
TFLOPS (nn.Linear): 95.046
TFLOPS (a @ b): 98.072
TFLOPS (bmm): 121.635

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 270.765 μs

======================
Average nn.Linear time: 272.818 μs
Average a @ b time: 266.974 μs
Average bmm time: 322.411 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.008
Speedup (a @ b / grouped_gemm): 0.986
Speedup (bmm / grouped_gemm): 1.191

======================
TFLOPS (grouped_gemm): 107.071
TFLOPS (nn.Linear): 106.265
TFLOPS (a @ b): 108.591
TFLOPS (bmm): 89.919

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 585.213 μs

======================
Average nn.Linear time: 562.255 μs
Average a @ b time: 552.876 μs
Average bmm time: 639.105 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.961
Speedup (a @ b / grouped_gemm): 0.945
Speedup (bmm / grouped_gemm): 1.092

======================
TFLOPS (grouped_gemm): 151.542
TFLOPS (nn.Linear): 157.730
TFLOPS (a @ b): 160.406
TFLOPS (bmm): 138.763

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2122.59 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 817.676 μs

======================
Average nn.Linear time: 707.345 μs
Average a @ b time: 684.130 μs
Average bmm time: 923.555 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.865
Speedup (a @ b / grouped_gemm): 0.837
Speedup (bmm / grouped_gemm): 1.129

======================
TFLOPS (grouped_gemm): 123.191
TFLOPS (nn.Linear): 142.406
TFLOPS (a @ b): 147.239
TFLOPS (bmm): 109.068

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 1683.581 μs

======================
Average nn.Linear time: 1717.813 μs
Average a @ b time: 1696.172 μs
Average bmm time: 3662.698 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.020
Speedup (a @ b / grouped_gemm): 1.007
Speedup (bmm / grouped_gemm): 2.176

======================
TFLOPS (grouped_gemm): 161.067
TFLOPS (nn.Linear): 157.858
TFLOPS (a @ b): 159.872
TFLOPS (bmm): 74.036

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 60.694 μs

======================
Average nn.Linear time: 155.697 μs
Average a @ b time: 85.719 μs
Average bmm time: 26.371 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.565
Speedup (a @ b / grouped_gemm): 1.412
Speedup (bmm / grouped_gemm): 0.434

======================
TFLOPS (grouped_gemm): 4.913
TFLOPS (nn.Linear): 1.915
TFLOPS (a @ b): 3.479
TFLOPS (bmm): 11.307

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 63.183 μs

======================
Average nn.Linear time: 154.674 μs
Average a @ b time: 85.227 μs
Average bmm time: 30.658 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.448
Speedup (a @ b / grouped_gemm): 1.349
Speedup (bmm / grouped_gemm): 0.485

======================
TFLOPS (grouped_gemm): 6.277
TFLOPS (nn.Linear): 2.564
TFLOPS (a @ b): 4.654
TFLOPS (bmm): 12.937

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 68.281 μs

======================
Average nn.Linear time: 153.315 μs
Average a @ b time: 81.613 μs
Average bmm time: 39.239 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.245
Speedup (a @ b / grouped_gemm): 1.195
Speedup (bmm / grouped_gemm): 0.575

======================
TFLOPS (grouped_gemm): 11.176
TFLOPS (nn.Linear): 4.977
TFLOPS (a @ b): 9.350
TFLOPS (bmm): 19.448

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 77.729 μs

======================
Average nn.Linear time: 153.236 μs
Average a @ b time: 86.672 μs
Average bmm time: 64.068 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.971
Speedup (a @ b / grouped_gemm): 1.115
Speedup (bmm / grouped_gemm): 0.824

======================
TFLOPS (grouped_gemm): 21.159
TFLOPS (nn.Linear): 10.733
TFLOPS (a @ b): 18.976
TFLOPS (bmm): 25.671

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 104.239 μs

======================
Average nn.Linear time: 149.486 μs
Average a @ b time: 101.638 μs
Average bmm time: 110.183 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.434
Speedup (a @ b / grouped_gemm): 0.975
Speedup (bmm / grouped_gemm): 1.057

======================
TFLOPS (grouped_gemm): 38.739
TFLOPS (nn.Linear): 27.013
TFLOPS (a @ b): 39.730
TFLOPS (bmm): 36.649

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 152.156 μs

======================
Average nn.Linear time: 174.668 μs
Average a @ b time: 169.585 μs
Average bmm time: 161.023 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.148
Speedup (a @ b / grouped_gemm): 1.115
Speedup (bmm / grouped_gemm): 1.058

======================
TFLOPS (grouped_gemm): 56.772
TFLOPS (nn.Linear): 49.455
TFLOPS (a @ b): 50.937
TFLOPS (bmm): 53.646

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 250.270 μs

======================
Average nn.Linear time: 249.724 μs
Average a @ b time: 259.435 μs
Average bmm time: 268.886 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.998
Speedup (a @ b / grouped_gemm): 1.037
Speedup (bmm / grouped_gemm): 1.074

======================
TFLOPS (grouped_gemm): 69.406
TFLOPS (nn.Linear): 69.557
TFLOPS (a @ b): 66.954
TFLOPS (bmm): 64.601

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3000.00 MB
Average grouped_gemm time: 75.619 μs

======================
Average nn.Linear time: 160.358 μs
Average a @ b time: 92.113 μs
Average bmm time: 38.354 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.121
Speedup (a @ b / grouped_gemm): 1.218
Speedup (bmm / grouped_gemm): 0.507

======================
TFLOPS (grouped_gemm): 23.389
TFLOPS (nn.Linear): 11.030
TFLOPS (a @ b): 19.201
TFLOPS (bmm): 46.114

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 77.083 μs

======================
Average nn.Linear time: 166.001 μs
Average a @ b time: 104.251 μs
Average bmm time: 53.270 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.154
Speedup (a @ b / grouped_gemm): 1.352
Speedup (bmm / grouped_gemm): 0.691

======================
TFLOPS (grouped_gemm): 46.656
TFLOPS (nn.Linear): 21.665
TFLOPS (a @ b): 34.497
TFLOPS (bmm): 67.512

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 100.608 μs

======================
Average nn.Linear time: 155.776 μs
Average a @ b time: 110.056 μs
Average bmm time: 84.903 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.548
Speedup (a @ b / grouped_gemm): 1.094
Speedup (bmm / grouped_gemm): 0.844

======================
TFLOPS (grouped_gemm): 68.116
TFLOPS (nn.Linear): 43.993
TFLOPS (a @ b): 62.268
TFLOPS (bmm): 80.715

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 148.962 μs

======================
Average nn.Linear time: 174.625 μs
Average a @ b time: 155.606 μs
Average bmm time: 138.454 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.172
Speedup (a @ b / grouped_gemm): 1.045
Speedup (bmm / grouped_gemm): 0.929

======================
TFLOPS (grouped_gemm): 111.945
TFLOPS (nn.Linear): 95.493
TFLOPS (a @ b): 107.165
TFLOPS (bmm): 120.440

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 192.108 μs

======================
Average nn.Linear time: 191.214 μs
Average a @ b time: 180.337 μs
Average bmm time: 250.432 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.995
Speedup (a @ b / grouped_gemm): 0.939
Speedup (bmm / grouped_gemm): 1.304

======================
TFLOPS (grouped_gemm): 109.678
TFLOPS (nn.Linear): 110.191
TFLOPS (a @ b): 116.837
TFLOPS (bmm): 84.135

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 381.308 μs

======================
Average nn.Linear time: 374.796 μs
Average a @ b time: 378.101 μs
Average bmm time: 430.627 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.983
Speedup (a @ b / grouped_gemm): 0.992
Speedup (bmm / grouped_gemm): 1.129

======================
TFLOPS (grouped_gemm): 147.507
TFLOPS (nn.Linear): 150.070
TFLOPS (a @ b): 148.758
TFLOPS (bmm): 130.613

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 679.874 μs

======================
Average nn.Linear time: 659.471 μs
Average a @ b time: 652.680 μs
Average bmm time: 782.857 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.970
Speedup (a @ b / grouped_gemm): 0.960
Speedup (bmm / grouped_gemm): 1.151

======================
TFLOPS (grouped_gemm): 163.400
TFLOPS (nn.Linear): 168.455
TFLOPS (a @ b): 170.208
TFLOPS (bmm): 141.905

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 160.074 μs

======================
Average nn.Linear time: 167.365 μs
Average a @ b time: 149.899 μs
Average bmm time: 119.233 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.046
Speedup (a @ b / grouped_gemm): 0.936
Speedup (bmm / grouped_gemm): 0.745

======================
TFLOPS (grouped_gemm): 51.186
TFLOPS (nn.Linear): 48.956
TFLOPS (a @ b): 54.661
TFLOPS (bmm): 68.719

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 157.032 μs

======================
Average nn.Linear time: 180.039 μs
Average a @ b time: 171.194 μs
Average bmm time: 186.119 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.147
Speedup (a @ b / grouped_gemm): 1.090
Speedup (bmm / grouped_gemm): 1.185

======================
TFLOPS (grouped_gemm): 85.204
TFLOPS (nn.Linear): 74.316
TFLOPS (a @ b): 78.156
TFLOPS (bmm): 71.889

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 258.512 μs

======================
Average nn.Linear time: 229.714 μs
Average a @ b time: 222.378 μs
Average bmm time: 327.294 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.889
Speedup (a @ b / grouped_gemm): 0.860
Speedup (bmm / grouped_gemm): 1.266

======================
TFLOPS (grouped_gemm): 88.036
TFLOPS (nn.Linear): 99.072
TFLOPS (a @ b): 102.341
TFLOPS (bmm): 69.535

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 378.191 μs

======================
Average nn.Linear time: 444.257 μs
Average a @ b time: 427.723 μs
Average bmm time: 647.645 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.175
Speedup (a @ b / grouped_gemm): 1.131
Speedup (bmm / grouped_gemm): 1.712

======================
TFLOPS (grouped_gemm): 185.876
TFLOPS (nn.Linear): 158.234
TFLOPS (a @ b): 164.351
TFLOPS (bmm): 108.542

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 812.674 μs

======================
Average nn.Linear time: 737.867 μs
Average a @ b time: 732.360 μs
Average bmm time: 1335.692 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.908
Speedup (a @ b / grouped_gemm): 0.901
Speedup (bmm / grouped_gemm): 1.644

======================
TFLOPS (grouped_gemm): 165.114
TFLOPS (nn.Linear): 181.854
TFLOPS (a @ b): 183.222
TFLOPS (bmm): 100.460

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2321.36 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 1778.054 μs

======================
Average nn.Linear time: 1844.411 μs
Average a @ b time: 1811.783 μs
Average bmm time: 2584.710 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.037
Speedup (a @ b / grouped_gemm): 1.019
Speedup (bmm / grouped_gemm): 1.454

======================
TFLOPS (grouped_gemm): 197.659
TFLOPS (nn.Linear): 190.548
TFLOPS (a @ b): 193.980
TFLOPS (bmm): 135.972

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 2659.633 μs

======================
Average nn.Linear time: 2520.018 μs
Average a @ b time: 2500.696 μs
Average bmm time: 4345.381 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.948
Speedup (a @ b / grouped_gemm): 0.940
Speedup (bmm / grouped_gemm): 1.634

======================
TFLOPS (grouped_gemm): 178.437
TFLOPS (nn.Linear): 188.323
TFLOPS (a @ b): 189.778
TFLOPS (bmm): 109.214

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 61.517 μs

======================
Average nn.Linear time: 156.610 μs
Average a @ b time: 82.970 μs
Average bmm time: 30.620 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.546
Speedup (a @ b / grouped_gemm): 1.349
Speedup (bmm / grouped_gemm): 0.498

======================
TFLOPS (grouped_gemm): 6.835
TFLOPS (nn.Linear): 2.685
TFLOPS (a @ b): 5.068
TFLOPS (bmm): 13.732

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 69.475 μs

======================
Average nn.Linear time: 156.236 μs
Average a @ b time: 86.915 μs
Average bmm time: 41.921 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.249
Speedup (a @ b / grouped_gemm): 1.251
Speedup (bmm / grouped_gemm): 0.603

======================
TFLOPS (grouped_gemm): 13.504
TFLOPS (nn.Linear): 6.005
TFLOPS (a @ b): 10.795
TFLOPS (bmm): 22.380

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 80.092 μs

======================
Average nn.Linear time: 151.527 μs
Average a @ b time: 83.113 μs
Average bmm time: 58.393 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.892
Speedup (a @ b / grouped_gemm): 1.038
Speedup (bmm / grouped_gemm): 0.729

======================
TFLOPS (grouped_gemm): 27.219
TFLOPS (nn.Linear): 14.387
TFLOPS (a @ b): 26.229
TFLOPS (bmm): 37.333

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 105.925 μs

======================
Average nn.Linear time: 161.467 μs
Average a @ b time: 110.681 μs
Average bmm time: 108.254 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.524
Speedup (a @ b / grouped_gemm): 1.045
Speedup (bmm / grouped_gemm): 1.022

======================
TFLOPS (grouped_gemm): 45.215
TFLOPS (nn.Linear): 29.662
TFLOPS (a @ b): 43.272
TFLOPS (bmm): 44.242

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 171.394 μs

======================
Average nn.Linear time: 195.243 μs
Average a @ b time: 190.480 μs
Average bmm time: 189.912 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.139
Speedup (a @ b / grouped_gemm): 1.111
Speedup (bmm / grouped_gemm): 1.108

======================
TFLOPS (grouped_gemm): 63.840
TFLOPS (nn.Linear): 56.042
TFLOPS (a @ b): 57.444
TFLOPS (bmm): 57.615

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 284.514 μs

======================
Average nn.Linear time: 319.562 μs
Average a @ b time: 322.871 μs
Average bmm time: 294.476 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.123
Speedup (a @ b / grouped_gemm): 1.135
Speedup (bmm / grouped_gemm): 1.035

======================
TFLOPS (grouped_gemm): 83.499
TFLOPS (nn.Linear): 74.341
TFLOPS (a @ b): 73.579
TFLOPS (bmm): 80.674

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 303.917 μs

======================
Average nn.Linear time: 306.542 μs
Average a @ b time: 317.323 μs
Average bmm time: 473.092 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.009
Speedup (a @ b / grouped_gemm): 1.044
Speedup (bmm / grouped_gemm): 1.557

======================
TFLOPS (grouped_gemm): 75.232
TFLOPS (nn.Linear): 74.588
TFLOPS (a @ b): 72.053
TFLOPS (bmm): 48.329

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 78.480 μs

======================
Average nn.Linear time: 164.030 μs
Average a @ b time: 100.300 μs
Average bmm time: 53.167 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.090
Speedup (a @ b / grouped_gemm): 1.278
Speedup (bmm / grouped_gemm): 0.677

======================
TFLOPS (grouped_gemm): 49.663
TFLOPS (nn.Linear): 23.761
TFLOPS (a @ b): 38.859
TFLOPS (bmm): 73.307

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 101.280 μs

======================
Average nn.Linear time: 177.872 μs
Average a @ b time: 119.460 μs
Average bmm time: 75.662 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.756
Speedup (a @ b / grouped_gemm): 1.179
Speedup (bmm / grouped_gemm): 0.747

======================
TFLOPS (grouped_gemm): 59.743
TFLOPS (nn.Linear): 34.018
TFLOPS (a @ b): 50.651
TFLOPS (bmm): 79.971

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 143.194 μs

======================
Average nn.Linear time: 174.637 μs
Average a @ b time: 139.279 μs
Average bmm time: 128.605 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.220
Speedup (a @ b / grouped_gemm): 0.973
Speedup (bmm / grouped_gemm): 0.898

======================
TFLOPS (grouped_gemm): 87.752
TFLOPS (nn.Linear): 71.953
TFLOPS (a @ b): 90.219
TFLOPS (bmm): 97.707

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 196.023 μs

======================
Average nn.Linear time: 243.981 μs
Average a @ b time: 230.205 μs
Average bmm time: 227.067 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.245
Speedup (a @ b / grouped_gemm): 1.174
Speedup (bmm / grouped_gemm): 1.158

======================
TFLOPS (grouped_gemm): 146.420
TFLOPS (nn.Linear): 117.639
TFLOPS (a @ b): 124.679
TFLOPS (bmm): 126.401

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 197.346 μs

======================
Average nn.Linear time: 188.460 μs
Average a @ b time: 176.194 μs
Average bmm time: 255.475 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.955
Speedup (a @ b / grouped_gemm): 0.893
Speedup (bmm / grouped_gemm): 1.295

======================
TFLOPS (grouped_gemm): 103.962
TFLOPS (nn.Linear): 108.863
TFLOPS (a @ b): 116.443
TFLOPS (bmm): 80.307

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 544.798 μs

======================
Average nn.Linear time: 523.162 μs
Average a @ b time: 521.252 μs
Average bmm time: 702.398 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.960
Speedup (a @ b / grouped_gemm): 0.957
Speedup (bmm / grouped_gemm): 1.289

======================
TFLOPS (grouped_gemm): 171.099
TFLOPS (nn.Linear): 178.175
TFLOPS (a @ b): 178.827
TFLOPS (bmm): 132.709

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 762.844 μs

======================
Average nn.Linear time: 754.175 μs
Average a @ b time: 740.404 μs
Average bmm time: 2222.199 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.989
Speedup (a @ b / grouped_gemm): 0.971
Speedup (bmm / grouped_gemm): 2.913

======================
TFLOPS (grouped_gemm): 168.778
TFLOPS (nn.Linear): 170.718
TFLOPS (a @ b): 173.894
TFLOPS (bmm): 57.939

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 159.771 μs

======================
Average nn.Linear time: 232.248 μs
Average a @ b time: 224.223 μs
Average bmm time: 174.942 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.454
Speedup (a @ b / grouped_gemm): 1.403
Speedup (bmm / grouped_gemm): 1.095

======================
TFLOPS (grouped_gemm): 141.524
TFLOPS (nn.Linear): 97.359
TFLOPS (a @ b): 100.844
TFLOPS (bmm): 129.251

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 262.897 μs

======================
Average nn.Linear time: 268.722 μs
Average a @ b time: 258.245 μs
Average bmm time: 270.479 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.022
Speedup (a @ b / grouped_gemm): 0.982
Speedup (bmm / grouped_gemm): 1.029

======================
TFLOPS (grouped_gemm): 119.497
TFLOPS (nn.Linear): 116.907
TFLOPS (a @ b): 121.649
TFLOPS (bmm): 116.147

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 486.155 μs

======================
Average nn.Linear time: 510.516 μs
Average a @ b time: 504.584 μs
Average bmm time: 551.715 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.050
Speedup (a @ b / grouped_gemm): 1.038
Speedup (bmm / grouped_gemm): 1.135

======================
TFLOPS (grouped_gemm): 188.408
TFLOPS (nn.Linear): 179.417
TFLOPS (a @ b): 181.526
TFLOPS (bmm): 166.019

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 732.114 μs

======================
Average nn.Linear time: 827.549 μs
Average a @ b time: 813.713 μs
Average bmm time: 999.291 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.130
Speedup (a @ b / grouped_gemm): 1.111
Speedup (bmm / grouped_gemm): 1.365

======================
TFLOPS (grouped_gemm): 211.539
TFLOPS (nn.Linear): 187.144
TFLOPS (a @ b): 190.326
TFLOPS (bmm): 154.980

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 1292.133 μs

======================
Average nn.Linear time: 1260.035 μs
Average a @ b time: 1262.355 μs
Average bmm time: 1499.329 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.975
Speedup (a @ b / grouped_gemm): 0.977
Speedup (bmm / grouped_gemm): 1.160

======================
TFLOPS (grouped_gemm): 194.268
TFLOPS (nn.Linear): 199.217
TFLOPS (a @ b): 198.851
TFLOPS (bmm): 167.422

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2719.40 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 2311.246 μs

======================
Average nn.Linear time: 2269.948 μs
Average a @ b time: 2257.869 μs
Average bmm time: 4589.589 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.982
Speedup (a @ b / grouped_gemm): 0.977
Speedup (bmm / grouped_gemm): 1.986

======================
TFLOPS (grouped_gemm): 204.731
TFLOPS (nn.Linear): 208.456
TFLOPS (a @ b): 209.571
TFLOPS (bmm): 103.100

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2773.73 MB
Max memory reserved: 3216.00 MB
Average grouped_gemm time: 2558.966 μs

======================
Average nn.Linear time: 2503.772 μs
Average a @ b time: 2496.343 μs
Average bmm time: 4954.133 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.978
Speedup (a @ b / grouped_gemm): 0.976
Speedup (bmm / grouped_gemm): 1.936

======================
TFLOPS (grouped_gemm): 190.597
TFLOPS (nn.Linear): 194.798
TFLOPS (a @ b): 195.378
TFLOPS (bmm): 98.449

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2773.73 MB
Max memory reserved: 3216.00 MB
Average grouped_gemm time: 73.140 μs

======================
Average nn.Linear time: 170.257 μs
Average a @ b time: 93.248 μs
Average bmm time: 42.901 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.328
Speedup (a @ b / grouped_gemm): 1.275
Speedup (bmm / grouped_gemm): 0.587

======================
TFLOPS (grouped_gemm): 12.364
TFLOPS (nn.Linear): 5.312
TFLOPS (a @ b): 9.698
TFLOPS (bmm): 21.079

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2773.73 MB
Max memory reserved: 3216.00 MB
Average grouped_gemm time: 82.424 μs

======================
Average nn.Linear time: 159.862 μs
Average a @ b time: 93.982 μs
Average bmm time: 65.765 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.940
Speedup (a @ b / grouped_gemm): 1.140
Speedup (bmm / grouped_gemm): 0.798

======================
TFLOPS (grouped_gemm): 28.704
TFLOPS (nn.Linear): 14.799
TFLOPS (a @ b): 25.173
TFLOPS (bmm): 35.974

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2773.73 MB
Max memory reserved: 3216.00 MB
Average grouped_gemm time: 108.130 μs

======================
Average nn.Linear time: 156.956 μs
Average a @ b time: 113.573 μs
Average bmm time: 106.351 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.452
Speedup (a @ b / grouped_gemm): 1.050
Speedup (bmm / grouped_gemm): 0.984

======================
TFLOPS (grouped_gemm): 45.364
TFLOPS (nn.Linear): 31.252
TFLOPS (a @ b): 43.190
TFLOPS (bmm): 46.123

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2773.73 MB
Max memory reserved: 3216.00 MB
Average grouped_gemm time: 137.758 μs

======================
Average nn.Linear time: 176.036 μs
Average a @ b time: 151.305 μs
Average bmm time: 181.201 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.278
Speedup (a @ b / grouped_gemm): 1.098
Speedup (bmm / grouped_gemm): 1.315

======================
TFLOPS (grouped_gemm): 58.134
TFLOPS (nn.Linear): 45.493
TFLOPS (a @ b): 52.929
TFLOPS (bmm): 44.197

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2773.73 MB
Max memory reserved: 3216.00 MB
Average grouped_gemm time: 279.078 μs

======================
Average nn.Linear time: 298.679 μs
Average a @ b time: 300.131 μs
Average bmm time: 382.333 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.070
Speedup (a @ b / grouped_gemm): 1.075
Speedup (bmm / grouped_gemm): 1.370

======================
TFLOPS (grouped_gemm): 81.540
TFLOPS (nn.Linear): 76.190
TFLOPS (a @ b): 75.821
TFLOPS (bmm): 59.519

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2773.73 MB
Max memory reserved: 3216.00 MB
Average grouped_gemm time: 360.711 μs

======================
Average nn.Linear time: 411.546 μs
Average a @ b time: 410.161 μs
Average bmm time: 557.790 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.141
Speedup (a @ b / grouped_gemm): 1.137
Speedup (bmm / grouped_gemm): 1.546

======================
TFLOPS (grouped_gemm): 88.855
TFLOPS (nn.Linear): 77.879
TFLOPS (a @ b): 78.142
TFLOPS (bmm): 57.460

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 677.264 μs

======================
Average nn.Linear time: 707.686 μs
Average a @ b time: 713.220 μs
Average bmm time: 1057.320 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.045
Speedup (a @ b / grouped_gemm): 1.053
Speedup (bmm / grouped_gemm): 1.561

======================
TFLOPS (grouped_gemm): 96.749
TFLOPS (nn.Linear): 92.590
TFLOPS (a @ b): 91.871
TFLOPS (bmm): 61.972

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 108.409 μs

======================
Average nn.Linear time: 189.230 μs
Average a @ b time: 131.013 μs
Average bmm time: 79.916 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.746
Speedup (a @ b / grouped_gemm): 1.209
Speedup (bmm / grouped_gemm): 0.737

======================
TFLOPS (grouped_gemm): 70.994
TFLOPS (nn.Linear): 40.672
TFLOPS (a @ b): 58.745
TFLOPS (bmm): 96.307

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 149.572 μs

======================
Average nn.Linear time: 195.649 μs
Average a @ b time: 180.159 μs
Average bmm time: 131.340 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.308
Speedup (a @ b / grouped_gemm): 1.204
Speedup (bmm / grouped_gemm): 0.878

======================
TFLOPS (grouped_gemm): 114.054
TFLOPS (nn.Linear): 87.193
TFLOPS (a @ b): 94.690
TFLOPS (bmm): 129.886

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 198.784 μs

======================
Average nn.Linear time: 252.643 μs
Average a @ b time: 245.764 μs
Average bmm time: 212.071 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.271
Speedup (a @ b / grouped_gemm): 1.236
Speedup (bmm / grouped_gemm): 1.067

======================
TFLOPS (grouped_gemm): 144.497
TFLOPS (nn.Linear): 113.693
TFLOPS (a @ b): 116.875
TFLOPS (bmm): 135.444

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 268.333 μs

======================
Average nn.Linear time: 258.698 μs
Average a @ b time: 249.588 μs
Average bmm time: 358.601 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.964
Speedup (a @ b / grouped_gemm): 0.930
Speedup (bmm / grouped_gemm): 1.336

======================
TFLOPS (grouped_gemm): 147.338
TFLOPS (nn.Linear): 152.825
TFLOPS (a @ b): 158.403
TFLOPS (bmm): 110.249

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 675.025 μs

======================
Average nn.Linear time: 664.840 μs
Average a @ b time: 666.518 μs
Average bmm time: 883.460 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.985
Speedup (a @ b / grouped_gemm): 0.987
Speedup (bmm / grouped_gemm): 1.309

======================
TFLOPS (grouped_gemm): 187.907
TFLOPS (nn.Linear): 190.786
TFLOPS (a @ b): 190.305
TFLOPS (bmm): 143.574

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 1312.625 μs

======================
Average nn.Linear time: 1244.833 μs
Average a @ b time: 1253.366 μs
Average bmm time: 1734.068 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.948
Speedup (a @ b / grouped_gemm): 0.955
Speedup (bmm / grouped_gemm): 1.321

======================
TFLOPS (grouped_gemm): 193.897
TFLOPS (nn.Linear): 204.457
TFLOPS (a @ b): 203.065
TFLOPS (bmm): 146.773

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 1730.826 μs

======================
Average nn.Linear time: 1601.334 μs
Average a @ b time: 1603.596 μs
Average bmm time: 3566.289 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.925
Speedup (a @ b / grouped_gemm): 0.926
Speedup (bmm / grouped_gemm): 2.060

======================
TFLOPS (grouped_gemm): 188.799
TFLOPS (nn.Linear): 204.066
TFLOPS (a @ b): 203.778
TFLOPS (bmm): 91.630

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 270.569 μs

======================
Average nn.Linear time: 305.517 μs
Average a @ b time: 296.822 μs
Average bmm time: 318.520 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.129
Speedup (a @ b / grouped_gemm): 1.097
Speedup (bmm / grouped_gemm): 1.177

======================
TFLOPS (grouped_gemm): 149.088
TFLOPS (nn.Linear): 132.034
TFLOPS (a @ b): 135.902
TFLOPS (bmm): 126.644

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 374.472 μs

======================
Average nn.Linear time: 412.211 μs
Average a @ b time: 402.622 μs
Average bmm time: 487.120 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.101
Speedup (a @ b / grouped_gemm): 1.075
Speedup (bmm / grouped_gemm): 1.301

======================
TFLOPS (grouped_gemm): 161.826
TFLOPS (nn.Linear): 147.010
TFLOPS (a @ b): 150.512
TFLOPS (bmm): 124.403

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 606.401 μs

======================
Average nn.Linear time: 631.762 μs
Average a @ b time: 624.490 μs
Average bmm time: 923.505 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.042
Speedup (a @ b / grouped_gemm): 1.030
Speedup (bmm / grouped_gemm): 1.523

======================
TFLOPS (grouped_gemm): 198.192
TFLOPS (nn.Linear): 190.236
TFLOPS (a @ b): 192.451
TFLOPS (bmm): 130.139

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 1181.943 μs

======================
Average nn.Linear time: 1219.394 μs
Average a @ b time: 1215.892 μs
Average bmm time: 1963.942 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.032
Speedup (a @ b / grouped_gemm): 1.029
Speedup (bmm / grouped_gemm): 1.662

======================
TFLOPS (grouped_gemm): 211.883
TFLOPS (nn.Linear): 205.375
TFLOPS (a @ b): 205.967
TFLOPS (bmm): 127.516

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 3184.44 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 2391.632 μs

======================
Average nn.Linear time: 2432.201 μs
Average a @ b time: 2435.064 μs
Average bmm time: 3796.520 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.017
Speedup (a @ b / grouped_gemm): 1.018
Speedup (bmm / grouped_gemm): 1.587

======================
TFLOPS (grouped_gemm): 228.043
TFLOPS (nn.Linear): 224.239
TFLOPS (a @ b): 223.975
TFLOPS (bmm): 143.656

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 3196.15 MB
Max memory reserved: 4038.00 MB
Average grouped_gemm time: 4749.737 μs

======================
Average nn.Linear time: 4572.790 μs
Average a @ b time: 4530.032 μs
Average bmm time: 9733.295 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.963
Speedup (a @ b / grouped_gemm): 0.954
Speedup (bmm / grouped_gemm): 2.049

======================
TFLOPS (grouped_gemm): 222.051
TFLOPS (nn.Linear): 230.643
TFLOPS (a @ b): 232.820
TFLOPS (bmm): 108.358

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 5270.35 MB
Max memory reserved: 6666.00 MB
Average grouped_gemm time: 8272.092 μs

======================
Average nn.Linear time: 8229.780 μs
Average a @ b time: 8198.528 μs
Average bmm time: 19218.552 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.995
Speedup (a @ b / grouped_gemm): 0.991
Speedup (bmm / grouped_gemm): 2.323

======================
TFLOPS (grouped_gemm): 218.168
TFLOPS (nn.Linear): 219.290
TFLOPS (a @ b): 220.126
TFLOPS (bmm): 93.904

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 5270.35 MB
Max memory reserved: 6666.00 MB
Average grouped_gemm time: 83.685 μs

======================
Average nn.Linear time: 152.242 μs
Average a @ b time: 89.393 μs
Average bmm time: 60.344 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.819
Speedup (a @ b / grouped_gemm): 1.068
Speedup (bmm / grouped_gemm): 0.721

======================
TFLOPS (grouped_gemm): 29.170
TFLOPS (nn.Linear): 16.034
TFLOPS (a @ b): 27.307
TFLOPS (bmm): 40.453

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 5270.35 MB
Max memory reserved: 6666.00 MB
Average grouped_gemm time: 109.410 μs

======================
Average nn.Linear time: 169.179 μs
Average a @ b time: 121.794 μs
Average bmm time: 93.668 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.546
Speedup (a @ b / grouped_gemm): 1.113
Speedup (bmm / grouped_gemm): 0.856

======================
TFLOPS (grouped_gemm): 48.182
TFLOPS (nn.Linear): 31.160
TFLOPS (a @ b): 43.283
TFLOPS (bmm): 56.280

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 5270.35 MB
Max memory reserved: 6666.00 MB
Average grouped_gemm time: 151.532 μs

======================
Average nn.Linear time: 180.824 μs
Average a @ b time: 169.408 μs
Average bmm time: 146.368 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.193
Speedup (a @ b / grouped_gemm): 1.118
Speedup (bmm / grouped_gemm): 0.966

======================
TFLOPS (grouped_gemm): 63.320
TFLOPS (nn.Linear): 53.063
TFLOPS (a @ b): 56.638
TFLOPS (bmm): 65.554

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 5270.35 MB
Max memory reserved: 6666.00 MB
Average grouped_gemm time: 251.679 μs

======================
Average nn.Linear time: 293.543 μs
Average a @ b time: 289.083 μs
Average bmm time: 292.594 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.166
Speedup (a @ b / grouped_gemm): 1.149
Speedup (bmm / grouped_gemm): 1.163

======================
TFLOPS (grouped_gemm): 83.905
TFLOPS (nn.Linear): 71.939
TFLOPS (a @ b): 73.049
TFLOPS (bmm): 72.173

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 5270.35 MB
Max memory reserved: 6666.00 MB
Average grouped_gemm time: 388.687 μs

======================
Average nn.Linear time: 429.292 μs
Average a @ b time: 427.184 μs
Average bmm time: 500.515 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.104
Speedup (a @ b / grouped_gemm): 1.099
Speedup (bmm / grouped_gemm): 1.288

======================
TFLOPS (grouped_gemm): 91.416
TFLOPS (nn.Linear): 82.769
TFLOPS (a @ b): 83.177
TFLOPS (bmm): 70.991

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 5270.35 MB
Max memory reserved: 8586.00 MB
Average grouped_gemm time: 596.247 μs

======================
Average nn.Linear time: 646.009 μs
Average a @ b time: 650.389 μs
Average bmm time: 1049.163 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.083
Speedup (a @ b / grouped_gemm): 1.091
Speedup (bmm / grouped_gemm): 1.760

======================
TFLOPS (grouped_gemm): 99.021
TFLOPS (nn.Linear): 91.394
TFLOPS (a @ b): 90.778
TFLOPS (bmm): 56.274

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 6261.24 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 1289.454 μs

======================
Average nn.Linear time: 1301.262 μs
Average a @ b time: 1317.887 μs
Average bmm time: 1758.354 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.009
Speedup (a @ b / grouped_gemm): 1.022
Speedup (bmm / grouped_gemm): 1.364

======================
TFLOPS (grouped_gemm): 102.021
TFLOPS (nn.Linear): 101.095
TFLOPS (a @ b): 99.820
TFLOPS (bmm): 74.815

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 6261.24 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 129.793 μs

======================
Average nn.Linear time: 184.295 μs
Average a @ b time: 170.903 μs
Average bmm time: 129.912 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.420
Speedup (a @ b / grouped_gemm): 1.317
Speedup (bmm / grouped_gemm): 1.001

======================
TFLOPS (grouped_gemm): 87.233
TFLOPS (nn.Linear): 61.435
TFLOPS (a @ b): 66.250
TFLOPS (bmm): 87.153

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 6261.24 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 178.876 μs

======================
Average nn.Linear time: 226.326 μs
Average a @ b time: 214.107 μs
Average bmm time: 230.377 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.265
Speedup (a @ b / grouped_gemm): 1.197
Speedup (bmm / grouped_gemm): 1.288

======================
TFLOPS (grouped_gemm): 144.544
TFLOPS (nn.Linear): 114.240
TFLOPS (a @ b): 120.760
TFLOPS (bmm): 112.231

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 6261.24 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 247.517 μs

======================
Average nn.Linear time: 278.180 μs
Average a @ b time: 269.024 μs
Average bmm time: 356.297 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.124
Speedup (a @ b / grouped_gemm): 1.087
Speedup (bmm / grouped_gemm): 1.439

======================
TFLOPS (grouped_gemm): 148.729
TFLOPS (nn.Linear): 132.335
TFLOPS (a @ b): 136.838
TFLOPS (bmm): 103.321

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 6261.24 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 444.174 μs

======================
Average nn.Linear time: 452.414 μs
Average a @ b time: 442.028 μs
Average bmm time: 717.273 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.019
Speedup (a @ b / grouped_gemm): 0.995
Speedup (bmm / grouped_gemm): 1.615

======================
TFLOPS (grouped_gemm): 179.250
TFLOPS (nn.Linear): 175.986
TFLOPS (a @ b): 180.121
TFLOPS (bmm): 111.002

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 6261.24 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 1276.166 μs

======================
Average nn.Linear time: 1197.848 μs
Average a @ b time: 1211.584 μs
Average bmm time: 1717.858 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.939
Speedup (a @ b / grouped_gemm): 0.949
Speedup (bmm / grouped_gemm): 1.346

======================
TFLOPS (grouped_gemm): 196.568
TFLOPS (nn.Linear): 209.420
TFLOPS (a @ b): 207.045
TFLOPS (bmm): 146.027

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 6261.24 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 2101.185 μs

======================
Average nn.Linear time: 1999.874 μs
Average a @ b time: 2007.225 μs
Average bmm time: 3390.980 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.952
Speedup (a @ b / grouped_gemm): 0.955
Speedup (bmm / grouped_gemm): 1.614

======================
TFLOPS (grouped_gemm): 202.315
TFLOPS (nn.Linear): 212.564
TFLOPS (a @ b): 211.786
TFLOPS (bmm): 125.362

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 6775.93 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 4144.444 μs

======================
Average nn.Linear time: 3931.944 μs
Average a @ b time: 3842.037 μs
Average bmm time: 8273.427 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.949
Speedup (a @ b / grouped_gemm): 0.927
Speedup (bmm / grouped_gemm): 1.996

======================
TFLOPS (grouped_gemm): 198.346
TFLOPS (nn.Linear): 209.065
TFLOPS (a @ b): 213.957
TFLOPS (bmm): 99.358

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 6775.93 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 390.704 μs

======================
Average nn.Linear time: 521.047 μs
Average a @ b time: 495.341 μs
Average bmm time: 591.609 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.334
Speedup (a @ b / grouped_gemm): 1.268
Speedup (bmm / grouped_gemm): 1.514

======================
TFLOPS (grouped_gemm): 194.265
TFLOPS (nn.Linear): 145.668
TFLOPS (a @ b): 153.228
TFLOPS (bmm): 128.294

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 6775.93 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 608.363 μs

======================
Average nn.Linear time: 699.201 μs
Average a @ b time: 685.685 μs
Average bmm time: 775.976 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.149
Speedup (a @ b / grouped_gemm): 1.127
Speedup (bmm / grouped_gemm): 1.276

======================
TFLOPS (grouped_gemm): 198.138
TFLOPS (nn.Linear): 172.397
TFLOPS (a @ b): 175.795
TFLOPS (bmm): 155.340

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 6775.93 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 1325.026 μs

======================
Average nn.Linear time: 1439.776 μs
Average a @ b time: 1428.428 μs
Average bmm time: 1951.618 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.087
Speedup (a @ b / grouped_gemm): 1.078
Speedup (bmm / grouped_gemm): 1.473

======================
TFLOPS (grouped_gemm): 227.254
TFLOPS (nn.Linear): 209.142
TFLOPS (a @ b): 210.803
TFLOPS (bmm): 154.291

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 6775.93 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 1697.760 μs

======================
Average nn.Linear time: 1759.825 μs
Average a @ b time: 1755.111 μs
Average bmm time: 3684.669 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.037
Speedup (a @ b / grouped_gemm): 1.034
Speedup (bmm / grouped_gemm): 2.170

======================
TFLOPS (grouped_gemm): 228.086
TFLOPS (nn.Linear): 220.042
TFLOPS (a @ b): 220.633
TFLOPS (bmm): 105.094

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 6775.93 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 4293.711 μs

======================
Average nn.Linear time: 4320.519 μs
Average a @ b time: 4267.006 μs
Average bmm time: 7620.041 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.006
Speedup (a @ b / grouped_gemm): 0.994
Speedup (bmm / grouped_gemm): 1.775

======================
TFLOPS (grouped_gemm): 228.457
TFLOPS (nn.Linear): 227.040
TFLOPS (a @ b): 229.887
TFLOPS (bmm): 128.730

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 6775.93 MB
Max memory reserved: 11818.00 MB
Average grouped_gemm time: 11834.958 μs

======================
Average nn.Linear time: 11335.201 μs
Average a @ b time: 11335.568 μs
Average bmm time: 20509.889 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.958
Speedup (a @ b / grouped_gemm): 0.958
Speedup (bmm / grouped_gemm): 1.733

======================
TFLOPS (grouped_gemm): 231.653
TFLOPS (nn.Linear): 241.866
TFLOPS (a @ b): 241.858
TFLOPS (bmm): 133.672

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 8990.71 MB
Max memory reserved: 15354.00 MB
Average grouped_gemm time: 18131.459 μs

======================
Average nn.Linear time: 17105.818 μs
Average a @ b time: 17076.423 μs
Average bmm time: 75177.312 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.943
Speedup (a @ b / grouped_gemm): 0.942
Speedup (bmm / grouped_gemm): 4.146

======================
TFLOPS (grouped_gemm): 218.883
TFLOPS (nn.Linear): 232.007
TFLOPS (a @ b): 232.406
TFLOPS (bmm): 52.791

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 8990.71 MB
Max memory reserved: 15354.00 MB
Average grouped_gemm time: 110.152 μs

======================
Average nn.Linear time: 153.456 μs
Average a @ b time: 118.792 μs
Average bmm time: 94.166 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.393
Speedup (a @ b / grouped_gemm): 1.078
Speedup (bmm / grouped_gemm): 0.855

======================
TFLOPS (grouped_gemm): 41.309
TFLOPS (nn.Linear): 29.652
TFLOPS (a @ b): 38.305
TFLOPS (bmm): 48.322

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 8990.71 MB
Max memory reserved: 15354.00 MB
Average grouped_gemm time: 151.169 μs

======================
Average nn.Linear time: 168.262 μs
Average a @ b time: 157.146 μs
Average bmm time: 159.657 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.113
Speedup (a @ b / grouped_gemm): 1.040
Speedup (bmm / grouped_gemm): 1.056

======================
TFLOPS (grouped_gemm): 65.187
TFLOPS (nn.Linear): 58.565
TFLOPS (a @ b): 62.707
TFLOPS (bmm): 61.721

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 8990.71 MB
Max memory reserved: 15354.00 MB
Average grouped_gemm time: 165.937 μs

======================
Average nn.Linear time: 175.245 μs
Average a @ b time: 162.590 μs
Average bmm time: 161.831 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.056
Speedup (a @ b / grouped_gemm): 0.980
Speedup (bmm / grouped_gemm): 0.975

======================
TFLOPS (grouped_gemm): 67.815
TFLOPS (nn.Linear): 64.213
TFLOPS (a @ b): 69.211
TFLOPS (bmm): 69.536

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 8990.71 MB
Max memory reserved: 15354.00 MB
Average grouped_gemm time: 430.093 μs

======================
Average nn.Linear time: 492.120 μs
Average a @ b time: 488.346 μs
Average bmm time: 563.974 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.144
Speedup (a @ b / grouped_gemm): 1.135
Speedup (bmm / grouped_gemm): 1.311

======================
TFLOPS (grouped_gemm): 95.696
TFLOPS (nn.Linear): 83.634
TFLOPS (a @ b): 84.281
TFLOPS (bmm): 72.979

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 8990.71 MB
Max memory reserved: 15354.00 MB
Average grouped_gemm time: 478.587 μs

======================
Average nn.Linear time: 529.668 μs
Average a @ b time: 529.342 μs
Average bmm time: 827.143 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.107
Speedup (a @ b / grouped_gemm): 1.106
Speedup (bmm / grouped_gemm): 1.728

======================
TFLOPS (grouped_gemm): 94.537
TFLOPS (nn.Linear): 85.419
TFLOPS (a @ b): 85.472
TFLOPS (bmm): 54.699

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 8990.71 MB
Max memory reserved: 15354.00 MB
Average grouped_gemm time: 1113.358 μs

======================
Average nn.Linear time: 1258.891 μs
Average a @ b time: 1272.442 μs
Average bmm time: 1544.161 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.131
Speedup (a @ b / grouped_gemm): 1.143
Speedup (bmm / grouped_gemm): 1.387

======================
TFLOPS (grouped_gemm): 105.035
TFLOPS (nn.Linear): 92.892
TFLOPS (a @ b): 91.903
TFLOPS (bmm): 75.731

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 21618.00 MB
Average grouped_gemm time: 2529.752 μs

======================
Average nn.Linear time: 2732.975 μs
Average a @ b time: 2779.293 μs
Average bmm time: 3409.200 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.080
Speedup (a @ b / grouped_gemm): 1.099
Speedup (bmm / grouped_gemm): 1.348

======================
TFLOPS (grouped_gemm): 106.405
TFLOPS (nn.Linear): 98.492
TFLOPS (a @ b): 96.851
TFLOPS (bmm): 78.956

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 21618.00 MB
Average grouped_gemm time: 182.250 μs

======================
Average nn.Linear time: 226.018 μs
Average a @ b time: 211.492 μs
Average bmm time: 217.772 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.240
Speedup (a @ b / grouped_gemm): 1.160
Speedup (bmm / grouped_gemm): 1.195

======================
TFLOPS (grouped_gemm): 135.711
TFLOPS (nn.Linear): 109.430
TFLOPS (a @ b): 116.947
TFLOPS (bmm): 113.574

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 21618.00 MB
Average grouped_gemm time: 204.794 μs

======================
Average nn.Linear time: 226.126 μs
Average a @ b time: 219.383 μs
Average bmm time: 242.229 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.104
Speedup (a @ b / grouped_gemm): 1.071
Speedup (bmm / grouped_gemm): 1.183

======================
TFLOPS (grouped_gemm): 140.836
TFLOPS (nn.Linear): 127.550
TFLOPS (a @ b): 131.470
TFLOPS (bmm): 119.071

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 21618.00 MB
Average grouped_gemm time: 476.706 μs

======================
Average nn.Linear time: 513.182 μs
Average a @ b time: 501.223 μs
Average bmm time: 754.840 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.077
Speedup (a @ b / grouped_gemm): 1.051
Speedup (bmm / grouped_gemm): 1.583

======================
TFLOPS (grouped_gemm): 183.221
TFLOPS (nn.Linear): 170.198
TFLOPS (a @ b): 174.259
TFLOPS (bmm): 115.710

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 21618.00 MB
Average grouped_gemm time: 914.166 μs

======================
Average nn.Linear time: 879.827 μs
Average a @ b time: 884.440 μs
Average bmm time: 1583.970 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.962
Speedup (a @ b / grouped_gemm): 0.967
Speedup (bmm / grouped_gemm): 1.733

======================
TFLOPS (grouped_gemm): 193.630
TFLOPS (nn.Linear): 201.188
TFLOPS (a @ b): 200.138
TFLOPS (bmm): 111.751

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 21618.00 MB
Average grouped_gemm time: 1806.626 μs

======================
Average nn.Linear time: 1711.872 μs
Average a @ b time: 1710.918 μs
Average bmm time: 3190.029 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.948
Speedup (a @ b / grouped_gemm): 0.947
Speedup (bmm / grouped_gemm): 1.766

======================
TFLOPS (grouped_gemm): 200.348
TFLOPS (nn.Linear): 211.437
TFLOPS (a @ b): 211.555
TFLOPS (bmm): 113.464

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 21618.00 MB
Average grouped_gemm time: 3502.266 μs

======================
Average nn.Linear time: 3293.760 μs
Average a @ b time: 3305.910 μs
Average bmm time: 5690.148 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.940
Speedup (a @ b / grouped_gemm): 0.944
Speedup (bmm / grouped_gemm): 1.625

======================
TFLOPS (grouped_gemm): 202.662
TFLOPS (nn.Linear): 215.491
TFLOPS (a @ b): 214.699
TFLOPS (bmm): 124.738

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 4815.507 μs

======================
Average nn.Linear time: 4429.824 μs
Average a @ b time: 4413.180 μs
Average bmm time: 17892.797 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.920
Speedup (a @ b / grouped_gemm): 0.916
Speedup (bmm / grouped_gemm): 3.716

======================
TFLOPS (grouped_gemm): 194.397
TFLOPS (nn.Linear): 211.322
TFLOPS (a @ b): 212.119
TFLOPS (bmm): 52.318

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 774.693 μs

======================
Average nn.Linear time: 922.039 μs
Average a @ b time: 899.873 μs
Average bmm time: 1150.527 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.190
Speedup (a @ b / grouped_gemm): 1.162
Speedup (bmm / grouped_gemm): 1.485

======================
TFLOPS (grouped_gemm): 207.551
TFLOPS (nn.Linear): 174.384
TFLOPS (a @ b): 178.679
TFLOPS (bmm): 139.752

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 1242.838 μs

======================
Average nn.Linear time: 1388.617 μs
Average a @ b time: 1371.765 μs
Average bmm time: 2116.745 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.117
Speedup (a @ b / grouped_gemm): 1.104
Speedup (bmm / grouped_gemm): 1.703

======================
TFLOPS (grouped_gemm): 224.241
TFLOPS (nn.Linear): 200.700
TFLOPS (a @ b): 203.165
TFLOPS (bmm): 131.662

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 1805.048 μs

======================
Average nn.Linear time: 1922.224 μs
Average a @ b time: 1931.038 μs
Average bmm time: 3530.192 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.065
Speedup (a @ b / grouped_gemm): 1.070
Speedup (bmm / grouped_gemm): 1.956

======================
TFLOPS (grouped_gemm): 225.167
TFLOPS (nn.Linear): 211.441
TFLOPS (a @ b): 210.476
TFLOPS (bmm): 115.132

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 4183.838 μs

======================
Average nn.Linear time: 4344.735 μs
Average a @ b time: 4349.177 μs
Average bmm time: 6644.909 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.038
Speedup (a @ b / grouped_gemm): 1.040
Speedup (bmm / grouped_gemm): 1.588

======================
TFLOPS (grouped_gemm): 235.219
TFLOPS (nn.Linear): 226.508
TFLOPS (a @ b): 226.277
TFLOPS (bmm): 148.101

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 6653.750 μs

======================
Average nn.Linear time: 6595.030 μs
Average a @ b time: 6583.855 μs
Average bmm time: 16046.805 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.991
Speedup (a @ b / grouped_gemm): 0.989
Speedup (bmm / grouped_gemm): 2.412

======================
TFLOPS (grouped_gemm): 233.281
TFLOPS (nn.Linear): 235.358
TFLOPS (a @ b): 235.758
TFLOPS (bmm): 96.729

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 12391.31 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 16846.762 μs

======================
Average nn.Linear time: 16013.842 μs
Average a @ b time: 16023.746 μs
Average bmm time: 36211.040 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.951
Speedup (a @ b / grouped_gemm): 0.951
Speedup (bmm / grouped_gemm): 2.149

======================
TFLOPS (grouped_gemm): 230.082
TFLOPS (nn.Linear): 242.049
TFLOPS (a @ b): 241.900
TFLOPS (bmm): 107.043

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 18201.33 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 49742.115 μs

======================
Average nn.Linear time: 48537.052 μs
Average a @ b time: 48525.534 μs
Average bmm time: 74625.633 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.976
Speedup (a @ b / grouped_gemm): 0.976
Speedup (bmm / grouped_gemm): 1.500

======================
TFLOPS (grouped_gemm): 228.723
TFLOPS (nn.Linear): 234.402
TFLOPS (a @ b): 234.457
TFLOPS (bmm): 152.457

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 18201.33 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 157.094 μs

======================
Average nn.Linear time: 178.864 μs
Average a @ b time: 159.311 μs
Average bmm time: 147.405 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.139
Speedup (a @ b / grouped_gemm): 1.014
Speedup (bmm / grouped_gemm): 0.938

======================
TFLOPS (grouped_gemm): 53.584
TFLOPS (nn.Linear): 47.062
TFLOPS (a @ b): 52.838
TFLOPS (bmm): 57.106

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 18201.33 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 253.985 μs

======================
Average nn.Linear time: 293.741 μs
Average a @ b time: 279.663 μs
Average bmm time: 286.324 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.157
Speedup (a @ b / grouped_gemm): 1.101
Speedup (bmm / grouped_gemm): 1.127

======================
TFLOPS (grouped_gemm): 81.218
TFLOPS (nn.Linear): 70.226
TFLOPS (a @ b): 73.761
TFLOPS (bmm): 72.045

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 18201.33 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 416.117 μs

======================
Average nn.Linear time: 456.116 μs
Average a @ b time: 452.051 μs
Average bmm time: 530.989 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.096
Speedup (a @ b / grouped_gemm): 1.086
Speedup (bmm / grouped_gemm): 1.276

======================
TFLOPS (grouped_gemm): 91.312
TFLOPS (nn.Linear): 83.304
TFLOPS (a @ b): 84.053
TFLOPS (bmm): 71.558

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 18201.33 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 747.552 μs

======================
Average nn.Linear time: 858.405 μs
Average a @ b time: 860.791 μs
Average bmm time: 1083.760 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.148
Speedup (a @ b / grouped_gemm): 1.151
Speedup (bmm / grouped_gemm): 1.450

======================
TFLOPS (grouped_gemm): 102.663
TFLOPS (nn.Linear): 89.405
TFLOPS (a @ b): 89.157
TFLOPS (bmm): 70.814

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 18201.33 MB
Max memory reserved: 28690.00 MB
Average grouped_gemm time: 1159.379 μs

======================
Average nn.Linear time: 1297.295 μs
Average a @ b time: 1306.515 μs
Average bmm time: 2097.690 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.119
Speedup (a @ b / grouped_gemm): 1.127
Speedup (bmm / grouped_gemm): 1.809

======================
TFLOPS (grouped_gemm): 104.395
TFLOPS (nn.Linear): 93.297
TFLOPS (a @ b): 92.639
TFLOPS (bmm): 57.699

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 18201.33 MB
Max memory reserved: 35922.00 MB
Average grouped_gemm time: 2402.921 μs

======================
Average nn.Linear time: 2696.285 μs
Average a @ b time: 2727.008 μs
Average bmm time: 3972.032 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.122
Speedup (a @ b / grouped_gemm): 1.135
Speedup (bmm / grouped_gemm): 1.653

======================
TFLOPS (grouped_gemm): 108.929
TFLOPS (nn.Linear): 97.077
TFLOPS (a @ b): 95.983
TFLOPS (bmm): 65.898

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 24088.14 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 4488.285 μs

======================
Average nn.Linear time: 4811.406 μs
Average a @ b time: 4841.568 μs
Average bmm time: 7102.647 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.072
Speedup (a @ b / grouped_gemm): 1.079
Speedup (bmm / grouped_gemm): 1.582

======================
TFLOPS (grouped_gemm): 107.354
TFLOPS (nn.Linear): 100.145
TFLOPS (a @ b): 99.521
TFLOPS (bmm): 67.839

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 24088.14 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 283.790 μs

======================
Average nn.Linear time: 338.526 μs
Average a @ b time: 329.993 μs
Average bmm time: 436.301 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.193
Speedup (a @ b / grouped_gemm): 1.163
Speedup (bmm / grouped_gemm): 1.537

======================
TFLOPS (grouped_gemm): 157.701
TFLOPS (nn.Linear): 132.202
TFLOPS (a @ b): 135.621
TFLOPS (bmm): 102.576

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 24088.14 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 461.657 μs

======================
Average nn.Linear time: 478.644 μs
Average a @ b time: 477.097 μs
Average bmm time: 819.340 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.037
Speedup (a @ b / grouped_gemm): 1.033
Speedup (bmm / grouped_gemm): 1.775

======================
TFLOPS (grouped_gemm): 176.561
TFLOPS (nn.Linear): 170.295
TFLOPS (a @ b): 170.847
TFLOPS (bmm): 99.483

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 24088.14 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 1081.355 μs

======================
Average nn.Linear time: 1129.446 μs
Average a @ b time: 1117.489 μs
Average bmm time: 1743.138 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.044
Speedup (a @ b / grouped_gemm): 1.033
Speedup (bmm / grouped_gemm): 1.612

======================
TFLOPS (grouped_gemm): 197.604
TFLOPS (nn.Linear): 189.190
TFLOPS (a @ b): 191.214
TFLOPS (bmm): 122.583

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 24088.14 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 2515.252 μs

======================
Average nn.Linear time: 2433.438 μs
Average a @ b time: 2436.657 μs
Average bmm time: 3399.572 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.967
Speedup (a @ b / grouped_gemm): 0.969
Speedup (bmm / grouped_gemm): 1.352

======================
TFLOPS (grouped_gemm): 206.339
TFLOPS (nn.Linear): 213.276
TFLOPS (a @ b): 212.995
TFLOPS (bmm): 152.665

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 24088.14 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 4508.810 μs

======================
Average nn.Linear time: 4288.747 μs
Average a @ b time: 4297.228 μs
Average bmm time: 6161.366 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.951
Speedup (a @ b / grouped_gemm): 0.953
Speedup (bmm / grouped_gemm): 1.367

======================
TFLOPS (grouped_gemm): 207.789
TFLOPS (nn.Linear): 218.451
TFLOPS (a @ b): 218.020
TFLOPS (bmm): 152.057

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 24088.14 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 5543.606 μs

======================
Average nn.Linear time: 5208.955 μs
Average a @ b time: 5224.614 μs
Average bmm time: 8084.612 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.940
Speedup (a @ b / grouped_gemm): 0.942
Speedup (bmm / grouped_gemm): 1.458

======================
TFLOPS (grouped_gemm): 206.055
TFLOPS (nn.Linear): 219.293
TFLOPS (a @ b): 218.636
TFLOPS (bmm): 141.292

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 25286.19 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 15879.591 μs

======================
Average nn.Linear time: 14901.145 μs
Average a @ b time: 14929.390 μs
Average bmm time: 21612.546 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.938
Speedup (a @ b / grouped_gemm): 0.940
Speedup (bmm / grouped_gemm): 1.361

======================
TFLOPS (grouped_gemm): 203.222
TFLOPS (nn.Linear): 216.567
TFLOPS (a @ b): 216.157
TFLOPS (bmm): 149.316

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 25286.19 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 1134.152 μs

======================
Average nn.Linear time: 1200.175 μs
Average a @ b time: 1203.017 μs
Average bmm time: 1772.287 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.058
Speedup (a @ b / grouped_gemm): 1.061
Speedup (bmm / grouped_gemm): 1.563

======================
TFLOPS (grouped_gemm): 203.278
TFLOPS (nn.Linear): 192.096
TFLOPS (a @ b): 191.642
TFLOPS (bmm): 130.085

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 25286.19 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 2697.380 μs

======================
Average nn.Linear time: 2799.790 μs
Average a @ b time: 2824.914 μs
Average bmm time: 3826.466 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.038
Speedup (a @ b / grouped_gemm): 1.047
Speedup (bmm / grouped_gemm): 1.419

======================
TFLOPS (grouped_gemm): 227.463
TFLOPS (nn.Linear): 219.143
TFLOPS (a @ b): 217.194
TFLOPS (bmm): 160.345

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 25286.19 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 6120.849 μs

======================
Average nn.Linear time: 6330.571 μs
Average a @ b time: 6344.428 μs
Average bmm time: 8024.821 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.034
Speedup (a @ b / grouped_gemm): 1.037
Speedup (bmm / grouped_gemm): 1.311

======================
TFLOPS (grouped_gemm): 239.167
TFLOPS (nn.Linear): 231.244
TFLOPS (a @ b): 230.739
TFLOPS (bmm): 182.422

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 25286.19 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 6918.168 μs

======================
Average nn.Linear time: 6936.216 μs
Average a @ b time: 6926.301 μs
Average bmm time: 11483.567 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.003
Speedup (a @ b / grouped_gemm): 1.001
Speedup (bmm / grouped_gemm): 1.660

======================
TFLOPS (grouped_gemm): 237.245
TFLOPS (nn.Linear): 236.627
TFLOPS (a @ b): 236.966
TFLOPS (bmm): 142.926

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 25286.19 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 22887.435 μs

======================
Average nn.Linear time: 22366.073 μs
Average a @ b time: 22393.117 μs
Average bmm time: 34067.731 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.977
Speedup (a @ b / grouped_gemm): 0.978
Speedup (bmm / grouped_gemm): 1.488

======================
TFLOPS (grouped_gemm): 239.751
TFLOPS (nn.Linear): 245.340
TFLOPS (a @ b): 245.044
TFLOPS (bmm): 161.070

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 25286.19 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 35419.395 μs

======================
Average nn.Linear time: 33694.561 μs
Average a @ b time: 33685.815 μs
Average bmm time: 66657.131 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.951
Speedup (a @ b / grouped_gemm): 0.951
Speedup (bmm / grouped_gemm): 1.882

======================
TFLOPS (grouped_gemm): 233.864
TFLOPS (nn.Linear): 245.835
TFLOPS (a @ b): 245.899
TFLOPS (bmm): 124.267

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 29763.77 MB
Max memory reserved: 49082.00 MB
Average grouped_gemm time: 76324.866 μs

======================
Average nn.Linear time: 72771.437 μs
Average a @ b time: 72846.425 μs
Average bmm time: 277782.750 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.953
Speedup (a @ b / grouped_gemm): 0.954
Speedup (bmm / grouped_gemm): 3.639

======================
TFLOPS (grouped_gemm): 223.732
TFLOPS (nn.Linear): 234.657
TFLOPS (a @ b): 234.415
TFLOPS (bmm): 61.474

--------------------------------------------------

