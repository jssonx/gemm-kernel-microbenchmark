Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 15.68 MB
Max memory reserved: 26.00 MB
Average grouped_gemm time: 79.830 μs

======================
Average nn.Linear time: 172.744 μs
Average a @ b time: 104.635 μs
Average bmm time: 22.960 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.164
Speedup (a @ b / grouped_gemm): 1.311
Speedup (bmm / grouped_gemm): 0.288

======================
TFLOPS (grouped_gemm): 0.970
TFLOPS (nn.Linear): 0.448
TFLOPS (a @ b): 0.740
TFLOPS (bmm): 3.374

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 22.19 MB
Max memory reserved: 30.00 MB
Average grouped_gemm time: 79.720 μs

======================
Average nn.Linear time: 160.823 μs
Average a @ b time: 98.376 μs
Average bmm time: 23.222 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.017
Speedup (a @ b / grouped_gemm): 1.234
Speedup (bmm / grouped_gemm): 0.291

======================
TFLOPS (grouped_gemm): 1.223
TFLOPS (nn.Linear): 0.606
TFLOPS (a @ b): 0.991
TFLOPS (bmm): 4.199

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 35.98 MB
Max memory reserved: 50.00 MB
Average grouped_gemm time: 79.887 μs

======================
Average nn.Linear time: 146.592 μs
Average a @ b time: 89.965 μs
Average bmm time: 27.719 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.835
Speedup (a @ b / grouped_gemm): 1.126
Speedup (bmm / grouped_gemm): 0.347

======================
TFLOPS (grouped_gemm): 2.737
TFLOPS (nn.Linear): 1.491
TFLOPS (a @ b): 2.430
TFLOPS (bmm): 7.887

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 62.59 MB
Max memory reserved: 94.00 MB
Average grouped_gemm time: 105.934 μs

======================
Average nn.Linear time: 159.242 μs
Average a @ b time: 91.593 μs
Average bmm time: 36.871 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.503
Speedup (a @ b / grouped_gemm): 0.865
Speedup (bmm / grouped_gemm): 0.348

======================
TFLOPS (grouped_gemm): 3.623
TFLOPS (nn.Linear): 2.410
TFLOPS (a @ b): 4.190
TFLOPS (bmm): 10.409

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 117.75 MB
Max memory reserved: 162.00 MB
Average grouped_gemm time: 122.156 μs

======================
Average nn.Linear time: 144.043 μs
Average a @ b time: 87.857 μs
Average bmm time: 56.164 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.179
Speedup (a @ b / grouped_gemm): 0.719
Speedup (bmm / grouped_gemm): 0.460

======================
TFLOPS (grouped_gemm): 6.747
TFLOPS (nn.Linear): 5.722
TFLOPS (a @ b): 9.381
TFLOPS (bmm): 14.674

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 225.91 MB
Max memory reserved: 294.00 MB
Average grouped_gemm time: 167.935 μs

======================
Average nn.Linear time: 147.781 μs
Average a @ b time: 168.302 μs
Average bmm time: 85.640 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.880
Speedup (a @ b / grouped_gemm): 1.002
Speedup (bmm / grouped_gemm): 0.510

======================
TFLOPS (grouped_gemm): 10.415
TFLOPS (nn.Linear): 11.835
TFLOPS (a @ b): 10.392
TFLOPS (bmm): 20.423

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 391.19 MB
Max memory reserved: 554.00 MB
Average grouped_gemm time: 256.820 μs

======================
Average nn.Linear time: 156.100 μs
Average a @ b time: 202.215 μs
Average bmm time: 152.321 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.608
Speedup (a @ b / grouped_gemm): 0.787
Speedup (bmm / grouped_gemm): 0.593

======================
TFLOPS (grouped_gemm): 10.975
TFLOPS (nn.Linear): 18.056
TFLOPS (a @ b): 13.939
TFLOPS (bmm): 18.504

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 391.19 MB
Max memory reserved: 554.00 MB
Average grouped_gemm time: 150.669 μs

======================
Average nn.Linear time: 181.446 μs
Average a @ b time: 100.510 μs
Average bmm time: 32.797 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.204
Speedup (a @ b / grouped_gemm): 0.667
Speedup (bmm / grouped_gemm): 0.218

======================
TFLOPS (grouped_gemm): 2.046
TFLOPS (nn.Linear): 1.699
TFLOPS (a @ b): 3.067
TFLOPS (bmm): 9.400

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 391.19 MB
Max memory reserved: 554.00 MB
Average grouped_gemm time: 152.318 μs

======================
Average nn.Linear time: 170.348 μs
Average a @ b time: 105.076 μs
Average bmm time: 39.098 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.118
Speedup (a @ b / grouped_gemm): 0.690
Speedup (bmm / grouped_gemm): 0.257

======================
TFLOPS (grouped_gemm): 3.167
TFLOPS (nn.Linear): 2.832
TFLOPS (a @ b): 4.590
TFLOPS (bmm): 12.337

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 391.19 MB
Max memory reserved: 554.00 MB
Average grouped_gemm time: 152.380 μs

======================
Average nn.Linear time: 169.404 μs
Average a @ b time: 123.515 μs
Average bmm time: 64.545 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.112
Speedup (a @ b / grouped_gemm): 0.811
Speedup (bmm / grouped_gemm): 0.424

======================
TFLOPS (grouped_gemm): 5.835
TFLOPS (nn.Linear): 5.249
TFLOPS (a @ b): 7.199
TFLOPS (bmm): 13.776

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 391.19 MB
Max memory reserved: 554.00 MB
Average grouped_gemm time: 259.039 μs

======================
Average nn.Linear time: 174.055 μs
Average a @ b time: 171.082 μs
Average bmm time: 111.167 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.672
Speedup (a @ b / grouped_gemm): 0.660
Speedup (bmm / grouped_gemm): 0.429

======================
TFLOPS (grouped_gemm): 11.010
TFLOPS (nn.Linear): 16.386
TFLOPS (a @ b): 16.671
TFLOPS (bmm): 25.656

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 561.84 MB
Max memory reserved: 874.00 MB
Average grouped_gemm time: 358.021 μs

======================
Average nn.Linear time: 194.309 μs
Average a @ b time: 223.114 μs
Average bmm time: 184.698 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.543
Speedup (a @ b / grouped_gemm): 0.623
Speedup (bmm / grouped_gemm): 0.516

======================
TFLOPS (grouped_gemm): 12.840
TFLOPS (nn.Linear): 23.658
TFLOPS (a @ b): 20.604
TFLOPS (bmm): 24.889

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1113.02 MB
Max memory reserved: 1642.00 MB
Average grouped_gemm time: 565.290 μs

======================
Average nn.Linear time: 408.301 μs
Average a @ b time: 399.532 μs
Average bmm time: 337.362 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.722
Speedup (a @ b / grouped_gemm): 0.707
Speedup (bmm / grouped_gemm): 0.597

======================
TFLOPS (grouped_gemm): 14.839
TFLOPS (nn.Linear): 20.545
TFLOPS (a @ b): 20.996
TFLOPS (bmm): 24.865

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2986.00 MB
Average grouped_gemm time: 986.667 μs

======================
Average nn.Linear time: 665.703 μs
Average a @ b time: 657.558 μs
Average bmm time: 678.365 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.675
Speedup (a @ b / grouped_gemm): 0.666
Speedup (bmm / grouped_gemm): 0.688

======================
TFLOPS (grouped_gemm): 12.974
TFLOPS (nn.Linear): 19.229
TFLOPS (a @ b): 19.467
TFLOPS (bmm): 18.870

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2986.00 MB
Average grouped_gemm time: 75.500 μs

======================
Average nn.Linear time: 169.065 μs
Average a @ b time: 96.591 μs
Average bmm time: 20.890 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.239
Speedup (a @ b / grouped_gemm): 1.279
Speedup (bmm / grouped_gemm): 0.277

======================
TFLOPS (grouped_gemm): 0.891
TFLOPS (nn.Linear): 0.398
TFLOPS (a @ b): 0.696
TFLOPS (bmm): 3.219

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2986.00 MB
Average grouped_gemm time: 73.168 μs

======================
Average nn.Linear time: 162.132 μs
Average a @ b time: 91.240 μs
Average bmm time: 21.377 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.216
Speedup (a @ b / grouped_gemm): 1.247
Speedup (bmm / grouped_gemm): 0.292

======================
TFLOPS (grouped_gemm): 2.193
TFLOPS (nn.Linear): 0.990
TFLOPS (a @ b): 1.758
TFLOPS (bmm): 7.505

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2986.00 MB
Average grouped_gemm time: 72.987 μs

======================
Average nn.Linear time: 149.186 μs
Average a @ b time: 80.132 μs
Average bmm time: 25.759 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.044
Speedup (a @ b / grouped_gemm): 1.098
Speedup (bmm / grouped_gemm): 0.353

======================
TFLOPS (grouped_gemm): 5.086
TFLOPS (nn.Linear): 2.488
TFLOPS (a @ b): 4.632
TFLOPS (bmm): 14.410

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2986.00 MB
Average grouped_gemm time: 95.973 μs

======================
Average nn.Linear time: 145.400 μs
Average a @ b time: 77.560 μs
Average bmm time: 34.976 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.515
Speedup (a @ b / grouped_gemm): 0.808
Speedup (bmm / grouped_gemm): 0.364

======================
TFLOPS (grouped_gemm): 8.653
TFLOPS (nn.Linear): 5.712
TFLOPS (a @ b): 10.707
TFLOPS (bmm): 23.744

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2986.00 MB
Average grouped_gemm time: 120.265 μs

======================
Average nn.Linear time: 146.012 μs
Average a @ b time: 88.520 μs
Average bmm time: 58.761 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.214
Speedup (a @ b / grouped_gemm): 0.736
Speedup (bmm / grouped_gemm): 0.489

======================
TFLOPS (grouped_gemm): 13.863
TFLOPS (nn.Linear): 11.418
TFLOPS (a @ b): 18.835
TFLOPS (bmm): 28.373

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 166.643 μs

======================
Average nn.Linear time: 157.671 μs
Average a @ b time: 198.126 μs
Average bmm time: 87.945 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.946
Speedup (a @ b / grouped_gemm): 1.189
Speedup (bmm / grouped_gemm): 0.528

======================
TFLOPS (grouped_gemm): 20.085
TFLOPS (nn.Linear): 21.228
TFLOPS (a @ b): 16.894
TFLOPS (bmm): 38.058

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 258.191 μs

======================
Average nn.Linear time: 150.723 μs
Average a @ b time: 194.199 μs
Average bmm time: 158.966 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.584
Speedup (a @ b / grouped_gemm): 0.752
Speedup (bmm / grouped_gemm): 0.616

======================
TFLOPS (grouped_gemm): 21.833
TFLOPS (nn.Linear): 37.401
TFLOPS (a @ b): 29.028
TFLOPS (bmm): 35.461

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 150.311 μs

======================
Average nn.Linear time: 171.356 μs
Average a @ b time: 98.741 μs
Average bmm time: 32.578 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.140
Speedup (a @ b / grouped_gemm): 0.657
Speedup (bmm / grouped_gemm): 0.217

======================
TFLOPS (grouped_gemm): 4.827
TFLOPS (nn.Linear): 4.235
TFLOPS (a @ b): 7.349
TFLOPS (bmm): 22.273

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 151.007 μs

======================
Average nn.Linear time: 167.196 μs
Average a @ b time: 109.270 μs
Average bmm time: 40.934 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.107
Speedup (a @ b / grouped_gemm): 0.724
Speedup (bmm / grouped_gemm): 0.271

======================
TFLOPS (grouped_gemm): 6.694
TFLOPS (nn.Linear): 6.046
TFLOPS (a @ b): 9.251
TFLOPS (bmm): 24.694

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 152.514 μs

======================
Average nn.Linear time: 168.197 μs
Average a @ b time: 124.540 μs
Average bmm time: 65.448 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.103
Speedup (a @ b / grouped_gemm): 0.817
Speedup (bmm / grouped_gemm): 0.429

======================
TFLOPS (grouped_gemm): 11.385
TFLOPS (nn.Linear): 10.324
TFLOPS (a @ b): 13.943
TFLOPS (bmm): 26.532

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 253.854 μs

======================
Average nn.Linear time: 167.425 μs
Average a @ b time: 169.146 μs
Average bmm time: 112.514 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.660
Speedup (a @ b / grouped_gemm): 0.666
Speedup (bmm / grouped_gemm): 0.443

======================
TFLOPS (grouped_gemm): 9.319
TFLOPS (nn.Linear): 14.129
TFLOPS (a @ b): 13.985
TFLOPS (bmm): 21.025

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 361.440 μs

======================
Average nn.Linear time: 202.618 μs
Average a @ b time: 225.737 μs
Average bmm time: 193.765 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.561
Speedup (a @ b / grouped_gemm): 0.625
Speedup (bmm / grouped_gemm): 0.536

======================
TFLOPS (grouped_gemm): 20.702
TFLOPS (nn.Linear): 36.930
TFLOPS (a @ b): 33.148
TFLOPS (bmm): 38.617

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1936.42 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 565.572 μs

======================
Average nn.Linear time: 419.171 μs
Average a @ b time: 411.689 μs
Average bmm time: 351.226 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.741
Speedup (a @ b / grouped_gemm): 0.728
Speedup (bmm / grouped_gemm): 0.621

======================
TFLOPS (grouped_gemm): 27.054
TFLOPS (nn.Linear): 36.503
TFLOPS (a @ b): 37.166
TFLOPS (bmm): 43.564

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 981.524 μs

======================
Average nn.Linear time: 674.794 μs
Average a @ b time: 668.149 μs
Average bmm time: 693.824 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.687
Speedup (a @ b / grouped_gemm): 0.681
Speedup (bmm / grouped_gemm): 0.707

======================
TFLOPS (grouped_gemm): 27.759
TFLOPS (nn.Linear): 40.377
TFLOPS (a @ b): 40.779
TFLOPS (bmm): 39.270

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 74.103 μs

======================
Average nn.Linear time: 188.735 μs
Average a @ b time: 109.053 μs
Average bmm time: 22.228 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.547
Speedup (a @ b / grouped_gemm): 1.472
Speedup (bmm / grouped_gemm): 0.300

======================
TFLOPS (grouped_gemm): 3.661
TFLOPS (nn.Linear): 1.438
TFLOPS (a @ b): 2.488
TFLOPS (bmm): 12.206

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 74.472 μs

======================
Average nn.Linear time: 176.957 μs
Average a @ b time: 100.815 μs
Average bmm time: 26.164 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.376
Speedup (a @ b / grouped_gemm): 1.354
Speedup (bmm / grouped_gemm): 0.351

======================
TFLOPS (grouped_gemm): 5.871
TFLOPS (nn.Linear): 2.471
TFLOPS (a @ b): 4.337
TFLOPS (bmm): 16.712

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 74.606 μs

======================
Average nn.Linear time: 147.347 μs
Average a @ b time: 80.919 μs
Average bmm time: 35.369 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.975
Speedup (a @ b / grouped_gemm): 1.085
Speedup (bmm / grouped_gemm): 0.474

======================
TFLOPS (grouped_gemm): 11.975
TFLOPS (nn.Linear): 6.063
TFLOPS (a @ b): 11.040
TFLOPS (bmm): 25.259

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2990.00 MB
Average grouped_gemm time: 96.860 μs

======================
Average nn.Linear time: 153.351 μs
Average a @ b time: 82.092 μs
Average bmm time: 48.690 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.583
Speedup (a @ b / grouped_gemm): 0.848
Speedup (bmm / grouped_gemm): 0.503

======================
TFLOPS (grouped_gemm): 18.739
TFLOPS (nn.Linear): 11.836
TFLOPS (a @ b): 22.110
TFLOPS (bmm): 37.279

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2994.00 MB
Average grouped_gemm time: 123.856 μs

======================
Average nn.Linear time: 150.537 μs
Average a @ b time: 98.937 μs
Average bmm time: 76.077 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.215
Speedup (a @ b / grouped_gemm): 0.799
Speedup (bmm / grouped_gemm): 0.614

======================
TFLOPS (grouped_gemm): 32.561
TFLOPS (nn.Linear): 26.789
TFLOPS (a @ b): 40.762
TFLOPS (bmm): 53.010

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2994.00 MB
Average grouped_gemm time: 170.999 μs

======================
Average nn.Linear time: 166.247 μs
Average a @ b time: 177.357 μs
Average bmm time: 98.650 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.972
Speedup (a @ b / grouped_gemm): 1.037
Speedup (bmm / grouped_gemm): 0.577

======================
TFLOPS (grouped_gemm): 41.208
TFLOPS (nn.Linear): 42.385
TFLOPS (a @ b): 39.730
TFLOPS (bmm): 71.428

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2994.00 MB
Average grouped_gemm time: 262.814 μs

======================
Average nn.Linear time: 205.505 μs
Average a @ b time: 218.327 μs
Average bmm time: 163.631 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.782
Speedup (a @ b / grouped_gemm): 0.831
Speedup (bmm / grouped_gemm): 0.623

======================
TFLOPS (grouped_gemm): 46.082
TFLOPS (nn.Linear): 58.933
TFLOPS (a @ b): 55.472
TFLOPS (bmm): 74.014

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2994.00 MB
Average grouped_gemm time: 154.657 μs

======================
Average nn.Linear time: 175.667 μs
Average a @ b time: 103.621 μs
Average bmm time: 35.591 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.136
Speedup (a @ b / grouped_gemm): 0.670
Speedup (bmm / grouped_gemm): 0.230

======================
TFLOPS (grouped_gemm): 5.126
TFLOPS (nn.Linear): 4.513
TFLOPS (a @ b): 7.650
TFLOPS (bmm): 22.273

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2994.00 MB
Average grouped_gemm time: 152.416 μs

======================
Average nn.Linear time: 171.008 μs
Average a @ b time: 111.344 μs
Average bmm time: 50.774 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.122
Speedup (a @ b / grouped_gemm): 0.731
Speedup (bmm / grouped_gemm): 0.333

======================
TFLOPS (grouped_gemm): 8.421
TFLOPS (nn.Linear): 7.505
TFLOPS (a @ b): 11.527
TFLOPS (bmm): 25.278

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2994.00 MB
Average grouped_gemm time: 153.344 μs

======================
Average nn.Linear time: 167.086 μs
Average a @ b time: 140.247 μs
Average bmm time: 92.533 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.090
Speedup (a @ b / grouped_gemm): 0.915
Speedup (bmm / grouped_gemm): 0.603

======================
TFLOPS (grouped_gemm): 37.691
TFLOPS (nn.Linear): 34.591
TFLOPS (a @ b): 41.211
TFLOPS (bmm): 62.462

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2994.00 MB
Average grouped_gemm time: 255.518 μs

======================
Average nn.Linear time: 171.592 μs
Average a @ b time: 181.482 μs
Average bmm time: 144.987 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.672
Speedup (a @ b / grouped_gemm): 0.710
Speedup (bmm / grouped_gemm): 0.567

======================
TFLOPS (grouped_gemm): 41.300
TFLOPS (nn.Linear): 61.500
TFLOPS (a @ b): 58.148
TFLOPS (bmm): 72.785

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 360.539 μs

======================
Average nn.Linear time: 264.146 μs
Average a @ b time: 254.781 μs
Average bmm time: 248.861 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.733
Speedup (a @ b / grouped_gemm): 0.707
Speedup (bmm / grouped_gemm): 0.690

======================
TFLOPS (grouped_gemm): 55.840
TFLOPS (nn.Linear): 76.218
TFLOPS (a @ b): 79.019
TFLOPS (bmm): 80.899

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1960.59 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 570.304 μs

======================
Average nn.Linear time: 439.849 μs
Average a @ b time: 433.123 μs
Average bmm time: 377.598 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.771
Speedup (a @ b / grouped_gemm): 0.759
Speedup (bmm / grouped_gemm): 0.662

======================
TFLOPS (grouped_gemm): 46.245
TFLOPS (nn.Linear): 59.961
TFLOPS (a @ b): 60.892
TFLOPS (bmm): 69.846

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 1008.539 μs

======================
Average nn.Linear time: 792.513 μs
Average a @ b time: 780.818 μs
Average bmm time: 669.456 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.786
Speedup (a @ b / grouped_gemm): 0.774
Speedup (bmm / grouped_gemm): 0.664

======================
TFLOPS (grouped_gemm): 75.806
TFLOPS (nn.Linear): 96.470
TFLOPS (a @ b): 97.915
TFLOPS (bmm): 114.203

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 75.209 μs

======================
Average nn.Linear time: 179.546 μs
Average a @ b time: 105.145 μs
Average bmm time: 23.613 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.387
Speedup (a @ b / grouped_gemm): 1.398
Speedup (bmm / grouped_gemm): 0.314

======================
TFLOPS (grouped_gemm): 6.985
TFLOPS (nn.Linear): 2.926
TFLOPS (a @ b): 4.996
TFLOPS (bmm): 22.248

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 73.352 μs

======================
Average nn.Linear time: 171.392 μs
Average a @ b time: 98.310 μs
Average bmm time: 26.884 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.337
Speedup (a @ b / grouped_gemm): 1.340
Speedup (bmm / grouped_gemm): 0.367

======================
TFLOPS (grouped_gemm): 8.459
TFLOPS (nn.Linear): 3.620
TFLOPS (a @ b): 6.312
TFLOPS (bmm): 23.080

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 75.104 μs

======================
Average nn.Linear time: 148.976 μs
Average a @ b time: 81.158 μs
Average bmm time: 38.319 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.984
Speedup (a @ b / grouped_gemm): 1.081
Speedup (bmm / grouped_gemm): 0.510

======================
TFLOPS (grouped_gemm): 31.853
TFLOPS (nn.Linear): 16.058
TFLOPS (a @ b): 29.478
TFLOPS (bmm): 62.432

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 98.028 μs

======================
Average nn.Linear time: 146.627 μs
Average a @ b time: 89.386 μs
Average bmm time: 54.476 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.496
Speedup (a @ b / grouped_gemm): 0.912
Speedup (bmm / grouped_gemm): 0.556

======================
TFLOPS (grouped_gemm): 34.882
TFLOPS (nn.Linear): 23.320
TFLOPS (a @ b): 38.255
TFLOPS (bmm): 62.769

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 121.632 μs

======================
Average nn.Linear time: 148.098 μs
Average a @ b time: 98.786 μs
Average bmm time: 100.560 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.218
Speedup (a @ b / grouped_gemm): 0.812
Speedup (bmm / grouped_gemm): 0.827

======================
TFLOPS (grouped_gemm): 35.070
TFLOPS (nn.Linear): 28.803
TFLOPS (a @ b): 43.180
TFLOPS (bmm): 42.418

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 170.341 μs

======================
Average nn.Linear time: 205.069 μs
Average a @ b time: 213.335 μs
Average bmm time: 133.920 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.204
Speedup (a @ b / grouped_gemm): 1.252
Speedup (bmm / grouped_gemm): 0.786

======================
TFLOPS (grouped_gemm): 72.392
TFLOPS (nn.Linear): 60.132
TFLOPS (a @ b): 57.802
TFLOPS (bmm): 92.079

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 261.667 μs

======================
Average nn.Linear time: 202.804 μs
Average a @ b time: 230.443 μs
Average bmm time: 218.933 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.775
Speedup (a @ b / grouped_gemm): 0.881
Speedup (bmm / grouped_gemm): 0.837

======================
TFLOPS (grouped_gemm): 50.408
TFLOPS (nn.Linear): 65.038
TFLOPS (a @ b): 57.238
TFLOPS (bmm): 60.247

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 152.433 μs

======================
Average nn.Linear time: 174.053 μs
Average a @ b time: 111.518 μs
Average bmm time: 47.686 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.142
Speedup (a @ b / grouped_gemm): 0.732
Speedup (bmm / grouped_gemm): 0.313

======================
TFLOPS (grouped_gemm): 13.978
TFLOPS (nn.Linear): 12.242
TFLOPS (a @ b): 19.106
TFLOPS (bmm): 44.682

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 155.077 μs

======================
Average nn.Linear time: 173.647 μs
Average a @ b time: 122.976 μs
Average bmm time: 78.158 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.120
Speedup (a @ b / grouped_gemm): 0.793
Speedup (bmm / grouped_gemm): 0.504

======================
TFLOPS (grouped_gemm): 22.368
TFLOPS (nn.Linear): 19.975
TFLOPS (a @ b): 28.206
TFLOPS (bmm): 44.380

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 153.337 μs

======================
Average nn.Linear time: 168.974 μs
Average a @ b time: 151.813 μs
Average bmm time: 117.545 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.102
Speedup (a @ b / grouped_gemm): 0.990
Speedup (bmm / grouped_gemm): 0.767

======================
TFLOPS (grouped_gemm): 55.582
TFLOPS (nn.Linear): 50.439
TFLOPS (a @ b): 56.140
TFLOPS (bmm): 72.507

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 260.274 μs

======================
Average nn.Linear time: 234.389 μs
Average a @ b time: 235.496 μs
Average bmm time: 192.964 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.901
Speedup (a @ b / grouped_gemm): 0.905
Speedup (bmm / grouped_gemm): 0.741

======================
TFLOPS (grouped_gemm): 89.406
TFLOPS (nn.Linear): 99.279
TFLOPS (a @ b): 98.813
TFLOPS (bmm): 120.592

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 364.923 μs

======================
Average nn.Linear time: 328.982 μs
Average a @ b time: 323.427 μs
Average bmm time: 354.104 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.902
Speedup (a @ b / grouped_gemm): 0.886
Speedup (bmm / grouped_gemm): 0.970

======================
TFLOPS (grouped_gemm): 100.868
TFLOPS (nn.Linear): 111.888
TFLOPS (a @ b): 113.810
TFLOPS (bmm): 103.950

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2037.46 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 593.700 μs

======================
Average nn.Linear time: 636.191 μs
Average a @ b time: 614.159 μs
Average bmm time: 623.741 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.072
Speedup (a @ b / grouped_gemm): 1.034
Speedup (bmm / grouped_gemm): 1.051

======================
TFLOPS (grouped_gemm): 113.939
TFLOPS (nn.Linear): 106.329
TFLOPS (a @ b): 110.144
TFLOPS (bmm): 108.452

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 1062.839 μs

======================
Average nn.Linear time: 1116.457 μs
Average a @ b time: 1093.981 μs
Average bmm time: 1232.622 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.050
Speedup (a @ b / grouped_gemm): 1.029
Speedup (bmm / grouped_gemm): 1.160

======================
TFLOPS (grouped_gemm): 151.933
TFLOPS (nn.Linear): 144.637
TFLOPS (a @ b): 147.608
TFLOPS (bmm): 131.006

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 76.985 μs

======================
Average nn.Linear time: 158.305 μs
Average a @ b time: 91.164 μs
Average bmm time: 33.548 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.056
Speedup (a @ b / grouped_gemm): 1.184
Speedup (bmm / grouped_gemm): 0.436

======================
TFLOPS (grouped_gemm): 12.294
TFLOPS (nn.Linear): 5.979
TFLOPS (a @ b): 10.382
TFLOPS (bmm): 28.213

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 77.174 μs

======================
Average nn.Linear time: 163.374 μs
Average a @ b time: 92.061 μs
Average bmm time: 37.856 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.117
Speedup (a @ b / grouped_gemm): 1.193
Speedup (bmm / grouped_gemm): 0.491

======================
TFLOPS (grouped_gemm): 25.272
TFLOPS (nn.Linear): 11.938
TFLOPS (a @ b): 21.186
TFLOPS (bmm): 51.520

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 98.135 μs

======================
Average nn.Linear time: 150.454 μs
Average a @ b time: 90.046 μs
Average bmm time: 53.332 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.533
Speedup (a @ b / grouped_gemm): 0.918
Speedup (bmm / grouped_gemm): 0.543

======================
TFLOPS (grouped_gemm): 39.187
TFLOPS (nn.Linear): 25.560
TFLOPS (a @ b): 42.708
TFLOPS (bmm): 72.108

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 100.300 μs

======================
Average nn.Linear time: 151.722 μs
Average a @ b time: 104.878 μs
Average bmm time: 84.481 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.513
Speedup (a @ b / grouped_gemm): 1.046
Speedup (bmm / grouped_gemm): 0.842

======================
TFLOPS (grouped_gemm): 57.520
TFLOPS (nn.Linear): 38.025
TFLOPS (a @ b): 55.009
TFLOPS (bmm): 68.290

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 124.722 μs

======================
Average nn.Linear time: 155.616 μs
Average a @ b time: 128.865 μs
Average bmm time: 129.178 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.248
Speedup (a @ b / grouped_gemm): 1.033
Speedup (bmm / grouped_gemm): 1.036

======================
TFLOPS (grouped_gemm): 70.269
TFLOPS (nn.Linear): 56.318
TFLOPS (a @ b): 68.009
TFLOPS (bmm): 67.845

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 220.368 μs

======================
Average nn.Linear time: 285.068 μs
Average a @ b time: 284.410 μs
Average bmm time: 229.475 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.294
Speedup (a @ b / grouped_gemm): 1.291
Speedup (bmm / grouped_gemm): 1.041

======================
TFLOPS (grouped_gemm): 132.699
TFLOPS (nn.Linear): 102.582
TFLOPS (a @ b): 102.819
TFLOPS (bmm): 127.433

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 335.071 μs

======================
Average nn.Linear time: 308.664 μs
Average a @ b time: 316.503 μs
Average bmm time: 304.255 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.921
Speedup (a @ b / grouped_gemm): 0.945
Speedup (bmm / grouped_gemm): 0.908

======================
TFLOPS (grouped_gemm): 108.303
TFLOPS (nn.Linear): 117.568
TFLOPS (a @ b): 114.656
TFLOPS (bmm): 119.272

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 154.817 μs

======================
Average nn.Linear time: 168.521 μs
Average a @ b time: 138.612 μs
Average bmm time: 82.774 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.089
Speedup (a @ b / grouped_gemm): 0.895
Speedup (bmm / grouped_gemm): 0.535

======================
TFLOPS (grouped_gemm): 36.479
TFLOPS (nn.Linear): 33.513
TFLOPS (a @ b): 40.744
TFLOPS (bmm): 68.229

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 153.966 μs

======================
Average nn.Linear time: 168.586 μs
Average a @ b time: 144.804 μs
Average bmm time: 117.531 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.095
Speedup (a @ b / grouped_gemm): 0.940
Speedup (bmm / grouped_gemm): 0.763

======================
TFLOPS (grouped_gemm): 54.211
TFLOPS (nn.Linear): 49.510
TFLOPS (a @ b): 57.641
TFLOPS (bmm): 71.017

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 156.014 μs

======================
Average nn.Linear time: 194.180 μs
Average a @ b time: 185.821 μs
Average bmm time: 179.517 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.245
Speedup (a @ b / grouped_gemm): 1.191
Speedup (bmm / grouped_gemm): 1.151

======================
TFLOPS (grouped_gemm): 92.428
TFLOPS (nn.Linear): 74.261
TFLOPS (a @ b): 77.602
TFLOPS (bmm): 80.327

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 259.101 μs

======================
Average nn.Linear time: 250.041 μs
Average a @ b time: 249.734 μs
Average bmm time: 319.459 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.965
Speedup (a @ b / grouped_gemm): 0.964
Speedup (bmm / grouped_gemm): 1.233

======================
TFLOPS (grouped_gemm): 101.271
TFLOPS (nn.Linear): 104.941
TFLOPS (a @ b): 105.070
TFLOPS (bmm): 82.137

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 587.089 μs

======================
Average nn.Linear time: 549.850 μs
Average a @ b time: 544.012 μs
Average bmm time: 708.220 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.937
Speedup (a @ b / grouped_gemm): 0.927
Speedup (bmm / grouped_gemm): 1.206

======================
TFLOPS (grouped_gemm): 152.372
TFLOPS (nn.Linear): 162.692
TFLOPS (a @ b): 164.438
TFLOPS (bmm): 126.311

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2169.48 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 1087.604 μs

======================
Average nn.Linear time: 1207.123 μs
Average a @ b time: 1164.408 μs
Average bmm time: 1278.186 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.110
Speedup (a @ b / grouped_gemm): 1.071
Speedup (bmm / grouped_gemm): 1.175

======================
TFLOPS (grouped_gemm): 180.421
TFLOPS (nn.Linear): 162.557
TFLOPS (a @ b): 168.520
TFLOPS (bmm): 153.519

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 1705.334 μs

======================
Average nn.Linear time: 1814.816 μs
Average a @ b time: 1780.195 μs
Average bmm time: 2487.228 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.064
Speedup (a @ b / grouped_gemm): 1.044
Speedup (bmm / grouped_gemm): 1.458

======================
TFLOPS (grouped_gemm): 186.009
TFLOPS (nn.Linear): 174.787
TFLOPS (a @ b): 178.187
TFLOPS (bmm): 127.534

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 2996.00 MB
Average grouped_gemm time: 78.244 μs

======================
Average nn.Linear time: 168.383 μs
Average a @ b time: 95.301 μs
Average bmm time: 39.082 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.152
Speedup (a @ b / grouped_gemm): 1.218
Speedup (bmm / grouped_gemm): 0.499

======================
TFLOPS (grouped_gemm): 16.318
TFLOPS (nn.Linear): 7.583
TFLOPS (a @ b): 13.397
TFLOPS (bmm): 32.669

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 77.162 μs

======================
Average nn.Linear time: 150.151 μs
Average a @ b time: 88.890 μs
Average bmm time: 54.824 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.946
Speedup (a @ b / grouped_gemm): 1.152
Speedup (bmm / grouped_gemm): 0.711

======================
TFLOPS (grouped_gemm): 48.076
TFLOPS (nn.Linear): 24.706
TFLOPS (a @ b): 41.733
TFLOPS (bmm): 67.663

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 104.816 μs

======================
Average nn.Linear time: 168.333 μs
Average a @ b time: 100.565 μs
Average bmm time: 81.933 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.606
Speedup (a @ b / grouped_gemm): 0.959
Speedup (bmm / grouped_gemm): 0.782

======================
TFLOPS (grouped_gemm): 52.191
TFLOPS (nn.Linear): 32.498
TFLOPS (a @ b): 54.397
TFLOPS (bmm): 66.767

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 125.473 μs

======================
Average nn.Linear time: 172.260 μs
Average a @ b time: 141.759 μs
Average bmm time: 137.911 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.373
Speedup (a @ b / grouped_gemm): 1.130
Speedup (bmm / grouped_gemm): 1.099

======================
TFLOPS (grouped_gemm): 97.200
TFLOPS (nn.Linear): 70.800
TFLOPS (a @ b): 86.033
TFLOPS (bmm): 88.434

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 216.622 μs

======================
Average nn.Linear time: 221.758 μs
Average a @ b time: 216.899 μs
Average bmm time: 252.731 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.024
Speedup (a @ b / grouped_gemm): 1.001
Speedup (bmm / grouped_gemm): 1.167

======================
TFLOPS (grouped_gemm): 125.468
TFLOPS (nn.Linear): 122.562
TFLOPS (a @ b): 125.308
TFLOPS (bmm): 107.542

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 367.498 μs

======================
Average nn.Linear time: 374.362 μs
Average a @ b time: 371.549 μs
Average bmm time: 437.675 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.019
Speedup (a @ b / grouped_gemm): 1.011
Speedup (bmm / grouped_gemm): 1.191

======================
TFLOPS (grouped_gemm): 158.871
TFLOPS (nn.Linear): 155.958
TFLOPS (a @ b): 157.139
TFLOPS (bmm): 133.398

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 684.624 μs

======================
Average nn.Linear time: 662.842 μs
Average a @ b time: 655.911 μs
Average bmm time: 786.092 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.968
Speedup (a @ b / grouped_gemm): 0.958
Speedup (bmm / grouped_gemm): 1.148

======================
TFLOPS (grouped_gemm): 167.477
TFLOPS (nn.Linear): 172.980
TFLOPS (a @ b): 174.808
TFLOPS (bmm): 145.859

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 159.543 μs

======================
Average nn.Linear time: 168.226 μs
Average a @ b time: 148.365 μs
Average bmm time: 93.696 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.054
Speedup (a @ b / grouped_gemm): 0.930
Speedup (bmm / grouped_gemm): 0.587

======================
TFLOPS (grouped_gemm): 46.848
TFLOPS (nn.Linear): 44.430
TFLOPS (a @ b): 50.377
TFLOPS (bmm): 79.771

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 156.038 μs

======================
Average nn.Linear time: 202.632 μs
Average a @ b time: 183.876 μs
Average bmm time: 190.074 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.299
Speedup (a @ b / grouped_gemm): 1.178
Speedup (bmm / grouped_gemm): 1.218

======================
TFLOPS (grouped_gemm): 104.967
TFLOPS (nn.Linear): 80.830
TFLOPS (a @ b): 89.075
TFLOPS (bmm): 86.170

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 262.675 μs

======================
Average nn.Linear time: 260.170 μs
Average a @ b time: 249.255 μs
Average bmm time: 326.915 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.990
Speedup (a @ b / grouped_gemm): 0.949
Speedup (bmm / grouped_gemm): 1.245

======================
TFLOPS (grouped_gemm): 112.221
TFLOPS (nn.Linear): 113.301
TFLOPS (a @ b): 118.263
TFLOPS (bmm): 90.169

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 483.305 μs

======================
Average nn.Linear time: 548.453 μs
Average a @ b time: 534.930 μs
Average bmm time: 685.430 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.135
Speedup (a @ b / grouped_gemm): 1.107
Speedup (bmm / grouped_gemm): 1.418

======================
TFLOPS (grouped_gemm): 183.183
TFLOPS (nn.Linear): 161.424
TFLOPS (a @ b): 165.505
TFLOPS (bmm): 129.165

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 848.980 μs

======================
Average nn.Linear time: 878.646 μs
Average a @ b time: 854.366 μs
Average bmm time: 1353.216 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.035
Speedup (a @ b / grouped_gemm): 1.006
Speedup (bmm / grouped_gemm): 1.594

======================
TFLOPS (grouped_gemm): 183.111
TFLOPS (nn.Linear): 176.929
TFLOPS (a @ b): 181.957
TFLOPS (bmm): 114.880

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2401.15 MB
Max memory reserved: 3002.00 MB
Average grouped_gemm time: 1062.291 μs

======================
Average nn.Linear time: 1176.136 μs
Average a @ b time: 1141.284 μs
Average bmm time: 1266.932 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.107
Speedup (a @ b / grouped_gemm): 1.074
Speedup (bmm / grouped_gemm): 1.193

======================
TFLOPS (grouped_gemm): 168.927
TFLOPS (nn.Linear): 152.575
TFLOPS (a @ b): 157.234
TFLOPS (bmm): 141.641

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 2713.027 μs

======================
Average nn.Linear time: 2700.701 μs
Average a @ b time: 2688.904 μs
Average bmm time: 4938.157 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.995
Speedup (a @ b / grouped_gemm): 0.991
Speedup (bmm / grouped_gemm): 1.820

======================
TFLOPS (grouped_gemm): 196.006
TFLOPS (nn.Linear): 196.901
TFLOPS (a @ b): 197.765
TFLOPS (bmm): 107.686

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 78.409 μs

======================
Average nn.Linear time: 152.147 μs
Average a @ b time: 99.137 μs
Average bmm time: 55.101 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.940
Speedup (a @ b / grouped_gemm): 1.264
Speedup (bmm / grouped_gemm): 0.703

======================
TFLOPS (grouped_gemm): 43.013
TFLOPS (nn.Linear): 22.167
TFLOPS (a @ b): 34.020
TFLOPS (bmm): 61.208

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 75.791 μs

======================
Average nn.Linear time: 170.453 μs
Average a @ b time: 110.824 μs
Average bmm time: 74.167 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.249
Speedup (a @ b / grouped_gemm): 1.462
Speedup (bmm / grouped_gemm): 0.979

======================
TFLOPS (grouped_gemm): 52.629
TFLOPS (nn.Linear): 23.401
TFLOPS (a @ b): 35.992
TFLOPS (bmm): 53.781

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 125.024 μs

======================
Average nn.Linear time: 155.282 μs
Average a @ b time: 139.301 μs
Average bmm time: 107.105 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.242
Speedup (a @ b / grouped_gemm): 1.114
Speedup (bmm / grouped_gemm): 0.857

======================
TFLOPS (grouped_gemm): 106.519
TFLOPS (nn.Linear): 85.763
TFLOPS (a @ b): 95.602
TFLOPS (bmm): 124.340

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 170.786 μs

======================
Average nn.Linear time: 191.569 μs
Average a @ b time: 183.687 μs
Average bmm time: 166.032 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.122
Speedup (a @ b / grouped_gemm): 1.076
Speedup (bmm / grouped_gemm): 0.972

======================
TFLOPS (grouped_gemm): 128.178
TFLOPS (nn.Linear): 114.273
TFLOPS (a @ b): 119.176
TFLOPS (bmm): 131.849

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 365.384 μs

======================
Average nn.Linear time: 386.727 μs
Average a @ b time: 381.665 μs
Average bmm time: 443.132 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.058
Speedup (a @ b / grouped_gemm): 1.045
Speedup (bmm / grouped_gemm): 1.213

======================
TFLOPS (grouped_gemm): 170.397
TFLOPS (nn.Linear): 160.993
TFLOPS (a @ b): 163.128
TFLOPS (bmm): 140.500

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 541.019 μs

======================
Average nn.Linear time: 528.629 μs
Average a @ b time: 527.496 μs
Average bmm time: 806.499 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.977
Speedup (a @ b / grouped_gemm): 0.975
Speedup (bmm / grouped_gemm): 1.491

======================
TFLOPS (grouped_gemm): 168.572
TFLOPS (nn.Linear): 172.524
TFLOPS (a @ b): 172.894
TFLOPS (bmm): 113.083

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 860.219 μs

======================
Average nn.Linear time: 796.332 μs
Average a @ b time: 794.342 μs
Average bmm time: 1811.378 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.926
Speedup (a @ b / grouped_gemm): 0.923
Speedup (bmm / grouped_gemm): 2.106

======================
TFLOPS (grouped_gemm): 165.800
TFLOPS (nn.Linear): 179.101
TFLOPS (a @ b): 179.550
TFLOPS (bmm): 78.738

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 154.438 μs

======================
Average nn.Linear time: 162.971 μs
Average a @ b time: 150.692 μs
Average bmm time: 126.245 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.055
Speedup (a @ b / grouped_gemm): 0.976
Speedup (bmm / grouped_gemm): 0.817

======================
TFLOPS (grouped_gemm): 59.015
TFLOPS (nn.Linear): 55.925
TFLOPS (a @ b): 60.482
TFLOPS (bmm): 72.195

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 157.971 μs

======================
Average nn.Linear time: 219.264 μs
Average a @ b time: 205.379 μs
Average bmm time: 272.188 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.388
Speedup (a @ b / grouped_gemm): 1.300
Speedup (bmm / grouped_gemm): 1.723

======================
TFLOPS (grouped_gemm): 113.638
TFLOPS (nn.Linear): 81.872
TFLOPS (a @ b): 87.407
TFLOPS (bmm): 65.953

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 366.902 μs

======================
Average nn.Linear time: 374.739 μs
Average a @ b time: 367.997 μs
Average bmm time: 428.474 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.021
Speedup (a @ b / grouped_gemm): 1.003
Speedup (bmm / grouped_gemm): 1.168

======================
TFLOPS (grouped_gemm): 157.345
TFLOPS (nn.Linear): 154.055
TFLOPS (a @ b): 156.877
TFLOPS (bmm): 134.735

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 830.612 μs

======================
Average nn.Linear time: 837.913 μs
Average a @ b time: 838.706 μs
Average bmm time: 1070.971 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.009
Speedup (a @ b / grouped_gemm): 1.010
Speedup (bmm / grouped_gemm): 1.289

======================
TFLOPS (grouped_gemm): 198.270
TFLOPS (nn.Linear): 196.542
TFLOPS (a @ b): 196.356
TFLOPS (bmm): 153.772

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 1209.605 μs

======================
Average nn.Linear time: 1264.653 μs
Average a @ b time: 1249.070 μs
Average bmm time: 2068.677 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.046
Speedup (a @ b / grouped_gemm): 1.033
Speedup (bmm / grouped_gemm): 1.710

======================
TFLOPS (grouped_gemm): 212.766
TFLOPS (nn.Linear): 203.504
TFLOPS (a @ b): 206.043
TFLOPS (bmm): 124.409

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2833.30 MB
Max memory reserved: 3226.00 MB
Average grouped_gemm time: 1932.397 μs

======================
Average nn.Linear time: 2028.220 μs
Average a @ b time: 2002.931 μs
Average bmm time: 4075.723 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.050
Speedup (a @ b / grouped_gemm): 1.037
Speedup (bmm / grouped_gemm): 2.109

======================
TFLOPS (grouped_gemm): 203.022
TFLOPS (nn.Linear): 193.430
TFLOPS (a @ b): 195.872
TFLOPS (bmm): 96.257

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4054.00 MB
Average grouped_gemm time: 3336.198 μs

======================
Average nn.Linear time: 2981.515 μs
Average a @ b time: 2922.199 μs
Average bmm time: 9303.999 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.894
Speedup (a @ b / grouped_gemm): 0.876
Speedup (bmm / grouped_gemm): 2.789

======================
TFLOPS (grouped_gemm): 184.000
TFLOPS (nn.Linear): 205.889
TFLOPS (a @ b): 210.068
TFLOPS (bmm): 65.978

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4054.00 MB
Average grouped_gemm time: 120.242 μs

======================
Average nn.Linear time: 164.599 μs
Average a @ b time: 125.334 μs
Average bmm time: 79.875 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.369
Speedup (a @ b / grouped_gemm): 1.042
Speedup (bmm / grouped_gemm): 0.664

======================
TFLOPS (grouped_gemm): 48.546
TFLOPS (nn.Linear): 35.464
TFLOPS (a @ b): 46.574
TFLOPS (bmm): 73.080

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4054.00 MB
Average grouped_gemm time: 102.239 μs

======================
Average nn.Linear time: 176.241 μs
Average a @ b time: 141.180 μs
Average bmm time: 98.016 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.724
Speedup (a @ b / grouped_gemm): 1.381
Speedup (bmm / grouped_gemm): 0.959

======================
TFLOPS (grouped_gemm): 89.498
TFLOPS (nn.Linear): 51.918
TFLOPS (a @ b): 64.812
TFLOPS (bmm): 93.353

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4054.00 MB
Average grouped_gemm time: 220.392 μs

======================
Average nn.Linear time: 251.465 μs
Average a @ b time: 244.033 μs
Average bmm time: 228.815 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.141
Speedup (a @ b / grouped_gemm): 1.107
Speedup (bmm / grouped_gemm): 1.038

======================
TFLOPS (grouped_gemm): 146.159
TFLOPS (nn.Linear): 128.098
TFLOPS (a @ b): 131.999
TFLOPS (bmm): 140.779

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4054.00 MB
Average grouped_gemm time: 294.061 μs

======================
Average nn.Linear time: 303.741 μs
Average a @ b time: 294.642 μs
Average bmm time: 351.322 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.033
Speedup (a @ b / grouped_gemm): 1.002
Speedup (bmm / grouped_gemm): 1.195

======================
TFLOPS (grouped_gemm): 166.657
TFLOPS (nn.Linear): 161.346
TFLOPS (a @ b): 166.328
TFLOPS (bmm): 139.494

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4054.00 MB
Average grouped_gemm time: 551.314 μs

======================
Average nn.Linear time: 539.658 μs
Average a @ b time: 540.893 μs
Average bmm time: 788.929 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.979
Speedup (a @ b / grouped_gemm): 0.981
Speedup (bmm / grouped_gemm): 1.431

======================
TFLOPS (grouped_gemm): 180.374
TFLOPS (nn.Linear): 184.270
TFLOPS (a @ b): 183.849
TFLOPS (bmm): 126.048

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4054.00 MB
Average grouped_gemm time: 810.914 μs

======================
Average nn.Linear time: 764.210 μs
Average a @ b time: 764.294 μs
Average bmm time: 1528.356 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.942
Speedup (a @ b / grouped_gemm): 0.943
Speedup (bmm / grouped_gemm): 1.885

======================
TFLOPS (grouped_gemm): 178.833
TFLOPS (nn.Linear): 189.762
TFLOPS (a @ b): 189.741
TFLOPS (bmm): 94.885

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4940.00 MB
Average grouped_gemm time: 1461.322 μs

======================
Average nn.Linear time: 1395.464 μs
Average a @ b time: 1399.014 μs
Average bmm time: 3014.846 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.955
Speedup (a @ b / grouped_gemm): 0.957
Speedup (bmm / grouped_gemm): 2.063

======================
TFLOPS (grouped_gemm): 188.056
TFLOPS (nn.Linear): 196.931
TFLOPS (a @ b): 196.432
TFLOPS (bmm): 91.153

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4940.00 MB
Average grouped_gemm time: 161.731 μs

======================
Average nn.Linear time: 224.731 μs
Average a @ b time: 208.094 μs
Average bmm time: 247.879 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.390
Speedup (a @ b / grouped_gemm): 1.287
Speedup (bmm / grouped_gemm): 1.533

======================
TFLOPS (grouped_gemm): 127.244
TFLOPS (nn.Linear): 91.573
TFLOPS (a @ b): 98.894
TFLOPS (bmm): 83.022

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4940.00 MB
Average grouped_gemm time: 384.381 μs

======================
Average nn.Linear time: 510.523 μs
Average a @ b time: 490.210 μs
Average bmm time: 554.667 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.328
Speedup (a @ b / grouped_gemm): 1.275
Speedup (bmm / grouped_gemm): 1.443

======================
TFLOPS (grouped_gemm): 205.830
TFLOPS (nn.Linear): 154.973
TFLOPS (a @ b): 161.394
TFLOPS (bmm): 142.639

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4940.00 MB
Average grouped_gemm time: 624.483 μs

======================
Average nn.Linear time: 727.696 μs
Average a @ b time: 712.380 μs
Average bmm time: 1052.797 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.165
Speedup (a @ b / grouped_gemm): 1.141
Speedup (bmm / grouped_gemm): 1.686

======================
TFLOPS (grouped_gemm): 221.844
TFLOPS (nn.Linear): 190.379
TFLOPS (a @ b): 194.472
TFLOPS (bmm): 131.590

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4940.00 MB
Average grouped_gemm time: 1180.549 μs

======================
Average nn.Linear time: 1239.402 μs
Average a @ b time: 1239.331 μs
Average bmm time: 1568.213 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.050
Speedup (a @ b / grouped_gemm): 1.050
Speedup (bmm / grouped_gemm): 1.328

======================
TFLOPS (grouped_gemm): 216.937
TFLOPS (nn.Linear): 206.635
TFLOPS (a @ b): 206.647
TFLOPS (bmm): 163.310

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4940.00 MB
Average grouped_gemm time: 2236.328 μs

======================
Average nn.Linear time: 2238.576 μs
Average a @ b time: 2232.211 μs
Average bmm time: 3442.345 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.001
Speedup (a @ b / grouped_gemm): 0.998
Speedup (bmm / grouped_gemm): 1.539

======================
TFLOPS (grouped_gemm): 217.307
TFLOPS (nn.Linear): 217.088
TFLOPS (a @ b): 217.707
TFLOPS (bmm): 141.174

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 3327.34 MB
Max memory reserved: 4940.00 MB
Average grouped_gemm time: 3137.107 μs

======================
Average nn.Linear time: 3199.480 μs
Average a @ b time: 3143.058 μs
Average bmm time: 7551.382 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.020
Speedup (a @ b / grouped_gemm): 1.002
Speedup (bmm / grouped_gemm): 2.407

======================
TFLOPS (grouped_gemm): 214.476
TFLOPS (nn.Linear): 210.295
TFLOPS (a @ b): 214.070
TFLOPS (bmm): 89.101

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 5091.80 MB
Max memory reserved: 6540.00 MB
Average grouped_gemm time: 8254.769 μs

======================
Average nn.Linear time: 7782.204 μs
Average a @ b time: 7772.043 μs
Average bmm time: 18032.033 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.943
Speedup (a @ b / grouped_gemm): 0.942
Speedup (bmm / grouped_gemm): 2.184

======================
TFLOPS (grouped_gemm): 213.860
TFLOPS (nn.Linear): 226.847
TFLOPS (a @ b): 227.143
TFLOPS (bmm): 97.902

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 5091.80 MB
Max memory reserved: 6540.00 MB
Average grouped_gemm time: 107.825 μs

======================
Average nn.Linear time: 169.411 μs
Average a @ b time: 138.354 μs
Average bmm time: 114.875 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.571
Speedup (a @ b / grouped_gemm): 1.283
Speedup (bmm / grouped_gemm): 1.065

======================
TFLOPS (grouped_gemm): 94.222
TFLOPS (nn.Linear): 59.970
TFLOPS (a @ b): 73.431
TFLOPS (bmm): 88.440

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 5091.80 MB
Max memory reserved: 6540.00 MB
Average grouped_gemm time: 175.266 μs

======================
Average nn.Linear time: 200.622 μs
Average a @ b time: 194.254 μs
Average bmm time: 195.549 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.145
Speedup (a @ b / grouped_gemm): 1.108
Speedup (bmm / grouped_gemm): 1.116

======================
TFLOPS (grouped_gemm): 137.901
TFLOPS (nn.Linear): 120.472
TFLOPS (a @ b): 124.422
TFLOPS (bmm): 123.598

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 5091.80 MB
Max memory reserved: 6540.00 MB
Average grouped_gemm time: 341.766 μs

======================
Average nn.Linear time: 351.489 μs
Average a @ b time: 349.181 μs
Average bmm time: 396.006 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.028
Speedup (a @ b / grouped_gemm): 1.022
Speedup (bmm / grouped_gemm): 1.159

======================
TFLOPS (grouped_gemm): 172.844
TFLOPS (nn.Linear): 168.063
TFLOPS (a @ b): 169.173
TFLOPS (bmm): 149.170

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 5091.80 MB
Max memory reserved: 6540.00 MB
Average grouped_gemm time: 549.865 μs

======================
Average nn.Linear time: 548.413 μs
Average a @ b time: 550.215 μs
Average bmm time: 880.115 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.997
Speedup (a @ b / grouped_gemm): 1.001
Speedup (bmm / grouped_gemm): 1.601

======================
TFLOPS (grouped_gemm): 190.003
TFLOPS (nn.Linear): 190.506
TFLOPS (a @ b): 189.882
TFLOPS (bmm): 118.707

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 5091.80 MB
Max memory reserved: 6540.00 MB
Average grouped_gemm time: 1274.214 μs

======================
Average nn.Linear time: 1220.717 μs
Average a @ b time: 1233.270 μs
Average bmm time: 1734.807 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.958
Speedup (a @ b / grouped_gemm): 0.968
Speedup (bmm / grouped_gemm): 1.361

======================
TFLOPS (grouped_gemm): 200.152
TFLOPS (nn.Linear): 208.924
TFLOPS (a @ b): 206.797
TFLOPS (bmm): 147.012

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 5091.80 MB
Max memory reserved: 6540.00 MB
Average grouped_gemm time: 1294.878 μs

======================
Average nn.Linear time: 1264.863 μs
Average a @ b time: 1272.380 μs
Average bmm time: 2696.261 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.977
Speedup (a @ b / grouped_gemm): 0.983
Speedup (bmm / grouped_gemm): 2.082

======================
TFLOPS (grouped_gemm): 197.459
TFLOPS (nn.Linear): 202.144
TFLOPS (a @ b): 200.950
TFLOPS (bmm): 94.829

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 6271.98 MB
Max memory reserved: 9972.00 MB
Average grouped_gemm time: 3215.444 μs

======================
Average nn.Linear time: 3018.777 μs
Average a @ b time: 2991.734 μs
Average bmm time: 8750.358 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.939
Speedup (a @ b / grouped_gemm): 0.930
Speedup (bmm / grouped_gemm): 2.721

======================
TFLOPS (grouped_gemm): 195.476
TFLOPS (nn.Linear): 208.211
TFLOPS (a @ b): 210.093
TFLOPS (bmm): 71.830

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 6271.98 MB
Max memory reserved: 9972.00 MB
Average grouped_gemm time: 502.117 μs

======================
Average nn.Linear time: 572.062 μs
Average a @ b time: 558.264 μs
Average bmm time: 546.241 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.139
Speedup (a @ b / grouped_gemm): 1.112
Speedup (bmm / grouped_gemm): 1.088

======================
TFLOPS (grouped_gemm): 189.092
TFLOPS (nn.Linear): 165.972
TFLOPS (a @ b): 170.074
TFLOPS (bmm): 173.818

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 6271.98 MB
Max memory reserved: 9972.00 MB
Average grouped_gemm time: 614.624 μs

======================
Average nn.Linear time: 715.325 μs
Average a @ b time: 698.242 μs
Average bmm time: 1040.494 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.164
Speedup (a @ b / grouped_gemm): 1.136
Speedup (bmm / grouped_gemm): 1.693

======================
TFLOPS (grouped_gemm): 205.694
TFLOPS (nn.Linear): 176.737
TFLOPS (a @ b): 181.061
TFLOPS (bmm): 121.504

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 6271.98 MB
Max memory reserved: 9972.00 MB
Average grouped_gemm time: 1675.825 μs

======================
Average nn.Linear time: 1737.838 μs
Average a @ b time: 1719.575 μs
Average bmm time: 2141.743 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.037
Speedup (a @ b / grouped_gemm): 1.026
Speedup (bmm / grouped_gemm): 1.278

======================
TFLOPS (grouped_gemm): 220.419
TFLOPS (nn.Linear): 212.554
TFLOPS (a @ b): 214.811
TFLOPS (bmm): 172.469

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 6271.98 MB
Max memory reserved: 9972.00 MB
Average grouped_gemm time: 2158.196 μs

======================
Average nn.Linear time: 2211.511 μs
Average a @ b time: 2216.303 μs
Average bmm time: 3849.962 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.025
Speedup (a @ b / grouped_gemm): 1.027
Speedup (bmm / grouped_gemm): 1.784

======================
TFLOPS (grouped_gemm): 228.820
TFLOPS (nn.Linear): 223.303
TFLOPS (a @ b): 222.820
TFLOPS (bmm): 128.271

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 6271.98 MB
Max memory reserved: 9972.00 MB
Average grouped_gemm time: 4505.644 μs

======================
Average nn.Linear time: 4519.789 μs
Average a @ b time: 4475.145 μs
Average bmm time: 7663.600 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.003
Speedup (a @ b / grouped_gemm): 0.993
Speedup (bmm / grouped_gemm): 1.701

======================
TFLOPS (grouped_gemm): 230.908
TFLOPS (nn.Linear): 230.185
TFLOPS (a @ b): 232.482
TFLOPS (bmm): 135.757

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 6271.98 MB
Max memory reserved: 9972.00 MB
Average grouped_gemm time: 10389.886 μs

======================
Average nn.Linear time: 9935.915 μs
Average a @ b time: 9920.652 μs
Average bmm time: 20022.388 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.956
Speedup (a @ b / grouped_gemm): 0.955
Speedup (bmm / grouped_gemm): 1.927

======================
TFLOPS (grouped_gemm): 227.998
TFLOPS (nn.Linear): 238.415
TFLOPS (a @ b): 238.782
TFLOPS (bmm): 118.311

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 9579.76 MB
Max memory reserved: 13436.00 MB
Average grouped_gemm time: 21605.711 μs

======================
Average nn.Linear time: 20994.725 μs
Average a @ b time: 21002.033 μs
Average bmm time: 38614.290 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.972
Speedup (a @ b / grouped_gemm): 0.972
Speedup (bmm / grouped_gemm): 1.787

======================
TFLOPS (grouped_gemm): 224.464
TFLOPS (nn.Linear): 230.996
TFLOPS (a @ b): 230.916
TFLOPS (bmm): 125.594

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 9579.76 MB
Max memory reserved: 13436.00 MB
Average grouped_gemm time: 237.122 μs

======================
Average nn.Linear time: 246.298 μs
Average a @ b time: 235.288 μs
Average bmm time: 242.248 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.039
Speedup (a @ b / grouped_gemm): 0.992
Speedup (bmm / grouped_gemm): 1.022

======================
TFLOPS (grouped_gemm): 135.782
TFLOPS (nn.Linear): 130.723
TFLOPS (a @ b): 136.840
TFLOPS (bmm): 132.909

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 9579.76 MB
Max memory reserved: 13436.00 MB
Average grouped_gemm time: 257.595 μs

======================
Average nn.Linear time: 304.043 μs
Average a @ b time: 275.824 μs
Average bmm time: 376.575 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.180
Speedup (a @ b / grouped_gemm): 1.071
Speedup (bmm / grouped_gemm): 1.462

======================
TFLOPS (grouped_gemm): 158.215
TFLOPS (nn.Linear): 134.044
TFLOPS (a @ b): 147.758
TFLOPS (bmm): 108.226

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 9579.76 MB
Max memory reserved: 13436.00 MB
Average grouped_gemm time: 508.847 μs

======================
Average nn.Linear time: 573.492 μs
Average a @ b time: 561.488 μs
Average bmm time: 826.156 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.127
Speedup (a @ b / grouped_gemm): 1.103
Speedup (bmm / grouped_gemm): 1.624

======================
TFLOPS (grouped_gemm): 188.538
TFLOPS (nn.Linear): 167.285
TFLOPS (a @ b): 170.862
TFLOPS (bmm): 116.124

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 9579.76 MB
Max memory reserved: 13436.00 MB
Average grouped_gemm time: 1252.816 μs

======================
Average nn.Linear time: 1200.848 μs
Average a @ b time: 1211.364 μs
Average bmm time: 1662.405 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.959
Speedup (a @ b / grouped_gemm): 0.967
Speedup (bmm / grouped_gemm): 1.327

======================
TFLOPS (grouped_gemm): 198.853
TFLOPS (nn.Linear): 207.458
TFLOPS (a @ b): 205.657
TFLOPS (bmm): 149.859

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 9579.76 MB
Max memory reserved: 13436.00 MB
Average grouped_gemm time: 2774.770 μs

======================
Average nn.Linear time: 2632.873 μs
Average a @ b time: 2652.569 μs
Average bmm time: 3355.713 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.949
Speedup (a @ b / grouped_gemm): 0.956
Speedup (bmm / grouped_gemm): 1.209

======================
TFLOPS (grouped_gemm): 205.604
TFLOPS (nn.Linear): 216.685
TFLOPS (a @ b): 215.076
TFLOPS (bmm): 170.009

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 9579.76 MB
Max memory reserved: 17308.00 MB
Average grouped_gemm time: 4613.338 μs

======================
Average nn.Linear time: 4361.961 μs
Average a @ b time: 4356.012 μs
Average bmm time: 6516.178 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.946
Speedup (a @ b / grouped_gemm): 0.944
Speedup (bmm / grouped_gemm): 1.412

======================
TFLOPS (grouped_gemm): 205.575
TFLOPS (nn.Linear): 217.422
TFLOPS (a @ b): 217.719
TFLOPS (bmm): 145.543

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 13927.27 MB
Max memory reserved: 23992.00 MB
Average grouped_gemm time: 8777.332 μs

======================
Average nn.Linear time: 8190.305 μs
Average a @ b time: 8194.890 μs
Average bmm time: 17318.678 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.933
Speedup (a @ b / grouped_gemm): 0.934
Speedup (bmm / grouped_gemm): 1.973

======================
TFLOPS (grouped_gemm): 201.239
TFLOPS (nn.Linear): 215.663
TFLOPS (a @ b): 215.542
TFLOPS (bmm): 101.991

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 13927.27 MB
Max memory reserved: 23992.00 MB
Average grouped_gemm time: 616.121 μs

======================
Average nn.Linear time: 669.739 μs
Average a @ b time: 662.291 μs
Average bmm time: 842.986 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.087
Speedup (a @ b / grouped_gemm): 1.075
Speedup (bmm / grouped_gemm): 1.368

======================
TFLOPS (grouped_gemm): 185.732
TFLOPS (nn.Linear): 170.862
TFLOPS (a @ b): 172.784
TFLOPS (bmm): 135.747

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 13927.27 MB
Max memory reserved: 23992.00 MB
Average grouped_gemm time: 1460.075 μs

======================
Average nn.Linear time: 1569.333 μs
Average a @ b time: 1565.666 μs
Average bmm time: 1654.294 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.075
Speedup (a @ b / grouped_gemm): 1.072
Speedup (bmm / grouped_gemm): 1.133

======================
TFLOPS (grouped_gemm): 219.535
TFLOPS (nn.Linear): 204.251
TFLOPS (a @ b): 204.729
TFLOPS (bmm): 193.761

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 13927.27 MB
Max memory reserved: 23992.00 MB
Average grouped_gemm time: 2396.536 μs

======================
Average nn.Linear time: 2497.525 μs
Average a @ b time: 2540.345 μs
Average bmm time: 4006.915 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.042
Speedup (a @ b / grouped_gemm): 1.060
Speedup (bmm / grouped_gemm): 1.672

======================
TFLOPS (grouped_gemm): 226.970
TFLOPS (nn.Linear): 217.793
TFLOPS (a @ b): 214.121
TFLOPS (bmm): 135.751

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 13927.27 MB
Max memory reserved: 23992.00 MB
Average grouped_gemm time: 4535.036 μs

======================
Average nn.Linear time: 4563.456 μs
Average a @ b time: 4543.421 μs
Average bmm time: 8178.363 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.006
Speedup (a @ b / grouped_gemm): 1.002
Speedup (bmm / grouped_gemm): 1.803

======================
TFLOPS (grouped_gemm): 233.510
TFLOPS (nn.Linear): 232.056
TFLOPS (a @ b): 233.079
TFLOPS (bmm): 129.485

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 13927.27 MB
Max memory reserved: 23992.00 MB
Average grouped_gemm time: 10433.965 μs

======================
Average nn.Linear time: 10258.708 μs
Average a @ b time: 10255.880 μs
Average bmm time: 15949.192 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.983
Speedup (a @ b / grouped_gemm): 0.983
Speedup (bmm / grouped_gemm): 1.529

======================
TFLOPS (grouped_gemm): 237.770
TFLOPS (nn.Linear): 241.832
TFLOPS (a @ b): 241.898
TFLOPS (bmm): 155.549

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 13927.27 MB
Max memory reserved: 23992.00 MB
Average grouped_gemm time: 19236.650 μs

======================
Average nn.Linear time: 18353.734 μs
Average a @ b time: 18309.584 μs
Average bmm time: 33334.711 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.954
Speedup (a @ b / grouped_gemm): 0.952
Speedup (bmm / grouped_gemm): 1.733

======================
TFLOPS (grouped_gemm): 232.194
TFLOPS (nn.Linear): 243.364
TFLOPS (a @ b): 243.950
TFLOPS (bmm): 133.993

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 17147.55 MB
Max memory reserved: 30816.00 MB
Average grouped_gemm time: 42720.978 μs

======================
Average nn.Linear time: 41723.187 μs
Average a @ b time: 41728.218 μs
Average bmm time: 75884.383 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.977
Speedup (a @ b / grouped_gemm): 0.977
Speedup (bmm / grouped_gemm): 1.776

======================
TFLOPS (grouped_gemm): 227.637
TFLOPS (nn.Linear): 233.081
TFLOPS (a @ b): 233.053
TFLOPS (bmm): 128.154

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 17147.55 MB
Max memory reserved: 30816.00 MB
Average grouped_gemm time: 223.284 μs

======================
Average nn.Linear time: 246.663 μs
Average a @ b time: 236.111 μs
Average bmm time: 320.730 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.105
Speedup (a @ b / grouped_gemm): 1.057
Speedup (bmm / grouped_gemm): 1.436

======================
TFLOPS (grouped_gemm): 140.168
TFLOPS (nn.Linear): 126.883
TFLOPS (a @ b): 132.553
TFLOPS (bmm): 97.581

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 17147.55 MB
Max memory reserved: 30816.00 MB
Average grouped_gemm time: 625.253 μs

======================
Average nn.Linear time: 642.307 μs
Average a @ b time: 639.257 μs
Average bmm time: 798.757 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.027
Speedup (a @ b / grouped_gemm): 1.022
Speedup (bmm / grouped_gemm): 1.277

======================
TFLOPS (grouped_gemm): 187.421
TFLOPS (nn.Linear): 182.445
TFLOPS (a @ b): 183.315
TFLOPS (bmm): 146.710

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 17147.55 MB
Max memory reserved: 30816.00 MB
Average grouped_gemm time: 1324.718 μs

======================
Average nn.Linear time: 1368.787 μs
Average a @ b time: 1367.486 μs
Average bmm time: 1769.896 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.033
Speedup (a @ b / grouped_gemm): 1.032
Speedup (bmm / grouped_gemm): 1.336

======================
TFLOPS (grouped_gemm): 200.158
TFLOPS (nn.Linear): 193.714
TFLOPS (a @ b): 193.899
TFLOPS (bmm): 149.813

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 17147.55 MB
Max memory reserved: 30816.00 MB
Average grouped_gemm time: 2591.248 μs

======================
Average nn.Linear time: 2493.873 μs
Average a @ b time: 2511.842 μs
Average bmm time: 3238.819 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.962
Speedup (a @ b / grouped_gemm): 0.969
Speedup (bmm / grouped_gemm): 1.250

======================
TFLOPS (grouped_gemm): 206.509
TFLOPS (nn.Linear): 214.573
TFLOPS (a @ b): 213.038
TFLOPS (bmm): 165.220

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 17147.55 MB
Max memory reserved: 30816.00 MB
Average grouped_gemm time: 4033.337 μs

======================
Average nn.Linear time: 3864.753 μs
Average a @ b time: 3839.612 μs
Average bmm time: 6339.505 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.958
Speedup (a @ b / grouped_gemm): 0.952
Speedup (bmm / grouped_gemm): 1.572

======================
TFLOPS (grouped_gemm): 207.481
TFLOPS (nn.Linear): 216.531
TFLOPS (a @ b): 217.949
TFLOPS (bmm): 132.004

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 17147.55 MB
Max memory reserved: 38788.00 MB
Average grouped_gemm time: 10442.669 μs

======================
Average nn.Linear time: 9795.330 μs
Average a @ b time: 9810.705 μs
Average bmm time: 13554.068 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.938
Speedup (a @ b / grouped_gemm): 0.939
Speedup (bmm / grouped_gemm): 1.298

======================
TFLOPS (grouped_gemm): 208.272
TFLOPS (nn.Linear): 222.036
TFLOPS (a @ b): 221.688
TFLOPS (bmm): 160.462

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 23936.19 MB
Max memory reserved: 50576.00 MB
Average grouped_gemm time: 14952.128 μs

======================
Average nn.Linear time: 13936.336 μs
Average a @ b time: 13963.413 μs
Average bmm time: 30534.360 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.932
Speedup (a @ b / grouped_gemm): 0.934
Speedup (bmm / grouped_gemm): 2.042

======================
TFLOPS (grouped_gemm): 202.158
TFLOPS (nn.Linear): 216.893
TFLOPS (a @ b): 216.473
TFLOPS (bmm): 98.993

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 23936.19 MB
Max memory reserved: 50576.00 MB
Average grouped_gemm time: 1060.374 μs

======================
Average nn.Linear time: 1213.839 μs
Average a @ b time: 1193.659 μs
Average bmm time: 1967.151 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.145
Speedup (a @ b / grouped_gemm): 1.126
Speedup (bmm / grouped_gemm): 1.855

======================
TFLOPS (grouped_gemm): 208.033
TFLOPS (nn.Linear): 181.732
TFLOPS (a @ b): 184.804
TFLOPS (bmm): 112.138

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 23936.19 MB
Max memory reserved: 50576.00 MB
Average grouped_gemm time: 2019.882 μs

======================
Average nn.Linear time: 2095.981 μs
Average a @ b time: 2107.170 μs
Average bmm time: 3919.289 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.038
Speedup (a @ b / grouped_gemm): 1.043
Speedup (bmm / grouped_gemm): 1.940

======================
TFLOPS (grouped_gemm): 225.492
TFLOPS (nn.Linear): 217.305
TFLOPS (a @ b): 216.151
TFLOPS (bmm): 116.212

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 23936.19 MB
Max memory reserved: 50576.00 MB
Average grouped_gemm time: 4688.983 μs

======================
Average nn.Linear time: 4856.255 μs
Average a @ b time: 4832.206 μs
Average bmm time: 7536.087 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.036
Speedup (a @ b / grouped_gemm): 1.031
Speedup (bmm / grouped_gemm): 1.607

======================
TFLOPS (grouped_gemm): 235.877
TFLOPS (nn.Linear): 227.752
TFLOPS (a @ b): 228.885
TFLOPS (bmm): 146.763

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 23936.19 MB
Max memory reserved: 50576.00 MB
Average grouped_gemm time: 5617.230 μs

======================
Average nn.Linear time: 5565.865 μs
Average a @ b time: 5577.047 μs
Average bmm time: 9664.004 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.991
Speedup (a @ b / grouped_gemm): 0.993
Speedup (bmm / grouped_gemm): 1.720

======================
TFLOPS (grouped_gemm): 235.134
TFLOPS (nn.Linear): 237.304
TFLOPS (a @ b): 236.828
TFLOPS (bmm): 136.672

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 23936.19 MB
Max memory reserved: 50576.00 MB
Average grouped_gemm time: 20292.888 μs

======================
Average nn.Linear time: 19904.037 μs
Average a @ b time: 19914.148 μs
Average bmm time: 32931.421 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.981
Speedup (a @ b / grouped_gemm): 0.981
Speedup (bmm / grouped_gemm): 1.623

======================
TFLOPS (grouped_gemm): 239.046
TFLOPS (nn.Linear): 243.716
TFLOPS (a @ b): 243.592
TFLOPS (bmm): 147.304

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 23936.19 MB
Max memory reserved: 50576.00 MB
Average grouped_gemm time: 62415.953 μs

======================
Average nn.Linear time: 59259.396 μs
Average a @ b time: 59255.981 μs
Average bmm time: 87756.855 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.949
Speedup (a @ b / grouped_gemm): 0.949
Speedup (bmm / grouped_gemm): 1.406

======================
TFLOPS (grouped_gemm): 235.662
TFLOPS (nn.Linear): 248.215
TFLOPS (a @ b): 248.229
TFLOPS (bmm): 167.611

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 30324.16 MB
Max memory reserved: 64732.00 MB
Average grouped_gemm time: 70381.098 μs

======================
Average nn.Linear time: 68160.794 μs
Average a @ b time: 68174.260 μs
Average bmm time: 157473.035 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.968
Speedup (a @ b / grouped_gemm): 0.969
Speedup (bmm / grouped_gemm): 2.237

======================
TFLOPS (grouped_gemm): 227.252
TFLOPS (nn.Linear): 234.654
TFLOPS (a @ b): 234.608
TFLOPS (bmm): 101.568

--------------------------------------------------
