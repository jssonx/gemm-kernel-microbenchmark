Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 11.16 MB
Max memory reserved: 24.00 MB
Average grouped_gemm time: 102.463 μs

======================
Average nn.Linear time: 361.204 μs
Average a @ b time: 187.910 μs
Average bmm time: 22.821 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.525
Speedup (a @ b / grouped_gemm): 1.834
Speedup (bmm / grouped_gemm): 0.223

======================
TFLOPS (grouped_gemm): 0.152
TFLOPS (nn.Linear): 0.043
TFLOPS (a @ b): 0.083
TFLOPS (bmm): 0.683

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 14.27 MB
Max memory reserved: 26.00 MB
Average grouped_gemm time: 88.828 μs

======================
Average nn.Linear time: 365.069 μs
Average a @ b time: 193.324 μs
Average bmm time: 24.602 μs

======================
Speedup (nn.Linear / grouped_gemm): 4.110
Speedup (a @ b / grouped_gemm): 2.176
Speedup (bmm / grouped_gemm): 0.277

======================
TFLOPS (grouped_gemm): 0.418
TFLOPS (nn.Linear): 0.102
TFLOPS (a @ b): 0.192
TFLOPS (bmm): 1.508

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 19.92 MB
Max memory reserved: 30.00 MB
Average grouped_gemm time: 109.651 μs

======================
Average nn.Linear time: 387.757 μs
Average a @ b time: 209.999 μs
Average bmm time: 25.439 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.536
Speedup (a @ b / grouped_gemm): 1.915
Speedup (bmm / grouped_gemm): 0.232

======================
TFLOPS (grouped_gemm): 0.557
TFLOPS (nn.Linear): 0.158
TFLOPS (a @ b): 0.291
TFLOPS (bmm): 2.401

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 31.48 MB
Max memory reserved: 54.00 MB
Average grouped_gemm time: 117.350 μs

======================
Average nn.Linear time: 366.087 μs
Average a @ b time: 194.225 μs
Average bmm time: 30.367 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.120
Speedup (a @ b / grouped_gemm): 1.655
Speedup (bmm / grouped_gemm): 0.259

======================
TFLOPS (grouped_gemm): 1.019
TFLOPS (nn.Linear): 0.327
TFLOPS (a @ b): 0.615
TFLOPS (bmm): 3.936

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 56.62 MB
Max memory reserved: 68.00 MB
Average grouped_gemm time: 134.563 μs

======================
Average nn.Linear time: 358.067 μs
Average a @ b time: 186.331 μs
Average bmm time: 38.602 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.661
Speedup (a @ b / grouped_gemm): 1.385
Speedup (bmm / grouped_gemm): 0.287

======================
TFLOPS (grouped_gemm): 2.423
TFLOPS (nn.Linear): 0.911
TFLOPS (a @ b): 1.750
TFLOPS (bmm): 8.448

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 101.13 MB
Max memory reserved: 120.00 MB
Average grouped_gemm time: 177.636 μs

======================
Average nn.Linear time: 354.209 μs
Average a @ b time: 185.342 μs
Average bmm time: 58.675 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.994
Speedup (a @ b / grouped_gemm): 1.043
Speedup (bmm / grouped_gemm): 0.330

======================
TFLOPS (grouped_gemm): 2.727
TFLOPS (nn.Linear): 1.368
TFLOPS (a @ b): 2.614
TFLOPS (bmm): 8.256

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 176.21 MB
Max memory reserved: 200.00 MB
Average grouped_gemm time: 238.678 μs

======================
Average nn.Linear time: 322.380 μs
Average a @ b time: 184.033 μs
Average bmm time: 77.512 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.351
Speedup (a @ b / grouped_gemm): 0.771
Speedup (bmm / grouped_gemm): 0.325

======================
TFLOPS (grouped_gemm): 4.736
TFLOPS (nn.Linear): 3.506
TFLOPS (a @ b): 6.142
TFLOPS (bmm): 14.583

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 176.21 MB
Max memory reserved: 200.00 MB
Average grouped_gemm time: 103.133 μs

======================
Average nn.Linear time: 354.862 μs
Average a @ b time: 218.778 μs
Average bmm time: 23.644 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.441
Speedup (a @ b / grouped_gemm): 2.121
Speedup (bmm / grouped_gemm): 0.229

======================
TFLOPS (grouped_gemm): 1.228
TFLOPS (nn.Linear): 0.357
TFLOPS (a @ b): 0.579
TFLOPS (bmm): 5.355

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 176.21 MB
Max memory reserved: 200.00 MB
Average grouped_gemm time: 102.911 μs

======================
Average nn.Linear time: 360.353 μs
Average a @ b time: 203.733 μs
Average bmm time: 27.249 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.502
Speedup (a @ b / grouped_gemm): 1.980
Speedup (bmm / grouped_gemm): 0.265

======================
TFLOPS (grouped_gemm): 1.857
TFLOPS (nn.Linear): 0.530
TFLOPS (a @ b): 0.938
TFLOPS (bmm): 7.013

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 176.21 MB
Max memory reserved: 200.00 MB
Average grouped_gemm time: 138.981 μs

======================
Average nn.Linear time: 345.619 μs
Average a @ b time: 159.869 μs
Average bmm time: 35.605 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.487
Speedup (a @ b / grouped_gemm): 1.150
Speedup (bmm / grouped_gemm): 0.256

======================
TFLOPS (grouped_gemm): 3.350
TFLOPS (nn.Linear): 1.347
TFLOPS (a @ b): 2.912
TFLOPS (bmm): 13.076

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 176.21 MB
Max memory reserved: 200.00 MB
Average grouped_gemm time: 163.791 μs

======================
Average nn.Linear time: 342.891 μs
Average a @ b time: 189.238 μs
Average bmm time: 57.571 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.093
Speedup (a @ b / grouped_gemm): 1.155
Speedup (bmm / grouped_gemm): 0.351

======================
TFLOPS (grouped_gemm): 5.224
TFLOPS (nn.Linear): 2.495
TFLOPS (a @ b): 4.522
TFLOPS (bmm): 14.862

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 222.84 MB
Max memory reserved: 296.00 MB
Average grouped_gemm time: 203.967 μs

======================
Average nn.Linear time: 327.313 μs
Average a @ b time: 176.117 μs
Average bmm time: 92.115 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.605
Speedup (a @ b / grouped_gemm): 0.863
Speedup (bmm / grouped_gemm): 0.452

======================
TFLOPS (grouped_gemm): 10.210
TFLOPS (nn.Linear): 6.362
TFLOPS (a @ b): 11.824
TFLOPS (bmm): 22.607

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 431.92 MB
Max memory reserved: 524.00 MB
Average grouped_gemm time: 317.972 μs

======================
Average nn.Linear time: 349.402 μs
Average a @ b time: 286.489 μs
Average bmm time: 160.677 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.099
Speedup (a @ b / grouped_gemm): 0.901
Speedup (bmm / grouped_gemm): 0.505

======================
TFLOPS (grouped_gemm): 9.102
TFLOPS (nn.Linear): 8.283
TFLOPS (a @ b): 10.102
TFLOPS (bmm): 18.012

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 751.58 MB
Max memory reserved: 924.00 MB
Average grouped_gemm time: 477.543 μs

======================
Average nn.Linear time: 323.212 μs
Average a @ b time: 391.111 μs
Average bmm time: 266.833 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.677
Speedup (a @ b / grouped_gemm): 0.819
Speedup (bmm / grouped_gemm): 0.559

======================
TFLOPS (grouped_gemm): 11.989
TFLOPS (nn.Linear): 17.714
TFLOPS (a @ b): 14.638
TFLOPS (bmm): 21.456

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 751.58 MB
Max memory reserved: 924.00 MB
Average grouped_gemm time: 193.467 μs

======================
Average nn.Linear time: 349.410 μs
Average a @ b time: 204.508 μs
Average bmm time: 40.460 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.806
Speedup (a @ b / grouped_gemm): 1.057
Speedup (bmm / grouped_gemm): 0.209

======================
TFLOPS (grouped_gemm): 3.317
TFLOPS (nn.Linear): 1.837
TFLOPS (a @ b): 3.138
TFLOPS (bmm): 15.861

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 751.58 MB
Max memory reserved: 924.00 MB
Average grouped_gemm time: 178.666 μs

======================
Average nn.Linear time: 356.781 μs
Average a @ b time: 207.200 μs
Average bmm time: 70.984 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.997
Speedup (a @ b / grouped_gemm): 1.160
Speedup (bmm / grouped_gemm): 0.397

======================
TFLOPS (grouped_gemm): 7.019
TFLOPS (nn.Linear): 3.515
TFLOPS (a @ b): 6.053
TFLOPS (bmm): 17.667

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 751.58 MB
Max memory reserved: 924.00 MB
Average grouped_gemm time: 280.612 μs

======================
Average nn.Linear time: 339.315 μs
Average a @ b time: 241.015 μs
Average bmm time: 109.992 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.209
Speedup (a @ b / grouped_gemm): 0.859
Speedup (bmm / grouped_gemm): 0.392

======================
TFLOPS (grouped_gemm): 8.340
TFLOPS (nn.Linear): 6.897
TFLOPS (a @ b): 9.711
TFLOPS (bmm): 21.278

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 751.58 MB
Max memory reserved: 924.00 MB
Average grouped_gemm time: 389.867 μs

======================
Average nn.Linear time: 343.409 μs
Average a @ b time: 322.473 μs
Average bmm time: 195.711 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.881
Speedup (a @ b / grouped_gemm): 0.827
Speedup (bmm / grouped_gemm): 0.502

======================
TFLOPS (grouped_gemm): 10.930
TFLOPS (nn.Linear): 12.409
TFLOPS (a @ b): 13.215
TFLOPS (bmm): 21.774

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 1086.88 MB
Max memory reserved: 1436.00 MB
Average grouped_gemm time: 590.708 μs

======================
Average nn.Linear time: 372.071 μs
Average a @ b time: 440.259 μs
Average bmm time: 368.631 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.630
Speedup (a @ b / grouped_gemm): 0.745
Speedup (bmm / grouped_gemm): 0.624

======================
TFLOPS (grouped_gemm): 19.540
TFLOPS (nn.Linear): 31.023
TFLOPS (a @ b): 26.218
TFLOPS (bmm): 31.312

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2160.25 MB
Max memory reserved: 2652.00 MB
Average grouped_gemm time: 1111.236 μs

======================
Average nn.Linear time: 804.949 μs
Average a @ b time: 794.146 μs
Average bmm time: 716.689 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.724
Speedup (a @ b / grouped_gemm): 0.715
Speedup (bmm / grouped_gemm): 0.645

======================
TFLOPS (grouped_gemm): 22.224
TFLOPS (nn.Linear): 30.680
TFLOPS (a @ b): 31.098
TFLOPS (bmm): 34.459

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 1849.251 μs

======================
Average nn.Linear time: 1316.011 μs
Average a @ b time: 1306.105 μs
Average bmm time: 1246.920 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.712
Speedup (a @ b / grouped_gemm): 0.706
Speedup (bmm / grouped_gemm): 0.674

======================
TFLOPS (grouped_gemm): 17.528
TFLOPS (nn.Linear): 24.630
TFLOPS (a @ b): 24.817
TFLOPS (bmm): 25.995

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 85.146 μs

======================
Average nn.Linear time: 297.942 μs
Average a @ b time: 158.477 μs
Average bmm time: 20.299 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.499
Speedup (a @ b / grouped_gemm): 1.861
Speedup (bmm / grouped_gemm): 0.238

======================
TFLOPS (grouped_gemm): 0.357
TFLOPS (nn.Linear): 0.102
TFLOPS (a @ b): 0.192
TFLOPS (bmm): 1.498

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 85.819 μs

======================
Average nn.Linear time: 322.645 μs
Average a @ b time: 171.268 μs
Average bmm time: 21.317 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.760
Speedup (a @ b / grouped_gemm): 1.996
Speedup (bmm / grouped_gemm): 0.248

======================
TFLOPS (grouped_gemm): 0.952
TFLOPS (nn.Linear): 0.253
TFLOPS (a @ b): 0.477
TFLOPS (bmm): 3.831

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 91.169 μs

======================
Average nn.Linear time: 316.601 μs
Average a @ b time: 174.165 μs
Average bmm time: 25.346 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.473
Speedup (a @ b / grouped_gemm): 1.910
Speedup (bmm / grouped_gemm): 0.278

======================
TFLOPS (grouped_gemm): 1.556
TFLOPS (nn.Linear): 0.448
TFLOPS (a @ b): 0.814
TFLOPS (bmm): 5.595

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 97.899 μs

======================
Average nn.Linear time: 308.502 μs
Average a @ b time: 166.149 μs
Average bmm time: 32.508 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.151
Speedup (a @ b / grouped_gemm): 1.697
Speedup (bmm / grouped_gemm): 0.332

======================
TFLOPS (grouped_gemm): 2.951
TFLOPS (nn.Linear): 0.936
TFLOPS (a @ b): 1.739
TFLOPS (bmm): 8.886

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 111.604 μs

======================
Average nn.Linear time: 288.680 μs
Average a @ b time: 152.888 μs
Average bmm time: 47.383 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.587
Speedup (a @ b / grouped_gemm): 1.370
Speedup (bmm / grouped_gemm): 0.425

======================
TFLOPS (grouped_gemm): 5.074
TFLOPS (nn.Linear): 1.961
TFLOPS (a @ b): 3.704
TFLOPS (bmm): 11.950

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 149.753 μs

======================
Average nn.Linear time: 295.961 μs
Average a @ b time: 155.354 μs
Average bmm time: 57.054 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.976
Speedup (a @ b / grouped_gemm): 1.037
Speedup (bmm / grouped_gemm): 0.381

======================
TFLOPS (grouped_gemm): 7.926
TFLOPS (nn.Linear): 4.011
TFLOPS (a @ b): 7.641
TFLOPS (bmm): 20.805

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 200.233 μs

======================
Average nn.Linear time: 294.716 μs
Average a @ b time: 168.321 μs
Average bmm time: 85.218 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.472
Speedup (a @ b / grouped_gemm): 0.841
Speedup (bmm / grouped_gemm): 0.426

======================
TFLOPS (grouped_gemm): 10.741
TFLOPS (nn.Linear): 7.297
TFLOPS (a @ b): 12.777
TFLOPS (bmm): 25.237

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 100.069 μs

======================
Average nn.Linear time: 350.742 μs
Average a @ b time: 197.709 μs
Average bmm time: 22.385 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.505
Speedup (a @ b / grouped_gemm): 1.976
Speedup (bmm / grouped_gemm): 0.224

======================
TFLOPS (grouped_gemm): 2.228
TFLOPS (nn.Linear): 0.636
TFLOPS (a @ b): 1.128
TFLOPS (bmm): 9.960

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 100.265 μs

======================
Average nn.Linear time: 344.439 μs
Average a @ b time: 194.197 μs
Average bmm time: 26.290 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.435
Speedup (a @ b / grouped_gemm): 1.937
Speedup (bmm / grouped_gemm): 0.262

======================
TFLOPS (grouped_gemm): 3.404
TFLOPS (nn.Linear): 0.991
TFLOPS (a @ b): 1.758
TFLOPS (bmm): 12.982

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 121.911 μs

======================
Average nn.Linear time: 294.976 μs
Average a @ b time: 154.102 μs
Average bmm time: 35.923 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.420
Speedup (a @ b / grouped_gemm): 1.264
Speedup (bmm / grouped_gemm): 0.295

======================
TFLOPS (grouped_gemm): 5.870
TFLOPS (nn.Linear): 2.426
TFLOPS (a @ b): 4.644
TFLOPS (bmm): 19.922

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 147.300 μs

======================
Average nn.Linear time: 304.191 μs
Average a @ b time: 159.426 μs
Average bmm time: 59.886 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.065
Speedup (a @ b / grouped_gemm): 1.082
Speedup (bmm / grouped_gemm): 0.407

======================
TFLOPS (grouped_gemm): 10.913
TFLOPS (nn.Linear): 5.284
TFLOPS (a @ b): 10.083
TFLOPS (bmm): 26.842

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4668.00 MB
Average grouped_gemm time: 191.662 μs

======================
Average nn.Linear time: 295.377 μs
Average a @ b time: 165.141 μs
Average bmm time: 94.244 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.541
Speedup (a @ b / grouped_gemm): 0.862
Speedup (bmm / grouped_gemm): 0.492

======================
TFLOPS (grouped_gemm): 15.756
TFLOPS (nn.Linear): 10.224
TFLOPS (a @ b): 18.287
TFLOPS (bmm): 32.043

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 307.362 μs

======================
Average nn.Linear time: 342.121 μs
Average a @ b time: 420.010 μs
Average bmm time: 166.759 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.113
Speedup (a @ b / grouped_gemm): 1.366
Speedup (bmm / grouped_gemm): 0.543

======================
TFLOPS (grouped_gemm): 25.095
TFLOPS (nn.Linear): 22.546
TFLOPS (a @ b): 18.365
TFLOPS (bmm): 46.254

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 466.189 μs

======================
Average nn.Linear time: 329.432 μs
Average a @ b time: 412.805 μs
Average bmm time: 275.176 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.707
Speedup (a @ b / grouped_gemm): 0.885
Speedup (bmm / grouped_gemm): 0.590

======================
TFLOPS (grouped_gemm): 22.058
TFLOPS (nn.Linear): 31.215
TFLOPS (a @ b): 24.911
TFLOPS (bmm): 37.370

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 176.382 μs

======================
Average nn.Linear time: 341.039 μs
Average a @ b time: 202.091 μs
Average bmm time: 44.246 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.934
Speedup (a @ b / grouped_gemm): 1.146
Speedup (bmm / grouped_gemm): 0.251

======================
TFLOPS (grouped_gemm): 7.562
TFLOPS (nn.Linear): 3.911
TFLOPS (a @ b): 6.600
TFLOPS (bmm): 30.145

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 178.487 μs

======================
Average nn.Linear time: 339.670 μs
Average a @ b time: 209.842 μs
Average bmm time: 74.110 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.903
Speedup (a @ b / grouped_gemm): 1.176
Speedup (bmm / grouped_gemm): 0.415

======================
TFLOPS (grouped_gemm): 11.797
TFLOPS (nn.Linear): 6.199
TFLOPS (a @ b): 10.034
TFLOPS (bmm): 28.411

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 279.949 μs

======================
Average nn.Linear time: 338.204 μs
Average a @ b time: 243.237 μs
Average bmm time: 116.444 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.208
Speedup (a @ b / grouped_gemm): 0.869
Speedup (bmm / grouped_gemm): 0.416

======================
TFLOPS (grouped_gemm): 16.780
TFLOPS (nn.Linear): 13.890
TFLOPS (a @ b): 19.313
TFLOPS (bmm): 40.342

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 383.821 μs

======================
Average nn.Linear time: 346.613 μs
Average a @ b time: 339.651 μs
Average bmm time: 199.001 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.903
Speedup (a @ b / grouped_gemm): 0.885
Speedup (bmm / grouped_gemm): 0.518

======================
TFLOPS (grouped_gemm): 19.670
TFLOPS (nn.Linear): 21.781
TFLOPS (a @ b): 22.228
TFLOPS (bmm): 37.938

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 592.959 μs

======================
Average nn.Linear time: 388.551 μs
Average a @ b time: 443.392 μs
Average bmm time: 381.308 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.655
Speedup (a @ b / grouped_gemm): 0.748
Speedup (bmm / grouped_gemm): 0.643

======================
TFLOPS (grouped_gemm): 31.746
TFLOPS (nn.Linear): 48.447
TFLOPS (a @ b): 42.455
TFLOPS (bmm): 49.367

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 3759.80 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 1109.159 μs

======================
Average nn.Linear time: 805.783 μs
Average a @ b time: 796.168 μs
Average bmm time: 726.576 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.726
Speedup (a @ b / grouped_gemm): 0.718
Speedup (bmm / grouped_gemm): 0.655

======================
TFLOPS (grouped_gemm): 29.708
TFLOPS (nn.Linear): 40.892
TFLOPS (a @ b): 41.386
TFLOPS (bmm): 45.350

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 1861.672 μs

======================
Average nn.Linear time: 1336.575 μs
Average a @ b time: 1324.501 μs
Average bmm time: 1269.398 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.718
Speedup (a @ b / grouped_gemm): 0.711
Speedup (bmm / grouped_gemm): 0.682

======================
TFLOPS (grouped_gemm): 34.633
TFLOPS (nn.Linear): 48.239
TFLOPS (a @ b): 48.679
TFLOPS (bmm): 50.792

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 85.025 μs

======================
Average nn.Linear time: 307.469 μs
Average a @ b time: 164.614 μs
Average bmm time: 21.458 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.616
Speedup (a @ b / grouped_gemm): 1.936
Speedup (bmm / grouped_gemm): 0.252

======================
TFLOPS (grouped_gemm): 0.948
TFLOPS (nn.Linear): 0.262
TFLOPS (a @ b): 0.490
TFLOPS (bmm): 3.757

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 84.147 μs

======================
Average nn.Linear time: 309.458 μs
Average a @ b time: 166.628 μs
Average bmm time: 25.201 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.678
Speedup (a @ b / grouped_gemm): 1.980
Speedup (bmm / grouped_gemm): 0.299

======================
TFLOPS (grouped_gemm): 1.176
TFLOPS (nn.Linear): 0.320
TFLOPS (a @ b): 0.594
TFLOPS (bmm): 3.927

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 90.170 μs

======================
Average nn.Linear time: 304.952 μs
Average a @ b time: 160.728 μs
Average bmm time: 32.141 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.382
Speedup (a @ b / grouped_gemm): 1.782
Speedup (bmm / grouped_gemm): 0.356

======================
TFLOPS (grouped_gemm): 3.175
TFLOPS (nn.Linear): 0.939
TFLOPS (a @ b): 1.781
TFLOPS (bmm): 8.906

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4674.00 MB
Average grouped_gemm time: 96.655 μs

======================
Average nn.Linear time: 304.503 μs
Average a @ b time: 160.904 μs
Average bmm time: 45.002 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.150
Speedup (a @ b / grouped_gemm): 1.665
Speedup (bmm / grouped_gemm): 0.466

======================
TFLOPS (grouped_gemm): 5.647
TFLOPS (nn.Linear): 1.792
TFLOPS (a @ b): 3.392
TFLOPS (bmm): 12.128

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 111.892 μs

======================
Average nn.Linear time: 293.593 μs
Average a @ b time: 153.930 μs
Average bmm time: 76.628 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.624
Speedup (a @ b / grouped_gemm): 1.376
Speedup (bmm / grouped_gemm): 0.685

======================
TFLOPS (grouped_gemm): 10.140
TFLOPS (nn.Linear): 3.864
TFLOPS (a @ b): 7.371
TFLOPS (bmm): 14.806

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 151.238 μs

======================
Average nn.Linear time: 297.065 μs
Average a @ b time: 154.972 μs
Average bmm time: 68.035 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.964
Speedup (a @ b / grouped_gemm): 1.025
Speedup (bmm / grouped_gemm): 0.450

======================
TFLOPS (grouped_gemm): 15.461
TFLOPS (nn.Linear): 7.871
TFLOPS (a @ b): 15.089
TFLOPS (bmm): 34.369

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 202.768 μs

======================
Average nn.Linear time: 296.142 μs
Average a @ b time: 184.062 μs
Average bmm time: 100.336 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.460
Speedup (a @ b / grouped_gemm): 0.908
Speedup (bmm / grouped_gemm): 0.495

======================
TFLOPS (grouped_gemm): 17.014
TFLOPS (nn.Linear): 11.649
TFLOPS (a @ b): 18.743
TFLOPS (bmm): 34.383

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 100.904 μs

======================
Average nn.Linear time: 351.427 μs
Average a @ b time: 200.698 μs
Average bmm time: 26.538 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.483
Speedup (a @ b / grouped_gemm): 1.989
Speedup (bmm / grouped_gemm): 0.263

======================
TFLOPS (grouped_gemm): 4.895
TFLOPS (nn.Linear): 1.405
TFLOPS (a @ b): 2.461
TFLOPS (bmm): 18.610

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 100.610 μs

======================
Average nn.Linear time: 351.264 μs
Average a @ b time: 200.870 μs
Average bmm time: 36.135 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.491
Speedup (a @ b / grouped_gemm): 1.997
Speedup (bmm / grouped_gemm): 0.359

======================
TFLOPS (grouped_gemm): 8.512
TFLOPS (nn.Linear): 2.438
TFLOPS (a @ b): 4.264
TFLOPS (bmm): 23.701

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 122.135 μs

======================
Average nn.Linear time: 287.199 μs
Average a @ b time: 153.043 μs
Average bmm time: 48.809 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.351
Speedup (a @ b / grouped_gemm): 1.253
Speedup (bmm / grouped_gemm): 0.400

======================
TFLOPS (grouped_gemm): 14.192
TFLOPS (nn.Linear): 6.035
TFLOPS (a @ b): 11.326
TFLOPS (bmm): 35.512

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 148.027 μs

======================
Average nn.Linear time: 300.636 μs
Average a @ b time: 161.111 μs
Average bmm time: 75.643 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.031
Speedup (a @ b / grouped_gemm): 1.088
Speedup (bmm / grouped_gemm): 0.511

======================
TFLOPS (grouped_gemm): 23.652
TFLOPS (nn.Linear): 11.646
TFLOPS (a @ b): 21.732
TFLOPS (bmm): 46.286

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 193.062 μs

======================
Average nn.Linear time: 287.485 μs
Average a @ b time: 177.743 μs
Average bmm time: 132.077 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.489
Speedup (a @ b / grouped_gemm): 0.921
Speedup (bmm / grouped_gemm): 0.684

======================
TFLOPS (grouped_gemm): 33.272
TFLOPS (nn.Linear): 22.344
TFLOPS (a @ b): 36.140
TFLOPS (bmm): 48.635

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 306.427 μs

======================
Average nn.Linear time: 313.227 μs
Average a @ b time: 346.980 μs
Average bmm time: 179.470 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.022
Speedup (a @ b / grouped_gemm): 1.132
Speedup (bmm / grouped_gemm): 0.586

======================
TFLOPS (grouped_gemm): 48.249
TFLOPS (nn.Linear): 47.202
TFLOPS (a @ b): 42.610
TFLOPS (bmm): 82.381

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 468.163 μs

======================
Average nn.Linear time: 340.242 μs
Average a @ b time: 412.369 μs
Average bmm time: 294.917 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.727
Speedup (a @ b / grouped_gemm): 0.881
Speedup (bmm / grouped_gemm): 0.630

======================
TFLOPS (grouped_gemm): 40.685
TFLOPS (nn.Linear): 55.982
TFLOPS (a @ b): 46.190
TFLOPS (bmm): 64.586

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 177.681 μs

======================
Average nn.Linear time: 343.733 μs
Average a @ b time: 200.584 μs
Average bmm time: 64.023 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.935
Speedup (a @ b / grouped_gemm): 1.129
Speedup (bmm / grouped_gemm): 0.360

======================
TFLOPS (grouped_gemm): 11.956
TFLOPS (nn.Linear): 6.180
TFLOPS (a @ b): 10.591
TFLOPS (bmm): 33.182

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 179.369 μs

======================
Average nn.Linear time: 336.468 μs
Average a @ b time: 220.664 μs
Average bmm time: 90.365 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.876
Speedup (a @ b / grouped_gemm): 1.230
Speedup (bmm / grouped_gemm): 0.504

======================
TFLOPS (grouped_gemm): 25.722
TFLOPS (nn.Linear): 13.712
TFLOPS (a @ b): 20.908
TFLOPS (bmm): 51.056

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 279.841 μs

======================
Average nn.Linear time: 332.465 μs
Average a @ b time: 268.247 μs
Average bmm time: 144.355 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.188
Speedup (a @ b / grouped_gemm): 0.959
Speedup (bmm / grouped_gemm): 0.516

======================
TFLOPS (grouped_gemm): 39.988
TFLOPS (nn.Linear): 33.659
TFLOPS (a @ b): 41.717
TFLOPS (bmm): 77.520

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 383.832 μs

======================
Average nn.Linear time: 325.077 μs
Average a @ b time: 344.000 μs
Average bmm time: 268.040 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.847
Speedup (a @ b / grouped_gemm): 0.896
Speedup (bmm / grouped_gemm): 0.698

======================
TFLOPS (grouped_gemm): 41.393
TFLOPS (nn.Linear): 48.875
TFLOPS (a @ b): 46.186
TFLOPS (bmm): 59.275

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 594.461 μs

======================
Average nn.Linear time: 486.979 μs
Average a @ b time: 482.302 μs
Average bmm time: 604.103 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.819
Speedup (a @ b / grouped_gemm): 0.811
Speedup (bmm / grouped_gemm): 1.016

======================
TFLOPS (grouped_gemm): 58.534
TFLOPS (nn.Linear): 71.453
TFLOPS (a @ b): 72.146
TFLOPS (bmm): 57.599

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 3823.00 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 1131.749 μs

======================
Average nn.Linear time: 868.196 μs
Average a @ b time: 865.886 μs
Average bmm time: 739.241 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.767
Speedup (a @ b / grouped_gemm): 0.765
Speedup (bmm / grouped_gemm): 0.653

======================
TFLOPS (grouped_gemm): 54.494
TFLOPS (nn.Linear): 71.036
TFLOPS (a @ b): 71.225
TFLOPS (bmm): 83.428

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 1922.581 μs

======================
Average nn.Linear time: 1592.710 μs
Average a @ b time: 1571.321 μs
Average bmm time: 1289.496 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.828
Speedup (a @ b / grouped_gemm): 0.817
Speedup (bmm / grouped_gemm): 0.671

======================
TFLOPS (grouped_gemm): 74.829
TFLOPS (nn.Linear): 90.327
TFLOPS (a @ b): 91.556
TFLOPS (bmm): 111.567

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 85.084 μs

======================
Average nn.Linear time: 309.896 μs
Average a @ b time: 166.731 μs
Average bmm time: 22.008 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.642
Speedup (a @ b / grouped_gemm): 1.960
Speedup (bmm / grouped_gemm): 0.259

======================
TFLOPS (grouped_gemm): 1.116
TFLOPS (nn.Linear): 0.306
TFLOPS (a @ b): 0.570
TFLOPS (bmm): 4.315

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 84.925 μs

======================
Average nn.Linear time: 308.793 μs
Average a @ b time: 169.399 μs
Average bmm time: 25.966 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.636
Speedup (a @ b / grouped_gemm): 1.995
Speedup (bmm / grouped_gemm): 0.306

======================
TFLOPS (grouped_gemm): 3.497
TFLOPS (nn.Linear): 0.962
TFLOPS (a @ b): 1.753
TFLOPS (bmm): 11.438

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 91.236 μs

======================
Average nn.Linear time: 296.106 μs
Average a @ b time: 156.388 μs
Average bmm time: 33.422 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.246
Speedup (a @ b / grouped_gemm): 1.714
Speedup (bmm / grouped_gemm): 0.366

======================
TFLOPS (grouped_gemm): 5.755
TFLOPS (nn.Linear): 1.773
TFLOPS (a @ b): 3.358
TFLOPS (bmm): 15.711

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 99.773 μs

======================
Average nn.Linear time: 300.055 μs
Average a @ b time: 156.617 μs
Average bmm time: 42.467 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.007
Speedup (a @ b / grouped_gemm): 1.570
Speedup (bmm / grouped_gemm): 0.426

======================
TFLOPS (grouped_gemm): 10.210
TFLOPS (nn.Linear): 3.395
TFLOPS (a @ b): 6.504
TFLOPS (bmm): 23.988

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 120.986 μs

======================
Average nn.Linear time: 293.121 μs
Average a @ b time: 154.319 μs
Average bmm time: 66.900 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.423
Speedup (a @ b / grouped_gemm): 1.276
Speedup (bmm / grouped_gemm): 0.553

======================
TFLOPS (grouped_gemm): 20.272
TFLOPS (nn.Linear): 8.367
TFLOPS (a @ b): 15.893
TFLOPS (bmm): 36.661

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 155.623 μs

======================
Average nn.Linear time: 296.216 μs
Average a @ b time: 173.504 μs
Average bmm time: 96.974 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.903
Speedup (a @ b / grouped_gemm): 1.115
Speedup (bmm / grouped_gemm): 0.623

======================
TFLOPS (grouped_gemm): 26.709
TFLOPS (nn.Linear): 14.032
TFLOPS (a @ b): 23.956
TFLOPS (bmm): 42.862

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 212.893 μs

======================
Average nn.Linear time: 303.729 μs
Average a @ b time: 230.455 μs
Average bmm time: 166.581 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.427
Speedup (a @ b / grouped_gemm): 1.082
Speedup (bmm / grouped_gemm): 0.782

======================
TFLOPS (grouped_gemm): 37.201
TFLOPS (nn.Linear): 26.076
TFLOPS (a @ b): 34.366
TFLOPS (bmm): 47.544

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 100.908 μs

======================
Average nn.Linear time: 349.550 μs
Average a @ b time: 203.021 μs
Average bmm time: 31.252 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.464
Speedup (a @ b / grouped_gemm): 2.012
Speedup (bmm / grouped_gemm): 0.310

======================
TFLOPS (grouped_gemm): 8.947
TFLOPS (nn.Linear): 2.583
TFLOPS (a @ b): 4.447
TFLOPS (bmm): 28.889

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 98.114 μs

======================
Average nn.Linear time: 355.248 μs
Average a @ b time: 200.801 μs
Average bmm time: 38.898 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.621
Speedup (a @ b / grouped_gemm): 2.047
Speedup (bmm / grouped_gemm): 0.396

======================
TFLOPS (grouped_gemm): 17.442
TFLOPS (nn.Linear): 4.817
TFLOPS (a @ b): 8.522
TFLOPS (bmm): 43.994

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 122.278 μs

======================
Average nn.Linear time: 285.087 μs
Average a @ b time: 152.018 μs
Average bmm time: 54.672 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.331
Speedup (a @ b / grouped_gemm): 1.243
Speedup (bmm / grouped_gemm): 0.447

======================
TFLOPS (grouped_gemm): 22.266
TFLOPS (nn.Linear): 9.550
TFLOPS (a @ b): 17.910
TFLOPS (bmm): 49.800

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 145.900 μs

======================
Average nn.Linear time: 292.437 μs
Average a @ b time: 160.642 μs
Average bmm time: 86.854 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.004
Speedup (a @ b / grouped_gemm): 1.101
Speedup (bmm / grouped_gemm): 0.595

======================
TFLOPS (grouped_gemm): 37.839
TFLOPS (nn.Linear): 18.878
TFLOPS (a @ b): 34.367
TFLOPS (bmm): 63.564

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 193.660 μs

======================
Average nn.Linear time: 286.047 μs
Average a @ b time: 206.671 μs
Average bmm time: 148.263 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.477
Speedup (a @ b / grouped_gemm): 1.067
Speedup (bmm / grouped_gemm): 0.766

======================
TFLOPS (grouped_gemm): 55.683
TFLOPS (nn.Linear): 37.698
TFLOPS (a @ b): 52.177
TFLOPS (bmm): 72.733

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 311.980 μs

======================
Average nn.Linear time: 416.262 μs
Average a @ b time: 433.078 μs
Average bmm time: 236.912 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.334
Speedup (a @ b / grouped_gemm): 1.388
Speedup (bmm / grouped_gemm): 0.759

======================
TFLOPS (grouped_gemm): 87.925
TFLOPS (nn.Linear): 65.898
TFLOPS (a @ b): 63.339
TFLOPS (bmm): 115.785

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 482.597 μs

======================
Average nn.Linear time: 531.752 μs
Average a @ b time: 555.568 μs
Average bmm time: 417.655 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.102
Speedup (a @ b / grouped_gemm): 1.151
Speedup (bmm / grouped_gemm): 0.865

======================
TFLOPS (grouped_gemm): 108.595
TFLOPS (nn.Linear): 98.557
TFLOPS (a @ b): 94.332
TFLOPS (bmm): 125.481

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 183.256 μs

======================
Average nn.Linear time: 343.833 μs
Average a @ b time: 205.307 μs
Average bmm time: 82.822 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.876
Speedup (a @ b / grouped_gemm): 1.120
Speedup (bmm / grouped_gemm): 0.452

======================
TFLOPS (grouped_gemm): 21.926
TFLOPS (nn.Linear): 11.686
TFLOPS (a @ b): 19.571
TFLOPS (bmm): 48.515

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 179.198 μs

======================
Average nn.Linear time: 340.991 μs
Average a @ b time: 235.987 μs
Average bmm time: 120.990 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.903
Speedup (a @ b / grouped_gemm): 1.317
Speedup (bmm / grouped_gemm): 0.675

======================
TFLOPS (grouped_gemm): 40.492
TFLOPS (nn.Linear): 21.280
TFLOPS (a @ b): 30.748
TFLOPS (bmm): 59.973

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 282.381 μs

======================
Average nn.Linear time: 330.932 μs
Average a @ b time: 283.389 μs
Average bmm time: 174.985 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.172
Speedup (a @ b / grouped_gemm): 1.004
Speedup (bmm / grouped_gemm): 0.620

======================
TFLOPS (grouped_gemm): 49.907
TFLOPS (nn.Linear): 42.585
TFLOPS (a @ b): 49.730
TFLOPS (bmm): 80.538

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 384.583 μs

======================
Average nn.Linear time: 411.456 μs
Average a @ b time: 416.734 μs
Average bmm time: 278.559 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.070
Speedup (a @ b / grouped_gemm): 1.084
Speedup (bmm / grouped_gemm): 0.724

======================
TFLOPS (grouped_gemm): 97.849
TFLOPS (nn.Linear): 91.459
TFLOPS (a @ b): 90.300
TFLOPS (bmm): 135.093

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 612.464 μs

======================
Average nn.Linear time: 727.944 μs
Average a @ b time: 705.268 μs
Average bmm time: 563.068 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.189
Speedup (a @ b / grouped_gemm): 1.152
Speedup (bmm / grouped_gemm): 0.919

======================
TFLOPS (grouped_gemm): 118.995
TFLOPS (nn.Linear): 100.118
TFLOPS (a @ b): 103.337
TFLOPS (bmm): 129.434

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 3950.20 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 1170.337 μs

======================
Average nn.Linear time: 1088.595 μs
Average a @ b time: 1065.733 μs
Average bmm time: 1331.403 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.930
Speedup (a @ b / grouped_gemm): 0.911
Speedup (bmm / grouped_gemm): 1.138

======================
TFLOPS (grouped_gemm): 115.199
TFLOPS (nn.Linear): 123.849
TFLOPS (a @ b): 126.506
TFLOPS (bmm): 101.263

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 1970.937 μs

======================
Average nn.Linear time: 1665.537 μs
Average a @ b time: 1640.429 μs
Average bmm time: 2465.959 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.845
Speedup (a @ b / grouped_gemm): 0.832
Speedup (bmm / grouped_gemm): 1.251

======================
TFLOPS (grouped_gemm): 90.988
TFLOPS (nn.Linear): 107.672
TFLOPS (a @ b): 109.320
TFLOPS (bmm): 72.723

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 84.903 μs

======================
Average nn.Linear time: 300.395 μs
Average a @ b time: 159.919 μs
Average bmm time: 26.033 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.538
Speedup (a @ b / grouped_gemm): 1.884
Speedup (bmm / grouped_gemm): 0.307

======================
TFLOPS (grouped_gemm): 3.683
TFLOPS (nn.Linear): 1.041
TFLOPS (a @ b): 1.955
TFLOPS (bmm): 12.011

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 83.671 μs

======================
Average nn.Linear time: 296.373 μs
Average a @ b time: 159.285 μs
Average bmm time: 29.533 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.542
Speedup (a @ b / grouped_gemm): 1.904
Speedup (bmm / grouped_gemm): 0.353

======================
TFLOPS (grouped_gemm): 6.299
TFLOPS (nn.Linear): 1.778
TFLOPS (a @ b): 3.309
TFLOPS (bmm): 17.846

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 91.519 μs

======================
Average nn.Linear time: 290.766 μs
Average a @ b time: 152.256 μs
Average bmm time: 41.747 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.177
Speedup (a @ b / grouped_gemm): 1.664
Speedup (bmm / grouped_gemm): 0.456

======================
TFLOPS (grouped_gemm): 11.604
TFLOPS (nn.Linear): 3.652
TFLOPS (a @ b): 6.975
TFLOPS (bmm): 25.438

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 110.555 μs

======================
Average nn.Linear time: 294.673 μs
Average a @ b time: 164.819 μs
Average bmm time: 63.107 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.665
Speedup (a @ b / grouped_gemm): 1.491
Speedup (bmm / grouped_gemm): 0.571

======================
TFLOPS (grouped_gemm): 20.895
TFLOPS (nn.Linear): 7.839
TFLOPS (a @ b): 14.015
TFLOPS (bmm): 36.605

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 135.696 μs

======================
Average nn.Linear time: 284.214 μs
Average a @ b time: 149.393 μs
Average bmm time: 108.864 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.094
Speedup (a @ b / grouped_gemm): 1.101
Speedup (bmm / grouped_gemm): 0.802

======================
TFLOPS (grouped_gemm): 28.669
TFLOPS (nn.Linear): 13.688
TFLOPS (a @ b): 26.040
TFLOPS (bmm): 35.735

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 175.798 μs

======================
Average nn.Linear time: 294.600 μs
Average a @ b time: 197.785 μs
Average bmm time: 128.634 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.676
Speedup (a @ b / grouped_gemm): 1.125
Speedup (bmm / grouped_gemm): 0.732

======================
TFLOPS (grouped_gemm): 37.661
TFLOPS (nn.Linear): 22.474
TFLOPS (a @ b): 33.474
TFLOPS (bmm): 51.469

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 279.419 μs

======================
Average nn.Linear time: 304.577 μs
Average a @ b time: 298.393 μs
Average bmm time: 284.088 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.090
Speedup (a @ b / grouped_gemm): 1.068
Speedup (bmm / grouped_gemm): 1.017

======================
TFLOPS (grouped_gemm): 50.226
TFLOPS (nn.Linear): 46.077
TFLOPS (a @ b): 47.032
TFLOPS (bmm): 49.401

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 100.355 μs

======================
Average nn.Linear time: 329.330 μs
Average a @ b time: 181.794 μs
Average bmm time: 38.843 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.282
Speedup (a @ b / grouped_gemm): 1.812
Speedup (bmm / grouped_gemm): 0.387

======================
TFLOPS (grouped_gemm): 16.347
TFLOPS (nn.Linear): 4.981
TFLOPS (a @ b): 9.024
TFLOPS (bmm): 42.234

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 100.880 μs

======================
Average nn.Linear time: 298.443 μs
Average a @ b time: 160.122 μs
Average bmm time: 54.727 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.958
Speedup (a @ b / grouped_gemm): 1.587
Speedup (bmm / grouped_gemm): 0.542

======================
TFLOPS (grouped_gemm): 41.115
TFLOPS (nn.Linear): 13.898
TFLOPS (a @ b): 25.903
TFLOPS (bmm): 75.788

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 123.141 μs

======================
Average nn.Linear time: 283.313 μs
Average a @ b time: 163.021 μs
Average bmm time: 84.169 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.301
Speedup (a @ b / grouped_gemm): 1.324
Speedup (bmm / grouped_gemm): 0.684

======================
TFLOPS (grouped_gemm): 54.336
TFLOPS (nn.Linear): 23.617
TFLOPS (a @ b): 41.044
TFLOPS (bmm): 79.494

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 170.763 μs

======================
Average nn.Linear time: 291.247 μs
Average a @ b time: 203.972 μs
Average bmm time: 148.082 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.706
Speedup (a @ b / grouped_gemm): 1.194
Speedup (bmm / grouped_gemm): 0.867

======================
TFLOPS (grouped_gemm): 80.300
TFLOPS (nn.Linear): 47.081
TFLOPS (a @ b): 67.226
TFLOPS (bmm): 92.599

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 239.553 μs

======================
Average nn.Linear time: 283.747 μs
Average a @ b time: 256.727 μs
Average bmm time: 266.740 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.184
Speedup (a @ b / grouped_gemm): 1.072
Speedup (bmm / grouped_gemm): 1.113

======================
TFLOPS (grouped_gemm): 89.794
TFLOPS (nn.Linear): 75.809
TFLOPS (a @ b): 83.787
TFLOPS (bmm): 80.642

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 385.170 μs

======================
Average nn.Linear time: 484.183 μs
Average a @ b time: 489.345 μs
Average bmm time: 433.135 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.257
Speedup (a @ b / grouped_gemm): 1.270
Speedup (bmm / grouped_gemm): 1.125

======================
TFLOPS (grouped_gemm): 118.456
TFLOPS (nn.Linear): 94.232
TFLOPS (a @ b): 93.238
TFLOPS (bmm): 105.338

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 557.697 μs

======================
Average nn.Linear time: 598.328 μs
Average a @ b time: 608.358 μs
Average bmm time: 591.621 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.073
Speedup (a @ b / grouped_gemm): 1.091
Speedup (bmm / grouped_gemm): 1.061

======================
TFLOPS (grouped_gemm): 117.860
TFLOPS (nn.Linear): 109.856
TFLOPS (a @ b): 108.045
TFLOPS (bmm): 111.101

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 187.211 μs

======================
Average nn.Linear time: 328.617 μs
Average a @ b time: 251.892 μs
Average bmm time: 125.060 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.755
Speedup (a @ b / grouped_gemm): 1.345
Speedup (bmm / grouped_gemm): 0.668

======================
TFLOPS (grouped_gemm): 53.468
TFLOPS (nn.Linear): 30.460
TFLOPS (a @ b): 39.738
TFLOPS (bmm): 80.039

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 279.303 μs

======================
Average nn.Linear time: 320.950 μs
Average a @ b time: 301.888 μs
Average bmm time: 192.807 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.149
Speedup (a @ b / grouped_gemm): 1.081
Speedup (bmm / grouped_gemm): 0.690

======================
TFLOPS (grouped_gemm): 76.782
TFLOPS (nn.Linear): 66.819
TFLOPS (a @ b): 71.038
TFLOPS (bmm): 111.228

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 284.424 μs

======================
Average nn.Linear time: 399.561 μs
Average a @ b time: 396.695 μs
Average bmm time: 275.311 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.405
Speedup (a @ b / grouped_gemm): 1.395
Speedup (bmm / grouped_gemm): 0.968

======================
TFLOPS (grouped_gemm): 139.032
TFLOPS (nn.Linear): 98.968
TFLOPS (a @ b): 99.683
TFLOPS (bmm): 143.633

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 496.454 μs

======================
Average nn.Linear time: 571.568 μs
Average a @ b time: 580.549 μs
Average bmm time: 542.636 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.151
Speedup (a @ b / grouped_gemm): 1.169
Speedup (bmm / grouped_gemm): 1.093

======================
TFLOPS (grouped_gemm): 128.823
TFLOPS (nn.Linear): 111.894
TFLOPS (a @ b): 110.162
TFLOPS (bmm): 117.859

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 948.532 μs

======================
Average nn.Linear time: 868.688 μs
Average a @ b time: 853.794 μs
Average bmm time: 1084.752 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.916
Speedup (a @ b / grouped_gemm): 0.900
Speedup (bmm / grouped_gemm): 1.144

======================
TFLOPS (grouped_gemm): 128.659
TFLOPS (nn.Linear): 140.485
TFLOPS (a @ b): 142.936
TFLOPS (bmm): 112.503

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 4060.05 MB
Max memory reserved: 4686.00 MB
Average grouped_gemm time: 1460.781 μs

======================
Average nn.Linear time: 1517.117 μs
Average a @ b time: 1467.671 μs
Average bmm time: 2488.039 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.039
Speedup (a @ b / grouped_gemm): 1.005
Speedup (bmm / grouped_gemm): 1.703

======================
TFLOPS (grouped_gemm): 152.476
TFLOPS (nn.Linear): 146.814
TFLOPS (a @ b): 151.760
TFLOPS (bmm): 89.522

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 3256.671 μs

======================
Average nn.Linear time: 3064.473 μs
Average a @ b time: 3021.734 μs
Average bmm time: 4954.715 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.941
Speedup (a @ b / grouped_gemm): 0.928
Speedup (bmm / grouped_gemm): 1.521

======================
TFLOPS (grouped_gemm): 156.327
TFLOPS (nn.Linear): 166.131
TFLOPS (a @ b): 168.481
TFLOPS (bmm): 102.752

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 85.671 μs

======================
Average nn.Linear time: 315.256 μs
Average a @ b time: 165.889 μs
Average bmm time: 30.203 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.680
Speedup (a @ b / grouped_gemm): 1.936
Speedup (bmm / grouped_gemm): 0.353

======================
TFLOPS (grouped_gemm): 6.945
TFLOPS (nn.Linear): 1.887
TFLOPS (a @ b): 3.587
TFLOPS (bmm): 19.700

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 90.795 μs

======================
Average nn.Linear time: 297.976 μs
Average a @ b time: 158.172 μs
Average bmm time: 37.303 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.282
Speedup (a @ b / grouped_gemm): 1.742
Speedup (bmm / grouped_gemm): 0.411

======================
TFLOPS (grouped_gemm): 9.824
TFLOPS (nn.Linear): 2.993
TFLOPS (a @ b): 5.639
TFLOPS (bmm): 23.911

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 100.625 μs

======================
Average nn.Linear time: 288.374 μs
Average a @ b time: 149.190 μs
Average bmm time: 59.795 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.866
Speedup (a @ b / grouped_gemm): 1.483
Speedup (bmm / grouped_gemm): 0.594

======================
TFLOPS (grouped_gemm): 17.069
TFLOPS (nn.Linear): 5.956
TFLOPS (a @ b): 11.513
TFLOPS (bmm): 28.724

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 137.935 μs

======================
Average nn.Linear time: 284.586 μs
Average a @ b time: 162.654 μs
Average bmm time: 111.399 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.063
Speedup (a @ b / grouped_gemm): 1.179
Speedup (bmm / grouped_gemm): 0.808

======================
TFLOPS (grouped_gemm): 39.017
TFLOPS (nn.Linear): 18.911
TFLOPS (a @ b): 33.088
TFLOPS (bmm): 48.311

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 196.278 μs

======================
Average nn.Linear time: 302.916 μs
Average a @ b time: 231.640 μs
Average bmm time: 196.404 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.543
Speedup (a @ b / grouped_gemm): 1.180
Speedup (bmm / grouped_gemm): 1.001

======================
TFLOPS (grouped_gemm): 51.104
TFLOPS (nn.Linear): 33.114
TFLOPS (a @ b): 43.303
TFLOPS (bmm): 51.072

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 269.949 μs

======================
Average nn.Linear time: 319.529 μs
Average a @ b time: 329.401 μs
Average bmm time: 331.974 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.184
Speedup (a @ b / grouped_gemm): 1.220
Speedup (bmm / grouped_gemm): 1.230

======================
TFLOPS (grouped_gemm): 63.392
TFLOPS (nn.Linear): 53.556
TFLOPS (a @ b): 51.951
TFLOPS (bmm): 51.548

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 434.799 μs

======================
Average nn.Linear time: 471.954 μs
Average a @ b time: 494.015 μs
Average bmm time: 508.657 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.085
Speedup (a @ b / grouped_gemm): 1.136
Speedup (bmm / grouped_gemm): 1.170

======================
TFLOPS (grouped_gemm): 74.743
TFLOPS (nn.Linear): 68.858
TFLOPS (a @ b): 65.783
TFLOPS (bmm): 63.890

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4900.00 MB
Average grouped_gemm time: 102.324 μs

======================
Average nn.Linear time: 303.240 μs
Average a @ b time: 164.526 μs
Average bmm time: 56.872 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.964
Speedup (a @ b / grouped_gemm): 1.608
Speedup (bmm / grouped_gemm): 0.556

======================
TFLOPS (grouped_gemm): 34.197
TFLOPS (nn.Linear): 11.539
TFLOPS (a @ b): 21.269
TFLOPS (bmm): 61.528

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 123.932 μs

======================
Average nn.Linear time: 303.783 μs
Average a @ b time: 189.512 μs
Average bmm time: 86.739 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.451
Speedup (a @ b / grouped_gemm): 1.529
Speedup (bmm / grouped_gemm): 0.700

======================
TFLOPS (grouped_gemm): 63.336
TFLOPS (nn.Linear): 25.839
TFLOPS (a @ b): 41.419
TFLOPS (bmm): 90.494

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 146.375 μs

======================
Average nn.Linear time: 289.721 μs
Average a @ b time: 176.382 μs
Average bmm time: 131.631 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.979
Speedup (a @ b / grouped_gemm): 1.205
Speedup (bmm / grouped_gemm): 0.899

======================
TFLOPS (grouped_gemm): 69.717
TFLOPS (nn.Linear): 35.223
TFLOPS (a @ b): 57.856
TFLOPS (bmm): 77.525

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 195.799 μs

======================
Average nn.Linear time: 303.533 μs
Average a @ b time: 249.908 μs
Average bmm time: 266.168 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.550
Speedup (a @ b / grouped_gemm): 1.276
Speedup (bmm / grouped_gemm): 1.359

======================
TFLOPS (grouped_gemm): 107.354
TFLOPS (nn.Linear): 69.250
TFLOPS (a @ b): 84.110
TFLOPS (bmm): 78.972

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 359.738 μs

======================
Average nn.Linear time: 398.870 μs
Average a @ b time: 383.523 μs
Average bmm time: 519.061 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.109
Speedup (a @ b / grouped_gemm): 1.066
Speedup (bmm / grouped_gemm): 1.443

======================
TFLOPS (grouped_gemm): 131.115
TFLOPS (nn.Linear): 118.252
TFLOPS (a @ b): 122.984
TFLOPS (bmm): 90.870

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 725.937 μs

======================
Average nn.Linear time: 718.081 μs
Average a @ b time: 714.219 μs
Average bmm time: 1167.295 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.989
Speedup (a @ b / grouped_gemm): 0.984
Speedup (bmm / grouped_gemm): 1.608

======================
TFLOPS (grouped_gemm): 155.636
TFLOPS (nn.Linear): 157.339
TFLOPS (a @ b): 158.190
TFLOPS (bmm): 96.790

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 1493.275 μs

======================
Average nn.Linear time: 1437.123 μs
Average a @ b time: 1435.113 μs
Average bmm time: 1591.191 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.962
Speedup (a @ b / grouped_gemm): 0.961
Speedup (bmm / grouped_gemm): 1.066

======================
TFLOPS (grouped_gemm): 169.286
TFLOPS (nn.Linear): 175.901
TFLOPS (a @ b): 176.147
TFLOPS (bmm): 158.869

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 186.458 μs

======================
Average nn.Linear time: 319.560 μs
Average a @ b time: 295.196 μs
Average bmm time: 177.159 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.714
Speedup (a @ b / grouped_gemm): 1.583
Speedup (bmm / grouped_gemm): 0.950

======================
TFLOPS (grouped_gemm): 101.800
TFLOPS (nn.Linear): 59.398
TFLOPS (a @ b): 64.301
TFLOPS (bmm): 107.143

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 284.252 μs

======================
Average nn.Linear time: 372.899 μs
Average a @ b time: 363.419 μs
Average bmm time: 274.594 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.312
Speedup (a @ b / grouped_gemm): 1.279
Speedup (bmm / grouped_gemm): 0.966

======================
TFLOPS (grouped_gemm): 120.199
TFLOPS (nn.Linear): 91.625
TFLOPS (a @ b): 94.015
TFLOPS (bmm): 124.427

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 398.393 μs

======================
Average nn.Linear time: 523.643 μs
Average a @ b time: 508.885 μs
Average bmm time: 540.836 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.314
Speedup (a @ b / grouped_gemm): 1.277
Speedup (bmm / grouped_gemm): 1.358

======================
TFLOPS (grouped_gemm): 172.071
TFLOPS (nn.Linear): 130.913
TFLOPS (a @ b): 134.710
TFLOPS (bmm): 126.751

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 733.874 μs

======================
Average nn.Linear time: 834.341 μs
Average a @ b time: 820.532 μs
Average bmm time: 1033.072 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.137
Speedup (a @ b / grouped_gemm): 1.118
Speedup (bmm / grouped_gemm): 1.408

======================
TFLOPS (grouped_gemm): 172.190
TFLOPS (nn.Linear): 151.456
TFLOPS (a @ b): 154.005
TFLOPS (bmm): 122.321

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 1549.864 μs

======================
Average nn.Linear time: 1579.912 μs
Average a @ b time: 1556.127 μs
Average bmm time: 2063.890 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.019
Speedup (a @ b / grouped_gemm): 1.004
Speedup (bmm / grouped_gemm): 1.332

======================
TFLOPS (grouped_gemm): 187.705
TFLOPS (nn.Linear): 184.135
TFLOPS (a @ b): 186.949
TFLOPS (bmm): 140.956

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 4589.75 MB
Max memory reserved: 4910.00 MB
Average grouped_gemm time: 3212.714 μs

======================
Average nn.Linear time: 3168.180 μs
Average a @ b time: 3129.144 μs
Average bmm time: 5046.463 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.986
Speedup (a @ b / grouped_gemm): 0.974
Speedup (bmm / grouped_gemm): 1.571

======================
TFLOPS (grouped_gemm): 184.550
TFLOPS (nn.Linear): 187.144
TFLOPS (a @ b): 189.479
TFLOPS (bmm): 117.490

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 5416.017 μs

======================
Average nn.Linear time: 4998.636 μs
Average a @ b time: 5002.379 μs
Average bmm time: 9951.339 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.923
Speedup (a @ b / grouped_gemm): 0.924
Speedup (bmm / grouped_gemm): 1.837

======================
TFLOPS (grouped_gemm): 179.695
TFLOPS (nn.Linear): 194.699
TFLOPS (a @ b): 194.553
TFLOPS (bmm): 97.799

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 97.191 μs

======================
Average nn.Linear time: 304.406 μs
Average a @ b time: 159.495 μs
Average bmm time: 38.481 μs

======================
Speedup (nn.Linear / grouped_gemm): 3.132
Speedup (a @ b / grouped_gemm): 1.641
Speedup (bmm / grouped_gemm): 0.396

======================
TFLOPS (grouped_gemm): 11.317
TFLOPS (nn.Linear): 3.613
TFLOPS (a @ b): 6.896
TFLOPS (bmm): 28.583

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 111.563 μs

======================
Average nn.Linear time: 303.056 μs
Average a @ b time: 159.447 μs
Average bmm time: 55.590 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.716
Speedup (a @ b / grouped_gemm): 1.429
Speedup (bmm / grouped_gemm): 0.498

======================
TFLOPS (grouped_gemm): 22.461
TFLOPS (nn.Linear): 8.269
TFLOPS (a @ b): 15.716
TFLOPS (bmm): 45.077

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 131.187 μs

======================
Average nn.Linear time: 294.428 μs
Average a @ b time: 154.448 μs
Average bmm time: 109.668 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.244
Speedup (a @ b / grouped_gemm): 1.177
Speedup (bmm / grouped_gemm): 0.836

======================
TFLOPS (grouped_gemm): 32.322
TFLOPS (nn.Linear): 14.401
TFLOPS (a @ b): 27.454
TFLOPS (bmm): 38.664

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 153.272 μs

======================
Average nn.Linear time: 299.497 μs
Average a @ b time: 175.939 μs
Average bmm time: 176.272 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.954
Speedup (a @ b / grouped_gemm): 1.148
Speedup (bmm / grouped_gemm): 1.150

======================
TFLOPS (grouped_gemm): 43.894
TFLOPS (nn.Linear): 22.463
TFLOPS (a @ b): 38.239
TFLOPS (bmm): 38.166

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 278.864 μs

======================
Average nn.Linear time: 332.222 μs
Average a @ b time: 325.246 μs
Average bmm time: 328.610 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.191
Speedup (a @ b / grouped_gemm): 1.166
Speedup (bmm / grouped_gemm): 1.178

======================
TFLOPS (grouped_gemm): 71.785
TFLOPS (nn.Linear): 60.256
TFLOPS (a @ b): 61.548
TFLOPS (bmm): 60.918

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 424.635 μs

======================
Average nn.Linear time: 482.588 μs
Average a @ b time: 491.977 μs
Average bmm time: 658.979 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.136
Speedup (a @ b / grouped_gemm): 1.159
Speedup (bmm / grouped_gemm): 1.552

======================
TFLOPS (grouped_gemm): 82.832
TFLOPS (nn.Linear): 72.885
TFLOPS (a @ b): 71.494
TFLOPS (bmm): 53.376

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 706.954 μs

======================
Average nn.Linear time: 765.834 μs
Average a @ b time: 796.580 μs
Average bmm time: 1122.537 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.083
Speedup (a @ b / grouped_gemm): 1.127
Speedup (bmm / grouped_gemm): 1.588

======================
TFLOPS (grouped_gemm): 89.498
TFLOPS (nn.Linear): 82.617
TFLOPS (a @ b): 79.428
TFLOPS (bmm): 56.364

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 124.118 μs

======================
Average nn.Linear time: 293.906 μs
Average a @ b time: 176.647 μs
Average bmm time: 81.041 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.368
Speedup (a @ b / grouped_gemm): 1.423
Speedup (bmm / grouped_gemm): 0.653

======================
TFLOPS (grouped_gemm): 47.689
TFLOPS (nn.Linear): 20.139
TFLOPS (a @ b): 33.508
TFLOPS (bmm): 73.038

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 149.031 μs

======================
Average nn.Linear time: 298.600 μs
Average a @ b time: 217.264 μs
Average bmm time: 130.384 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.004
Speedup (a @ b / grouped_gemm): 1.458
Speedup (bmm / grouped_gemm): 0.875

======================
TFLOPS (grouped_gemm): 82.801
TFLOPS (nn.Linear): 41.326
TFLOPS (a @ b): 56.797
TFLOPS (bmm): 94.643

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 196.764 μs

======================
Average nn.Linear time: 305.171 μs
Average a @ b time: 240.548 μs
Average bmm time: 229.111 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.551
Speedup (a @ b / grouped_gemm): 1.223
Speedup (bmm / grouped_gemm): 1.164

======================
TFLOPS (grouped_gemm): 113.654
TFLOPS (nn.Linear): 73.280
TFLOPS (a @ b): 92.967
TFLOPS (bmm): 97.608

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 362.062 μs

======================
Average nn.Linear time: 449.691 μs
Average a @ b time: 443.199 μs
Average bmm time: 433.128 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.242
Speedup (a @ b / grouped_gemm): 1.224
Speedup (bmm / grouped_gemm): 1.196

======================
TFLOPS (grouped_gemm): 152.985
TFLOPS (nn.Linear): 123.173
TFLOPS (a @ b): 124.978
TFLOPS (bmm): 127.884

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 587.854 μs

======================
Average nn.Linear time: 617.578 μs
Average a @ b time: 612.946 μs
Average bmm time: 857.501 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.051
Speedup (a @ b / grouped_gemm): 1.043
Speedup (bmm / grouped_gemm): 1.459

======================
TFLOPS (grouped_gemm): 169.130
TFLOPS (nn.Linear): 160.990
TFLOPS (a @ b): 162.207
TFLOPS (bmm): 115.946

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 836.096 μs

======================
Average nn.Linear time: 883.164 μs
Average a @ b time: 886.436 μs
Average bmm time: 1461.716 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.056
Speedup (a @ b / grouped_gemm): 1.060
Speedup (bmm / grouped_gemm): 1.748

======================
TFLOPS (grouped_gemm): 167.562
TFLOPS (nn.Linear): 158.632
TFLOPS (a @ b): 158.047
TFLOPS (bmm): 95.845

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 1834.667 μs

======================
Average nn.Linear time: 1741.166 μs
Average a @ b time: 1746.240 μs
Average bmm time: 4456.604 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.949
Speedup (a @ b / grouped_gemm): 0.952
Speedup (bmm / grouped_gemm): 2.429

======================
TFLOPS (grouped_gemm): 178.665
TFLOPS (nn.Linear): 188.260
TFLOPS (a @ b): 187.713
TFLOPS (bmm): 73.552

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 288.742 μs

======================
Average nn.Linear time: 360.351 μs
Average a @ b time: 352.967 μs
Average bmm time: 319.812 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.248
Speedup (a @ b / grouped_gemm): 1.222
Speedup (bmm / grouped_gemm): 1.108

======================
TFLOPS (grouped_gemm): 107.087
TFLOPS (nn.Linear): 85.806
TFLOPS (a @ b): 87.601
TFLOPS (bmm): 96.683

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 407.834 μs

======================
Average nn.Linear time: 618.453 μs
Average a @ b time: 578.072 μs
Average bmm time: 501.535 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.516
Speedup (a @ b / grouped_gemm): 1.417
Speedup (bmm / grouped_gemm): 1.230

======================
TFLOPS (grouped_gemm): 187.843
TFLOPS (nn.Linear): 123.872
TFLOPS (a @ b): 132.525
TFLOPS (bmm): 152.749

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 616.078 μs

======================
Average nn.Linear time: 673.759 μs
Average a @ b time: 660.193 μs
Average bmm time: 1021.745 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.094
Speedup (a @ b / grouped_gemm): 1.072
Speedup (bmm / grouped_gemm): 1.658

======================
TFLOPS (grouped_gemm): 167.969
TFLOPS (nn.Linear): 153.589
TFLOPS (a @ b): 156.745
TFLOPS (bmm): 101.280

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 1451.151 μs

======================
Average nn.Linear time: 1619.494 μs
Average a @ b time: 1599.064 μs
Average bmm time: 2005.398 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.116
Speedup (a @ b / grouped_gemm): 1.102
Speedup (bmm / grouped_gemm): 1.382

======================
TFLOPS (grouped_gemm): 214.358
TFLOPS (nn.Linear): 192.076
TFLOPS (a @ b): 194.530
TFLOPS (bmm): 155.115

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 2393.944 μs

======================
Average nn.Linear time: 2372.062 μs
Average a @ b time: 2383.602 μs
Average bmm time: 3670.297 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.991
Speedup (a @ b / grouped_gemm): 0.996
Speedup (bmm / grouped_gemm): 1.533

======================
TFLOPS (grouped_gemm): 203.980
TFLOPS (nn.Linear): 205.862
TFLOPS (a @ b): 204.865
TFLOPS (bmm): 133.046

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 5447.63 MB
Max memory reserved: 6212.00 MB
Average grouped_gemm time: 5282.583 μs

======================
Average nn.Linear time: 5304.580 μs
Average a @ b time: 5266.354 μs
Average bmm time: 10187.347 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.004
Speedup (a @ b / grouped_gemm): 0.997
Speedup (bmm / grouped_gemm): 1.928

======================
TFLOPS (grouped_gemm): 205.535
TFLOPS (nn.Linear): 204.682
TFLOPS (a @ b): 206.168
TFLOPS (bmm): 106.579

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 7972.00 MB
Average grouped_gemm time: 8752.880 μs

======================
Average nn.Linear time: 8429.165 μs
Average a @ b time: 8421.981 μs
Average bmm time: 19796.138 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.963
Speedup (a @ b / grouped_gemm): 0.962
Speedup (bmm / grouped_gemm): 2.262

======================
TFLOPS (grouped_gemm): 206.855
TFLOPS (nn.Linear): 214.799
TFLOPS (a @ b): 214.983
TFLOPS (bmm): 91.461

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 7972.00 MB
Average grouped_gemm time: 111.611 μs

======================
Average nn.Linear time: 308.018 μs
Average a @ b time: 158.453 μs
Average bmm time: 59.838 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.760
Speedup (a @ b / grouped_gemm): 1.420
Speedup (bmm / grouped_gemm): 0.536

======================
TFLOPS (grouped_gemm): 17.473
TFLOPS (nn.Linear): 6.332
TFLOPS (a @ b): 12.308
TFLOPS (bmm): 32.592

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 7972.00 MB
Average grouped_gemm time: 144.372 μs

======================
Average nn.Linear time: 307.577 μs
Average a @ b time: 185.769 μs
Average bmm time: 96.908 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.130
Speedup (a @ b / grouped_gemm): 1.287
Speedup (bmm / grouped_gemm): 0.671

======================
TFLOPS (grouped_gemm): 38.363
TFLOPS (nn.Linear): 18.007
TFLOPS (a @ b): 29.814
TFLOPS (bmm): 57.153

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 7972.00 MB
Average grouped_gemm time: 163.121 μs

======================
Average nn.Linear time: 304.568 μs
Average a @ b time: 191.510 μs
Average bmm time: 185.320 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.867
Speedup (a @ b / grouped_gemm): 1.174
Speedup (bmm / grouped_gemm): 1.136

======================
TFLOPS (grouped_gemm): 48.661
TFLOPS (nn.Linear): 26.062
TFLOPS (a @ b): 41.448
TFLOPS (bmm): 42.832

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 7972.00 MB
Average grouped_gemm time: 246.465 μs

======================
Average nn.Linear time: 330.350 μs
Average a @ b time: 304.403 μs
Average bmm time: 357.435 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.340
Speedup (a @ b / grouped_gemm): 1.235
Speedup (bmm / grouped_gemm): 1.450

======================
TFLOPS (grouped_gemm): 70.598
TFLOPS (nn.Linear): 52.672
TFLOPS (a @ b): 57.161
TFLOPS (bmm): 48.680

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 7972.00 MB
Average grouped_gemm time: 358.622 μs

======================
Average nn.Linear time: 426.550 μs
Average a @ b time: 414.870 μs
Average bmm time: 615.942 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.189
Speedup (a @ b / grouped_gemm): 1.157
Speedup (bmm / grouped_gemm): 1.718

======================
TFLOPS (grouped_gemm): 81.913
TFLOPS (nn.Linear): 68.869
TFLOPS (a @ b): 70.807
TFLOPS (bmm): 47.693

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 7972.00 MB
Average grouped_gemm time: 723.469 μs

======================
Average nn.Linear time: 839.500 μs
Average a @ b time: 853.424 μs
Average bmm time: 1095.495 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.160
Speedup (a @ b / grouped_gemm): 1.180
Speedup (bmm / grouped_gemm): 1.514

======================
TFLOPS (grouped_gemm): 95.427
TFLOPS (nn.Linear): 82.237
TFLOPS (a @ b): 80.896
TFLOPS (bmm): 63.020

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 967.500 μs

======================
Average nn.Linear time: 1021.807 μs
Average a @ b time: 1051.669 μs
Average bmm time: 2191.286 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.056
Speedup (a @ b / grouped_gemm): 1.087
Speedup (bmm / grouped_gemm): 2.265

======================
TFLOPS (grouped_gemm): 94.134
TFLOPS (nn.Linear): 89.131
TFLOPS (a @ b): 86.601
TFLOPS (bmm): 41.562

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 151.277 μs

======================
Average nn.Linear time: 303.950 μs
Average a @ b time: 242.531 μs
Average bmm time: 133.674 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.009
Speedup (a @ b / grouped_gemm): 1.603
Speedup (bmm / grouped_gemm): 0.884

======================
TFLOPS (grouped_gemm): 91.532
TFLOPS (nn.Linear): 45.556
TFLOPS (a @ b): 57.092
TFLOPS (bmm): 103.586

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 220.256 μs

======================
Average nn.Linear time: 310.180 μs
Average a @ b time: 293.152 μs
Average bmm time: 199.151 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.408
Speedup (a @ b / grouped_gemm): 1.331
Speedup (bmm / grouped_gemm): 0.904

======================
TFLOPS (grouped_gemm): 116.382
TFLOPS (nn.Linear): 82.641
TFLOPS (a @ b): 87.442
TFLOPS (bmm): 128.715

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 392.020 μs

======================
Average nn.Linear time: 492.940 μs
Average a @ b time: 473.588 μs
Average bmm time: 442.483 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.257
Speedup (a @ b / grouped_gemm): 1.208
Speedup (bmm / grouped_gemm): 1.129

======================
TFLOPS (grouped_gemm): 161.243
TFLOPS (nn.Linear): 128.231
TFLOPS (a @ b): 133.471
TFLOPS (bmm): 142.853

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 711.715 μs

======================
Average nn.Linear time: 776.529 μs
Average a @ b time: 763.853 μs
Average bmm time: 824.060 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.091
Speedup (a @ b / grouped_gemm): 1.073
Speedup (bmm / grouped_gemm): 1.158

======================
TFLOPS (grouped_gemm): 184.908
TFLOPS (nn.Linear): 169.474
TFLOPS (a @ b): 172.287
TFLOPS (bmm): 159.699

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 1279.488 μs

======================
Average nn.Linear time: 1280.661 μs
Average a @ b time: 1299.350 μs
Average bmm time: 1684.444 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.001
Speedup (a @ b / grouped_gemm): 1.016
Speedup (bmm / grouped_gemm): 1.316

======================
TFLOPS (grouped_gemm): 189.822
TFLOPS (nn.Linear): 189.649
TFLOPS (a @ b): 186.921
TFLOPS (bmm): 144.187

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 2020.051 μs

======================
Average nn.Linear time: 1971.183 μs
Average a @ b time: 1975.229 μs
Average bmm time: 4489.071 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.976
Speedup (a @ b / grouped_gemm): 0.978
Speedup (bmm / grouped_gemm): 2.222

======================
TFLOPS (grouped_gemm): 192.140
TFLOPS (nn.Linear): 196.903
TFLOPS (a @ b): 196.500
TFLOPS (bmm): 86.462

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 3491.480 μs

======================
Average nn.Linear time: 3330.481 μs
Average a @ b time: 3300.893 μs
Average bmm time: 5368.629 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.954
Speedup (a @ b / grouped_gemm): 0.945
Speedup (bmm / grouped_gemm): 1.538

======================
TFLOPS (grouped_gemm): 192.181
TFLOPS (nn.Linear): 201.471
TFLOPS (a @ b): 203.277
TFLOPS (bmm): 124.985

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 515.592 μs

======================
Average nn.Linear time: 626.917 μs
Average a @ b time: 614.150 μs
Average bmm time: 590.551 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.216
Speedup (a @ b / grouped_gemm): 1.191
Speedup (bmm / grouped_gemm): 1.145

======================
TFLOPS (grouped_gemm): 165.574
TFLOPS (nn.Linear): 136.172
TFLOPS (a @ b): 139.003
TFLOPS (bmm): 144.558

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 634.954 μs

======================
Average nn.Linear time: 825.715 μs
Average a @ b time: 797.284 μs
Average bmm time: 1042.426 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.300
Speedup (a @ b / grouped_gemm): 1.256
Speedup (bmm / grouped_gemm): 1.642

======================
TFLOPS (grouped_gemm): 195.482
TFLOPS (nn.Linear): 150.321
TFLOPS (a @ b): 155.681
TFLOPS (bmm): 119.070

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 1358.981 μs

======================
Average nn.Linear time: 1528.950 μs
Average a @ b time: 1503.763 μs
Average bmm time: 2013.705 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.125
Speedup (a @ b / grouped_gemm): 1.107
Speedup (bmm / grouped_gemm): 1.482

======================
TFLOPS (grouped_gemm): 220.786
TFLOPS (nn.Linear): 196.242
TFLOPS (a @ b): 199.529
TFLOPS (bmm): 149.001

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 2144.854 μs

======================
Average nn.Linear time: 2167.339 μs
Average a @ b time: 2178.359 μs
Average bmm time: 3337.829 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.010
Speedup (a @ b / grouped_gemm): 1.016
Speedup (bmm / grouped_gemm): 1.556

======================
TFLOPS (grouped_gemm): 212.972
TFLOPS (nn.Linear): 210.762
TFLOPS (a @ b): 209.696
TFLOPS (bmm): 136.853

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 5298.417 μs

======================
Average nn.Linear time: 5339.158 μs
Average a @ b time: 5324.566 μs
Average bmm time: 8330.548 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.008
Speedup (a @ b / grouped_gemm): 1.005
Speedup (bmm / grouped_gemm): 1.572

======================
TFLOPS (grouped_gemm): 226.959
TFLOPS (nn.Linear): 225.227
TFLOPS (a @ b): 225.844
TFLOPS (bmm): 144.351

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 7107.74 MB
Max memory reserved: 9654.00 MB
Average grouped_gemm time: 8164.918 μs

======================
Average nn.Linear time: 8184.259 μs
Average a @ b time: 8161.726 μs
Average bmm time: 18713.591 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.002
Speedup (a @ b / grouped_gemm): 1.000
Speedup (bmm / grouped_gemm): 2.292

======================
TFLOPS (grouped_gemm): 221.120
TFLOPS (nn.Linear): 220.598
TFLOPS (a @ b): 221.207
TFLOPS (bmm): 96.477

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 13134.00 MB
Average grouped_gemm time: 17685.344 μs

======================
Average nn.Linear time: 16690.457 μs
Average a @ b time: 16658.835 μs
Average bmm time: 74846.697 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.944
Speedup (a @ b / grouped_gemm): 0.942
Speedup (bmm / grouped_gemm): 4.232

======================
TFLOPS (grouped_gemm): 214.596
TFLOPS (nn.Linear): 227.388
TFLOPS (a @ b): 227.820
TFLOPS (bmm): 50.706

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 13134.00 MB
Average grouped_gemm time: 125.661 μs

======================
Average nn.Linear time: 295.489 μs
Average a @ b time: 164.394 μs
Average bmm time: 91.841 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.351
Speedup (a @ b / grouped_gemm): 1.308
Speedup (bmm / grouped_gemm): 0.731

======================
TFLOPS (grouped_gemm): 34.011
TFLOPS (nn.Linear): 14.463
TFLOPS (a @ b): 25.997
TFLOPS (bmm): 46.535

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 13134.00 MB
Average grouped_gemm time: 173.862 μs

======================
Average nn.Linear time: 303.268 μs
Average a @ b time: 207.479 μs
Average bmm time: 160.263 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.744
Speedup (a @ b / grouped_gemm): 1.193
Speedup (bmm / grouped_gemm): 0.922

======================
TFLOPS (grouped_gemm): 53.705
TFLOPS (nn.Linear): 30.789
TFLOPS (a @ b): 45.004
TFLOPS (bmm): 58.263

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 13134.00 MB
Average grouped_gemm time: 255.029 μs

======================
Average nn.Linear time: 326.552 μs
Average a @ b time: 316.961 μs
Average bmm time: 281.789 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.280
Speedup (a @ b / grouped_gemm): 1.243
Speedup (bmm / grouped_gemm): 1.105

======================
TFLOPS (grouped_gemm): 70.808
TFLOPS (nn.Linear): 55.299
TFLOPS (a @ b): 56.973
TFLOPS (bmm): 64.084

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 13134.00 MB
Average grouped_gemm time: 314.157 μs

======================
Average nn.Linear time: 385.165 μs
Average a @ b time: 376.179 μs
Average bmm time: 434.806 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.226
Speedup (a @ b / grouped_gemm): 1.197
Speedup (bmm / grouped_gemm): 1.384

======================
TFLOPS (grouped_gemm): 79.240
TFLOPS (nn.Linear): 64.631
TFLOPS (a @ b): 66.175
TFLOPS (bmm): 57.252

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 13134.00 MB
Average grouped_gemm time: 776.870 μs

======================
Average nn.Linear time: 895.674 μs
Average a @ b time: 907.016 μs
Average bmm time: 1042.933 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.153
Speedup (a @ b / grouped_gemm): 1.168
Speedup (bmm / grouped_gemm): 1.342

======================
TFLOPS (grouped_gemm): 98.731
TFLOPS (nn.Linear): 85.635
TFLOPS (a @ b): 84.564
TFLOPS (bmm): 73.544

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 13134.00 MB
Average grouped_gemm time: 1149.361 μs

======================
Average nn.Linear time: 1315.126 μs
Average a @ b time: 1339.934 μs
Average bmm time: 1754.622 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.144
Speedup (a @ b / grouped_gemm): 1.166
Speedup (bmm / grouped_gemm): 1.527

======================
TFLOPS (grouped_gemm): 101.559
TFLOPS (nn.Linear): 88.758
TFLOPS (a @ b): 87.114
TFLOPS (bmm): 66.526

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 19570.00 MB
Average grouped_gemm time: 1742.435 μs

======================
Average nn.Linear time: 1886.556 μs
Average a @ b time: 1912.441 μs
Average bmm time: 4098.456 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.083
Speedup (a @ b / grouped_gemm): 1.098
Speedup (bmm / grouped_gemm): 2.352

======================
TFLOPS (grouped_gemm): 101.315
TFLOPS (nn.Linear): 93.575
TFLOPS (a @ b): 92.309
TFLOPS (bmm): 43.074

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 19570.00 MB
Average grouped_gemm time: 203.853 μs

======================
Average nn.Linear time: 307.047 μs
Average a @ b time: 277.236 μs
Average bmm time: 235.519 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.506
Speedup (a @ b / grouped_gemm): 1.360
Speedup (bmm / grouped_gemm): 1.155

======================
TFLOPS (grouped_gemm): 120.139
TFLOPS (nn.Linear): 79.762
TFLOPS (a @ b): 88.339
TFLOPS (bmm): 103.986

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 19570.00 MB
Average grouped_gemm time: 299.633 μs

======================
Average nn.Linear time: 404.189 μs
Average a @ b time: 400.302 μs
Average bmm time: 386.817 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.349
Speedup (a @ b / grouped_gemm): 1.336
Speedup (bmm / grouped_gemm): 1.291

======================
TFLOPS (grouped_gemm): 156.697
TFLOPS (nn.Linear): 116.163
TFLOPS (a @ b): 117.290
TFLOPS (bmm): 121.379

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 19570.00 MB
Average grouped_gemm time: 543.506 μs

======================
Average nn.Linear time: 636.611 μs
Average a @ b time: 623.338 μs
Average bmm time: 852.287 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.171
Speedup (a @ b / grouped_gemm): 1.147
Speedup (bmm / grouped_gemm): 1.568

======================
TFLOPS (grouped_gemm): 176.853
TFLOPS (nn.Linear): 150.988
TFLOPS (a @ b): 154.203
TFLOPS (bmm): 112.780

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 19570.00 MB
Average grouped_gemm time: 932.302 μs

======================
Average nn.Linear time: 965.226 μs
Average a @ b time: 959.902 μs
Average bmm time: 1631.267 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.035
Speedup (a @ b / grouped_gemm): 1.030
Speedup (bmm / grouped_gemm): 1.750

======================
TFLOPS (grouped_gemm): 191.335
TFLOPS (nn.Linear): 184.808
TFLOPS (a @ b): 185.833
TFLOPS (bmm): 109.352

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 19570.00 MB
Average grouped_gemm time: 2646.983 μs

======================
Average nn.Linear time: 2572.529 μs
Average a @ b time: 2589.605 μs
Average bmm time: 3459.880 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.972
Speedup (a @ b / grouped_gemm): 0.978
Speedup (bmm / grouped_gemm): 1.307

======================
TFLOPS (grouped_gemm): 201.791
TFLOPS (nn.Linear): 207.632
TFLOPS (a @ b): 206.262
TFLOPS (bmm): 154.381

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 10584.03 MB
Max memory reserved: 19570.00 MB
Average grouped_gemm time: 3917.387 μs

======================
Average nn.Linear time: 3747.637 μs
Average a @ b time: 3789.222 μs
Average bmm time: 6613.586 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.957
Speedup (a @ b / grouped_gemm): 0.967
Speedup (bmm / grouped_gemm): 1.688

======================
TFLOPS (grouped_gemm): 200.003
TFLOPS (nn.Linear): 209.062
TFLOPS (a @ b): 206.767
TFLOPS (bmm): 118.466

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 13420.54 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 7342.782 μs

======================
Average nn.Linear time: 6827.719 μs
Average a @ b time: 6851.420 μs
Average bmm time: 12016.525 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.930
Speedup (a @ b / grouped_gemm): 0.933
Speedup (bmm / grouped_gemm): 1.637

======================
TFLOPS (grouped_gemm): 197.125
TFLOPS (nn.Linear): 211.996
TFLOPS (a @ b): 211.262
TFLOPS (bmm): 120.455

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 13420.54 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 662.949 μs

======================
Average nn.Linear time: 874.434 μs
Average a @ b time: 846.522 μs
Average bmm time: 1089.046 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.319
Speedup (a @ b / grouped_gemm): 1.277
Speedup (bmm / grouped_gemm): 1.643

======================
TFLOPS (grouped_gemm): 200.618
TFLOPS (nn.Linear): 152.098
TFLOPS (a @ b): 157.113
TFLOPS (bmm): 122.125

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 13420.54 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 1593.606 μs

======================
Average nn.Linear time: 1719.387 μs
Average a @ b time: 1709.628 μs
Average bmm time: 2161.760 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.079
Speedup (a @ b / grouped_gemm): 1.073
Speedup (bmm / grouped_gemm): 1.357

======================
TFLOPS (grouped_gemm): 213.720
TFLOPS (nn.Linear): 198.086
TFLOPS (a @ b): 199.216
TFLOPS (bmm): 157.550

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 13420.54 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 2068.136 μs

======================
Average nn.Linear time: 2262.297 μs
Average a @ b time: 2240.720 μs
Average bmm time: 3901.424 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.094
Speedup (a @ b / grouped_gemm): 1.083
Speedup (bmm / grouped_gemm): 1.886

======================
TFLOPS (grouped_gemm): 224.162
TFLOPS (nn.Linear): 204.923
TFLOPS (a @ b): 206.896
TFLOPS (bmm): 118.827

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 13420.54 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 4576.631 μs

======================
Average nn.Linear time: 4831.266 μs
Average a @ b time: 4817.598 μs
Average bmm time: 8290.379 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.056
Speedup (a @ b / grouped_gemm): 1.053
Speedup (bmm / grouped_gemm): 1.811

======================
TFLOPS (grouped_gemm): 233.584
TFLOPS (nn.Linear): 221.273
TFLOPS (a @ b): 221.901
TFLOPS (bmm): 128.948

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 13420.54 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 8331.716 μs

======================
Average nn.Linear time: 8424.532 μs
Average a @ b time: 8435.240 μs
Average bmm time: 17155.244 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.011
Speedup (a @ b / grouped_gemm): 1.012
Speedup (bmm / grouped_gemm): 2.059

======================
TFLOPS (grouped_gemm): 231.635
TFLOPS (nn.Linear): 229.083
TFLOPS (a @ b): 228.792
TFLOPS (bmm): 112.497

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 13420.54 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 18515.494 μs

======================
Average nn.Linear time: 17669.320 μs
Average a @ b time: 17677.293 μs
Average bmm time: 42284.644 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.954
Speedup (a @ b / grouped_gemm): 0.955
Speedup (bmm / grouped_gemm): 2.284

======================
TFLOPS (grouped_gemm): 226.493
TFLOPS (nn.Linear): 237.340
TFLOPS (a @ b): 237.233
TFLOPS (bmm): 99.176

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 16592.70 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 33803.747 μs

======================
Average nn.Linear time: 32343.113 μs
Average a @ b time: 32350.185 μs
Average bmm time: 135179.396 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.957
Speedup (a @ b / grouped_gemm): 0.957
Speedup (bmm / grouped_gemm): 3.999

======================
TFLOPS (grouped_gemm): 219.655
TFLOPS (nn.Linear): 229.575
TFLOPS (a @ b): 229.525
TFLOPS (bmm): 54.928

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 16592.70 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 161.693 μs

======================
Average nn.Linear time: 307.593 μs
Average a @ b time: 195.408 μs
Average bmm time: 144.465 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.902
Speedup (a @ b / grouped_gemm): 1.209
Speedup (bmm / grouped_gemm): 0.893

======================
TFLOPS (grouped_gemm): 47.902
TFLOPS (nn.Linear): 25.181
TFLOPS (a @ b): 39.637
TFLOPS (bmm): 53.615

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 16592.70 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 215.480 μs

======================
Average nn.Linear time: 304.165 μs
Average a @ b time: 247.076 μs
Average bmm time: 285.881 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.412
Speedup (a @ b / grouped_gemm): 1.147
Speedup (bmm / grouped_gemm): 1.327

======================
TFLOPS (grouped_gemm): 65.546
TFLOPS (nn.Linear): 46.435
TFLOPS (a @ b): 57.164
TFLOPS (bmm): 49.405

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 16592.70 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 402.074 μs

======================
Average nn.Linear time: 458.047 μs
Average a @ b time: 456.877 μs
Average bmm time: 521.655 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.139
Speedup (a @ b / grouped_gemm): 1.136
Speedup (bmm / grouped_gemm): 1.297

======================
TFLOPS (grouped_gemm): 86.552
TFLOPS (nn.Linear): 75.975
TFLOPS (a @ b): 76.170
TFLOPS (bmm): 66.711

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 16592.70 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 573.759 μs

======================
Average nn.Linear time: 666.738 μs
Average a @ b time: 666.733 μs
Average bmm time: 1070.316 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.162
Speedup (a @ b / grouped_gemm): 1.162
Speedup (bmm / grouped_gemm): 1.865

======================
TFLOPS (grouped_gemm): 94.104
TFLOPS (nn.Linear): 80.981
TFLOPS (a @ b): 80.981
TFLOPS (bmm): 50.446

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 16592.70 MB
Max memory reserved: 26610.00 MB
Average grouped_gemm time: 1287.799 μs

======================
Average nn.Linear time: 1478.190 μs
Average a @ b time: 1476.359 μs
Average bmm time: 2136.705 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.148
Speedup (a @ b / grouped_gemm): 1.146
Speedup (bmm / grouped_gemm): 1.659

======================
TFLOPS (grouped_gemm): 103.457
TFLOPS (nn.Linear): 90.132
TFLOPS (a @ b): 90.244
TFLOPS (bmm): 62.354

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 16592.70 MB
Max memory reserved: 34482.00 MB
Average grouped_gemm time: 2842.350 μs

======================
Average nn.Linear time: 3248.677 μs
Average a @ b time: 3332.119 μs
Average bmm time: 4324.803 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.143
Speedup (a @ b / grouped_gemm): 1.172
Speedup (bmm / grouped_gemm): 1.522

======================
TFLOPS (grouped_gemm): 107.580
TFLOPS (nn.Linear): 94.124
TFLOPS (a @ b): 91.767
TFLOPS (bmm): 70.704

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 23048.59 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 4161.997 μs

======================
Average nn.Linear time: 4454.062 μs
Average a @ b time: 4463.930 μs
Average bmm time: 8236.799 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.070
Speedup (a @ b / grouped_gemm): 1.073
Speedup (bmm / grouped_gemm): 1.979

======================
TFLOPS (grouped_gemm): 105.590
TFLOPS (nn.Linear): 98.666
TFLOPS (a @ b): 98.448
TFLOPS (bmm): 53.354

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 23048.59 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 303.876 μs

======================
Average nn.Linear time: 394.094 μs
Average a @ b time: 382.099 μs
Average bmm time: 368.204 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.297
Speedup (a @ b / grouped_gemm): 1.257
Speedup (bmm / grouped_gemm): 1.212

======================
TFLOPS (grouped_gemm): 154.111
TFLOPS (nn.Linear): 118.832
TFLOPS (a @ b): 122.562
TFLOPS (bmm): 127.187

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 23048.59 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 583.823 μs

======================
Average nn.Linear time: 661.106 μs
Average a @ b time: 650.187 μs
Average bmm time: 774.932 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.132
Speedup (a @ b / grouped_gemm): 1.114
Speedup (bmm / grouped_gemm): 1.327

======================
TFLOPS (grouped_gemm): 179.886
TFLOPS (nn.Linear): 158.858
TFLOPS (a @ b): 161.525
TFLOPS (bmm): 135.524

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 23048.59 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 1255.524 μs

======================
Average nn.Linear time: 1360.424 μs
Average a @ b time: 1341.219 μs
Average bmm time: 1744.077 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.084
Speedup (a @ b / grouped_gemm): 1.068
Speedup (bmm / grouped_gemm): 1.389

======================
TFLOPS (grouped_gemm): 195.259
TFLOPS (nn.Linear): 180.203
TFLOPS (a @ b): 182.784
TFLOPS (bmm): 140.563

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 23048.59 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 2244.539 μs

======================
Average nn.Linear time: 2234.542 μs
Average a @ b time: 2224.953 μs
Average bmm time: 3386.424 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.996
Speedup (a @ b / grouped_gemm): 0.991
Speedup (bmm / grouped_gemm): 1.509

======================
TFLOPS (grouped_gemm): 202.334
TFLOPS (nn.Linear): 203.239
TFLOPS (a @ b): 204.115
TFLOPS (bmm): 134.108

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 23048.59 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 4526.131 μs

======================
Average nn.Linear time: 4378.705 μs
Average a @ b time: 4349.222 μs
Average bmm time: 6546.896 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.967
Speedup (a @ b / grouped_gemm): 0.961
Speedup (bmm / grouped_gemm): 1.446

======================
TFLOPS (grouped_gemm): 205.948
TFLOPS (nn.Linear): 212.882
TFLOPS (a @ b): 214.325
TFLOPS (bmm): 142.380

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 23048.59 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 7611.516 μs

======================
Average nn.Linear time: 7205.377 μs
Average a @ b time: 7227.027 μs
Average bmm time: 13359.084 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.947
Speedup (a @ b / grouped_gemm): 0.949
Speedup (bmm / grouped_gemm): 1.755

======================
TFLOPS (grouped_gemm): 204.398
TFLOPS (nn.Linear): 215.919
TFLOPS (a @ b): 215.272
TFLOPS (bmm): 116.458

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 23141.01 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 14050.159 μs

======================
Average nn.Linear time: 13059.945 μs
Average a @ b time: 13085.027 μs
Average bmm time: 29621.916 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.930
Speedup (a @ b / grouped_gemm): 0.931
Speedup (bmm / grouped_gemm): 2.108

======================
TFLOPS (grouped_gemm): 199.884
TFLOPS (nn.Linear): 215.039
TFLOPS (a @ b): 214.627
TFLOPS (bmm): 94.808

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 23141.01 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 1207.190 μs

======================
Average nn.Linear time: 1491.969 μs
Average a @ b time: 1444.247 μs
Average bmm time: 2205.675 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.236
Speedup (a @ b / grouped_gemm): 1.196
Speedup (bmm / grouped_gemm): 1.827

======================
TFLOPS (grouped_gemm): 210.672
TFLOPS (nn.Linear): 170.460
TFLOPS (a @ b): 176.093
TFLOPS (bmm): 115.303

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 23141.01 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 2223.599 μs

======================
Average nn.Linear time: 2411.730 μs
Average a @ b time: 2408.299 μs
Average bmm time: 3906.505 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.085
Speedup (a @ b / grouped_gemm): 1.083
Speedup (bmm / grouped_gemm): 1.757

======================
TFLOPS (grouped_gemm): 221.299
TFLOPS (nn.Linear): 204.036
TFLOPS (a @ b): 204.327
TFLOPS (bmm): 125.964

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 23141.01 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 3662.381 μs

======================
Average nn.Linear time: 3952.866 μs
Average a @ b time: 3908.830 μs
Average bmm time: 8031.240 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.079
Speedup (a @ b / grouped_gemm): 1.067
Speedup (bmm / grouped_gemm): 2.193

======================
TFLOPS (grouped_gemm): 231.826
TFLOPS (nn.Linear): 214.790
TFLOPS (a @ b): 217.210
TFLOPS (bmm): 105.717

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 23141.01 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 9937.115 μs

======================
Average nn.Linear time: 10035.205 μs
Average a @ b time: 10035.160 μs
Average bmm time: 16727.180 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.010
Speedup (a @ b / grouped_gemm): 1.010
Speedup (bmm / grouped_gemm): 1.683

======================
TFLOPS (grouped_gemm): 236.712
TFLOPS (nn.Linear): 234.398
TFLOPS (a @ b): 234.399
TFLOPS (bmm): 140.623

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 23141.01 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 19498.935 μs

======================
Average nn.Linear time: 19253.099 μs
Average a @ b time: 19266.493 μs
Average bmm time: 32177.746 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.987
Speedup (a @ b / grouped_gemm): 0.988
Speedup (bmm / grouped_gemm): 1.650

======================
TFLOPS (grouped_gemm): 235.608
TFLOPS (nn.Linear): 238.616
TFLOPS (a @ b): 238.451
TFLOPS (bmm): 142.773

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 23141.01 MB
Max memory reserved: 47494.00 MB
Average grouped_gemm time: 38948.412 μs

======================
Average nn.Linear time: 37055.790 μs
Average a @ b time: 37071.071 μs
Average bmm time: 82252.085 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.951
Speedup (a @ b / grouped_gemm): 0.952
Speedup (bmm / grouped_gemm): 2.112

======================
TFLOPS (grouped_gemm): 231.407
TFLOPS (nn.Linear): 243.226
TFLOPS (a @ b): 243.125
TFLOPS (bmm): 109.577

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 30355.93 MB
Max memory reserved: 61198.00 MB
Average grouped_gemm time: 65239.441 μs

======================
Average nn.Linear time: 61965.723 μs
Average a @ b time: 61896.753 μs
Average bmm time: 293659.730 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.950
Speedup (a @ b / grouped_gemm): 0.949
Speedup (bmm / grouped_gemm): 4.501

======================
TFLOPS (grouped_gemm): 220.147
TFLOPS (nn.Linear): 231.778
TFLOPS (a @ b): 232.036
TFLOPS (bmm): 48.908

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 30355.93 MB
Max memory reserved: 61198.00 MB
Average grouped_gemm time: 231.838 μs

======================
Average nn.Linear time: 299.118 μs
Average a @ b time: 268.626 μs
Average bmm time: 295.017 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.290
Speedup (a @ b / grouped_gemm): 1.159
Speedup (bmm / grouped_gemm): 1.273

======================
TFLOPS (grouped_gemm): 65.039
TFLOPS (nn.Linear): 50.410
TFLOPS (a @ b): 56.132
TFLOPS (bmm): 51.111

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 30355.93 MB
Max memory reserved: 61198.00 MB
Average grouped_gemm time: 355.570 μs

======================
Average nn.Linear time: 425.739 μs
Average a @ b time: 420.430 μs
Average bmm time: 443.225 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.197
Speedup (a @ b / grouped_gemm): 1.182
Speedup (bmm / grouped_gemm): 1.247

======================
TFLOPS (grouped_gemm): 82.733
TFLOPS (nn.Linear): 69.097
TFLOPS (a @ b): 69.970
TFLOPS (bmm): 66.371

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 30355.93 MB
Max memory reserved: 61198.00 MB
Average grouped_gemm time: 947.568 μs

======================
Average nn.Linear time: 1088.603 μs
Average a @ b time: 1100.833 μs
Average bmm time: 1061.215 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.149
Speedup (a @ b / grouped_gemm): 1.162
Speedup (bmm / grouped_gemm): 1.120

======================
TFLOPS (grouped_gemm): 99.175
TFLOPS (nn.Linear): 86.326
TFLOPS (a @ b): 85.367
TFLOPS (bmm): 88.554

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 30355.93 MB
Max memory reserved: 61198.00 MB
Average grouped_gemm time: 1355.493 μs

======================
Average nn.Linear time: 1598.418 μs
Average a @ b time: 1599.326 μs
Average bmm time: 2102.635 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.179
Speedup (a @ b / grouped_gemm): 1.180
Speedup (bmm / grouped_gemm): 1.551

======================
TFLOPS (grouped_gemm): 105.082
TFLOPS (nn.Linear): 89.112
TFLOPS (a @ b): 89.061
TFLOPS (bmm): 67.742

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 30355.93 MB
Max memory reserved: 61198.00 MB
Average grouped_gemm time: 2593.868 μs

======================
Average nn.Linear time: 2955.322 μs
Average a @ b time: 2984.400 μs
Average bmm time: 4031.353 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.139
Speedup (a @ b / grouped_gemm): 1.151
Speedup (bmm / grouped_gemm): 1.554

======================
TFLOPS (grouped_gemm): 107.506
TFLOPS (nn.Linear): 94.358
TFLOPS (a @ b): 93.438
TFLOPS (bmm): 69.172

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 30355.93 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 5580.158 μs

======================
Average nn.Linear time: 6266.956 μs
Average a @ b time: 6319.301 μs
Average bmm time: 8775.723 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.123
Speedup (a @ b / grouped_gemm): 1.132
Speedup (bmm / grouped_gemm): 1.573

======================
TFLOPS (grouped_gemm): 108.422
TFLOPS (nn.Linear): 96.540
TFLOPS (a @ b): 95.740
TFLOPS (bmm): 68.941

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 10713.842 μs

======================
Average nn.Linear time: 11502.807 μs
Average a @ b time: 11511.254 μs
Average bmm time: 17396.674 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.074
Speedup (a @ b / grouped_gemm): 1.074
Speedup (bmm / grouped_gemm): 1.624

======================
TFLOPS (grouped_gemm): 106.920
TFLOPS (nn.Linear): 99.587
TFLOPS (a @ b): 99.514
TFLOPS (bmm): 65.847

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 623.701 μs

======================
Average nn.Linear time: 746.343 μs
Average a @ b time: 718.644 μs
Average bmm time: 832.045 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.197
Speedup (a @ b / grouped_gemm): 1.152
Speedup (bmm / grouped_gemm): 1.334

======================
TFLOPS (grouped_gemm): 175.802
TFLOPS (nn.Linear): 146.914
TFLOPS (a @ b): 152.576
TFLOPS (bmm): 131.781

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 962.441 μs

======================
Average nn.Linear time: 1038.549 μs
Average a @ b time: 1029.687 μs
Average bmm time: 1601.324 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.079
Speedup (a @ b / grouped_gemm): 1.070
Speedup (bmm / grouped_gemm): 1.664

======================
TFLOPS (grouped_gemm): 188.654
TFLOPS (nn.Linear): 174.829
TFLOPS (a @ b): 176.333
TFLOPS (bmm): 113.386

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 2037.094 μs

======================
Average nn.Linear time: 2160.690 μs
Average a @ b time: 2131.412 μs
Average bmm time: 3147.247 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.061
Speedup (a @ b / grouped_gemm): 1.046
Speedup (bmm / grouped_gemm): 1.545

======================
TFLOPS (grouped_gemm): 199.650
TFLOPS (nn.Linear): 188.229
TFLOPS (a @ b): 190.815
TFLOPS (bmm): 129.226

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 4590.852 μs

======================
Average nn.Linear time: 4453.595 μs
Average a @ b time: 4470.761 μs
Average bmm time: 6845.207 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.970
Speedup (a @ b / grouped_gemm): 0.974
Speedup (bmm / grouped_gemm): 1.491

======================
TFLOPS (grouped_gemm): 207.062
TFLOPS (nn.Linear): 213.444
TFLOPS (a @ b): 212.624
TFLOPS (bmm): 138.870

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 8299.890 μs

======================
Average nn.Linear time: 7900.860 μs
Average a @ b time: 7909.079 μs
Average bmm time: 13434.289 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.952
Speedup (a @ b / grouped_gemm): 0.953
Speedup (bmm / grouped_gemm): 1.619

======================
TFLOPS (grouped_gemm): 207.490
TFLOPS (nn.Linear): 217.969
TFLOPS (a @ b): 217.742
TFLOPS (bmm): 128.190

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 16260.836 μs

======================
Average nn.Linear time: 15236.597 μs
Average a @ b time: 15221.422 μs
Average bmm time: 36574.490 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.937
Speedup (a @ b / grouped_gemm): 0.936
Speedup (bmm / grouped_gemm): 2.249

======================
TFLOPS (grouped_gemm): 207.077
TFLOPS (nn.Linear): 220.998
TFLOPS (a @ b): 221.218
TFLOPS (bmm): 92.066

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 30197.139 μs

======================
Average nn.Linear time: 28265.333 μs
Average a @ b time: 28256.462 μs
Average bmm time: 69200.249 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.936
Speedup (a @ b / grouped_gemm): 0.936
Speedup (bmm / grouped_gemm): 2.292

======================
TFLOPS (grouped_gemm): 202.823
TFLOPS (nn.Linear): 216.685
TFLOPS (a @ b): 216.753
TFLOPS (bmm): 88.506

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 2757.468 μs

======================
Average nn.Linear time: 3070.812 μs
Average a @ b time: 3051.732 μs
Average bmm time: 4443.090 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.114
Speedup (a @ b / grouped_gemm): 1.107
Speedup (bmm / grouped_gemm): 1.611

======================
TFLOPS (grouped_gemm): 216.491
TFLOPS (nn.Linear): 194.400
TFLOPS (a @ b): 195.616
TFLOPS (bmm): 134.358

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 4335.959 μs

======================
Average nn.Linear time: 4632.547 μs
Average a @ b time: 4582.708 μs
Average bmm time: 7809.105 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.068
Speedup (a @ b / grouped_gemm): 1.057
Speedup (bmm / grouped_gemm): 1.801

======================
TFLOPS (grouped_gemm): 228.414
TFLOPS (nn.Linear): 213.790
TFLOPS (a @ b): 216.115
TFLOPS (bmm): 126.825

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 9749.050 μs

======================
Average nn.Linear time: 10100.045 μs
Average a @ b time: 10086.517 μs
Average bmm time: 14757.383 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.036
Speedup (a @ b / grouped_gemm): 1.035
Speedup (bmm / grouped_gemm): 1.514

======================
TFLOPS (grouped_gemm): 237.236
TFLOPS (nn.Linear): 228.991
TFLOPS (a @ b): 229.298
TFLOPS (bmm): 156.723

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 23950.121 μs

======================
Average nn.Linear time: 24118.412 μs
Average a @ b time: 24107.769 μs
Average bmm time: 33878.913 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.007
Speedup (a @ b / grouped_gemm): 1.007
Speedup (bmm / grouped_gemm): 1.415

======================
TFLOPS (grouped_gemm): 241.879
TFLOPS (nn.Linear): 240.192
TFLOPS (a @ b): 240.298
TFLOPS (bmm): 170.992

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 43683.355 μs

======================
Average nn.Linear time: 42823.036 μs
Average a @ b time: 42806.129 μs
Average bmm time: 72725.563 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.980
Speedup (a @ b / grouped_gemm): 0.980
Speedup (bmm / grouped_gemm): 1.665

======================
TFLOPS (grouped_gemm): 239.921
TFLOPS (nn.Linear): 244.741
TFLOPS (a @ b): 244.838
TFLOPS (bmm): 144.111

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 53306.86 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 57959.602 μs

======================
Average nn.Linear time: 54250.104 μs
Average a @ b time: 54125.328 μs
Average bmm time: 207321.558 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.936
Speedup (a @ b / grouped_gemm): 0.934
Speedup (bmm / grouped_gemm): 3.577

======================
TFLOPS (grouped_gemm): 229.308
TFLOPS (nn.Linear): 244.987
TFLOPS (a @ b): 245.552
TFLOPS (bmm): 64.106

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 62731.16 MB
Max memory reserved: 77134.00 MB
Average grouped_gemm time: 154144.008 μs

======================
Average nn.Linear time: 146788.926 μs
Average a @ b time: 146840.627 μs
Average bmm time: 613160.701 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.952
Speedup (a @ b / grouped_gemm): 0.953
Speedup (bmm / grouped_gemm): 3.978

======================
TFLOPS (grouped_gemm): 223.637
TFLOPS (nn.Linear): 234.843
TFLOPS (a @ b): 234.760
TFLOPS (bmm): 56.221

--------------------------------------------------

