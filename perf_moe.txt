Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3760.18 MB
Max memory reserved: 4070.00 MB
Average grouped_gemm time: 1919.918 μs

======================
Average nn.Linear time: 1312.916 μs
Average a @ b time: 1305.017 μs
Average bmm time: 1246.090 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.684
Speedup (a @ b / grouped_gemm): 0.680
Speedup (bmm / grouped_gemm): 0.649

======================
TFLOPS (grouped_gemm): 17.739
TFLOPS (nn.Linear): 25.941
TFLOPS (a @ b): 26.098
TFLOPS (bmm): 27.332

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3819.04 MB
Max memory reserved: 4070.00 MB
Average grouped_gemm time: 1914.601 μs

======================
Average nn.Linear time: 1331.506 μs
Average a @ b time: 1321.812 μs
Average bmm time: 1267.629 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.695
Speedup (a @ b / grouped_gemm): 0.690
Speedup (bmm / grouped_gemm): 0.662

======================
TFLOPS (grouped_gemm): 33.491
TFLOPS (nn.Linear): 48.158
TFLOPS (a @ b): 48.511
TFLOPS (bmm): 50.585

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3889.34 MB
Max memory reserved: 4070.00 MB
Average grouped_gemm time: 1955.893 μs

======================
Average nn.Linear time: 1506.774 μs
Average a @ b time: 1497.245 μs
Average bmm time: 1255.696 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.770
Speedup (a @ b / grouped_gemm): 0.766
Speedup (bmm / grouped_gemm): 0.642

======================
TFLOPS (grouped_gemm): 56.322
TFLOPS (nn.Linear): 73.109
TFLOPS (a @ b): 73.575
TFLOPS (bmm): 87.728

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 4140.70 MB
Max memory reserved: 5862.00 MB
Average grouped_gemm time: 2043.970 μs

======================
Average nn.Linear time: 1942.749 μs
Average a @ b time: 1933.987 μs
Average bmm time: 2497.547 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.950
Speedup (a @ b / grouped_gemm): 0.946
Speedup (bmm / grouped_gemm): 1.222

======================
TFLOPS (grouped_gemm): 122.786
TFLOPS (nn.Linear): 129.183
TFLOPS (a @ b): 129.768
TFLOPS (bmm): 100.487

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 4624.20 MB
Max memory reserved: 5862.00 MB
Average grouped_gemm time: 3222.392 μs

======================
Average nn.Linear time: 3398.528 μs
Average a @ b time: 3375.511 μs
Average bmm time: 4945.621 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.055
Speedup (a @ b / grouped_gemm): 1.048
Speedup (bmm / grouped_gemm): 1.535

======================
TFLOPS (grouped_gemm): 170.636
TFLOPS (nn.Linear): 161.793
TFLOPS (a @ b): 162.896
TFLOPS (bmm): 111.180

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 5257.31 MB
Max memory reserved: 5862.00 MB
Average grouped_gemm time: 4185.867 μs

======================
Average nn.Linear time: 4128.952 μs
Average a @ b time: 4117.131 μs
Average bmm time: 9958.940 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.986
Speedup (a @ b / grouped_gemm): 0.984
Speedup (bmm / grouped_gemm): 2.379

======================
TFLOPS (grouped_gemm): 180.908
TFLOPS (nn.Linear): 183.402
TFLOPS (a @ b): 183.928
TFLOPS (bmm): 76.038

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 7435.02 MB
Max memory reserved: 8536.00 MB
Average grouped_gemm time: 9885.960 μs

======================
Average nn.Linear time: 10477.881 μs
Average a @ b time: 10473.850 μs
Average bmm time: 19907.184 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.060
Speedup (a @ b / grouped_gemm): 1.059
Speedup (bmm / grouped_gemm): 2.014

======================
TFLOPS (grouped_gemm): 226.649
TFLOPS (nn.Linear): 213.845
TFLOPS (a @ b): 213.928
TFLOPS (bmm): 112.555

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 10872.98 MB
Max memory reserved: 12084.00 MB
Average grouped_gemm time: 17665.827 μs

======================
Average nn.Linear time: 17917.228 μs
Average a @ b time: 17914.569 μs
Average bmm time: 40100.746 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.014
Speedup (a @ b / grouped_gemm): 1.014
Speedup (bmm / grouped_gemm): 2.270

======================
TFLOPS (grouped_gemm): 230.310
TFLOPS (nn.Linear): 227.078
TFLOPS (a @ b): 227.112
TFLOPS (bmm): 101.460

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 16386.85 MB
Max memory reserved: 19120.00 MB
Average grouped_gemm time: 26181.669 μs

======================
Average nn.Linear time: 26319.230 μs
Average a @ b time: 26304.913 μs
Average bmm time: 78487.816 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.005
Speedup (a @ b / grouped_gemm): 1.005
Speedup (bmm / grouped_gemm): 2.998

======================
TFLOPS (grouped_gemm): 231.632
TFLOPS (nn.Linear): 230.421
TFLOPS (a @ b): 230.547
TFLOPS (bmm): 77.267

--------------------------------------------------

Parameters: batch_size=1, sequence_length=12288, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 22171.09 MB
Max memory reserved: 29160.00 MB
Average grouped_gemm time: 38830.194 μs

======================
Average nn.Linear time: 39474.297 μs
Average a @ b time: 39451.485 μs
Average bmm time: 112181.728 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.017
Speedup (a @ b / grouped_gemm): 1.016
Speedup (bmm / grouped_gemm): 2.889

======================
TFLOPS (grouped_gemm): 235.300
TFLOPS (nn.Linear): 231.461
TFLOPS (a @ b): 231.595
TFLOPS (bmm): 81.446

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 33814.00 MB
Max memory reserved: 43140.00 MB
Average grouped_gemm time: 77530.611 μs

======================
Average nn.Linear time: 79389.739 μs
Average a @ b time: 79368.751 μs
Average bmm time: 155162.725 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.024
Speedup (a @ b / grouped_gemm): 1.024
Speedup (bmm / grouped_gemm): 2.001

======================
TFLOPS (grouped_gemm): 238.280
TFLOPS (nn.Linear): 232.700
TFLOPS (a @ b): 232.761
TFLOPS (bmm): 119.062

--------------------------------------------------

Parameters: batch_size=1, sequence_length=20480, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 37983.20 MB
Max memory reserved: 60764.00 MB
Average grouped_gemm time: 79936.433 μs

======================
Average nn.Linear time: 79357.200 μs
Average a @ b time: 79419.441 μs
Average bmm time: 378042.097 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.993
Speedup (a @ b / grouped_gemm): 0.994
Speedup (bmm / grouped_gemm): 4.729

======================
TFLOPS (grouped_gemm): 231.208
TFLOPS (nn.Linear): 232.896
TFLOPS (a @ b): 232.713
TFLOPS (bmm): 48.889

--------------------------------------------------

Parameters: batch_size=1, sequence_length=24576, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 37983.20 MB
Max memory reserved: 78972.00 MB
Average grouped_gemm time: 69955.933 μs

======================
Average nn.Linear time: 70657.091 μs
Average a @ b time: 70622.783 μs
Average bmm time: 202891.352 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.010
Speedup (a @ b / grouped_gemm): 1.010
Speedup (bmm / grouped_gemm): 2.900

======================
TFLOPS (grouped_gemm): 235.012
TFLOPS (nn.Linear): 232.680
TFLOPS (a @ b): 232.793
TFLOPS (bmm): 81.031

--------------------------------------------------

Parameters: batch_size=1, sequence_length=28672, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 56800.91 MB
Max memory reserved: 78972.00 MB
Average grouped_gemm time: 140869.937 μs

======================
Average nn.Linear time: 141087.058 μs
Average a @ b time: 141160.483 μs
Average bmm time: 522397.776 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.002
Speedup (a @ b / grouped_gemm): 1.002
Speedup (bmm / grouped_gemm): 3.708

======================
TFLOPS (grouped_gemm): 234.734
TFLOPS (nn.Linear): 234.372
TFLOPS (a @ b): 234.250
TFLOPS (bmm): 63.298

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 57669.20 MB
Max memory reserved: 78972.00 MB
Average grouped_gemm time: 123434.751 μs

======================
Average nn.Linear time: 122217.135 μs
Average a @ b time: 122211.304 μs
Average bmm time: 603623.595 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.990
Speedup (a @ b / grouped_gemm): 0.990
Speedup (bmm / grouped_gemm): 4.890

======================
TFLOPS (grouped_gemm): 231.052
TFLOPS (nn.Linear): 233.354
TFLOPS (a @ b): 233.365
TFLOPS (bmm): 47.248

--------------------------------------------------

