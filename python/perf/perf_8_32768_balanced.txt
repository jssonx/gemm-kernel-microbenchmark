Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 9.94 MB
Max memory reserved: 22.00 MB
Average grouped_gemm time: 69.013 μs

======================
Average nn.Linear time: 150.626 μs
Average a @ b time: 81.851 μs
Average bmm time: 19.360 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.183
Speedup (a @ b / grouped_gemm): 1.186
Speedup (bmm / grouped_gemm): 0.281

======================
TFLOPS (grouped_gemm): 0.243
TFLOPS (nn.Linear): 0.111
TFLOPS (a @ b): 0.205
TFLOPS (bmm): 0.867

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 11.62 MB
Max memory reserved: 24.00 MB
Average grouped_gemm time: 69.027 μs

======================
Average nn.Linear time: 184.059 μs
Average a @ b time: 107.830 μs
Average bmm time: 20.695 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.666
Speedup (a @ b / grouped_gemm): 1.562
Speedup (bmm / grouped_gemm): 0.300

======================
TFLOPS (grouped_gemm): 0.486
TFLOPS (nn.Linear): 0.182
TFLOPS (a @ b): 0.311
TFLOPS (bmm): 1.621

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 15.00 MB
Max memory reserved: 26.00 MB
Average grouped_gemm time: 68.476 μs

======================
Average nn.Linear time: 183.744 μs
Average a @ b time: 105.624 μs
Average bmm time: 21.989 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.683
Speedup (a @ b / grouped_gemm): 1.542
Speedup (bmm / grouped_gemm): 0.321

======================
TFLOPS (grouped_gemm): 0.980
TFLOPS (nn.Linear): 0.365
TFLOPS (a @ b): 0.635
TFLOPS (bmm): 3.052

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 21.75 MB
Max memory reserved: 32.00 MB
Average grouped_gemm time: 67.251 μs

======================
Average nn.Linear time: 184.758 μs
Average a @ b time: 107.419 μs
Average bmm time: 23.305 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.747
Speedup (a @ b / grouped_gemm): 1.597
Speedup (bmm / grouped_gemm): 0.347

======================
TFLOPS (grouped_gemm): 1.996
TFLOPS (nn.Linear): 0.726
TFLOPS (a @ b): 1.249
TFLOPS (bmm): 5.759

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 35.25 MB
Max memory reserved: 58.00 MB
Average grouped_gemm time: 83.055 μs

======================
Average nn.Linear time: 152.192 μs
Average a @ b time: 82.803 μs
Average bmm time: 27.874 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.832
Speedup (a @ b / grouped_gemm): 0.997
Speedup (bmm / grouped_gemm): 0.336

======================
TFLOPS (grouped_gemm): 3.232
TFLOPS (nn.Linear): 1.764
TFLOPS (a @ b): 3.242
TFLOPS (bmm): 9.630

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 62.25 MB
Max memory reserved: 74.00 MB
Average grouped_gemm time: 98.302 μs

======================
Average nn.Linear time: 150.008 μs
Average a @ b time: 82.755 μs
Average bmm time: 34.118 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.526
Speedup (a @ b / grouped_gemm): 0.842
Speedup (bmm / grouped_gemm): 0.347

======================
TFLOPS (grouped_gemm): 5.461
TFLOPS (nn.Linear): 3.579
TFLOPS (a @ b): 6.487
TFLOPS (bmm): 15.736

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 102.75 MB
Max memory reserved: 136.00 MB
Average grouped_gemm time: 132.072 μs

======================
Average nn.Linear time: 154.316 μs
Average a @ b time: 94.206 μs
Average bmm time: 53.306 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.168
Speedup (a @ b / grouped_gemm): 0.713
Speedup (bmm / grouped_gemm): 0.404

======================
TFLOPS (grouped_gemm): 7.114
TFLOPS (nn.Linear): 6.088
TFLOPS (a @ b): 9.973
TFLOPS (bmm): 17.625

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 102.75 MB
Max memory reserved: 136.00 MB
Average grouped_gemm time: 103.016 μs

======================
Average nn.Linear time: 185.630 μs
Average a @ b time: 109.134 μs
Average bmm time: 23.031 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.802
Speedup (a @ b / grouped_gemm): 1.059
Speedup (bmm / grouped_gemm): 0.224

======================
TFLOPS (grouped_gemm): 0.977
TFLOPS (nn.Linear): 0.542
TFLOPS (a @ b): 0.922
TFLOPS (bmm): 4.371

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 102.75 MB
Max memory reserved: 136.00 MB
Average grouped_gemm time: 104.549 μs

======================
Average nn.Linear time: 185.180 μs
Average a @ b time: 108.771 μs
Average bmm time: 23.608 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.771
Speedup (a @ b / grouped_gemm): 1.040
Speedup (bmm / grouped_gemm): 0.226

======================
TFLOPS (grouped_gemm): 1.926
TFLOPS (nn.Linear): 1.087
TFLOPS (a @ b): 1.851
TFLOPS (bmm): 8.528

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 102.75 MB
Max memory reserved: 136.00 MB
Average grouped_gemm time: 104.189 μs

======================
Average nn.Linear time: 145.831 μs
Average a @ b time: 81.680 μs
Average bmm time: 25.735 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.400
Speedup (a @ b / grouped_gemm): 0.784
Speedup (bmm / grouped_gemm): 0.247

======================
TFLOPS (grouped_gemm): 3.865
TFLOPS (nn.Linear): 2.761
TFLOPS (a @ b): 4.930
TFLOPS (bmm): 15.646

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 102.75 MB
Max memory reserved: 136.00 MB
Average grouped_gemm time: 95.198 μs

======================
Average nn.Linear time: 149.119 μs
Average a @ b time: 84.922 μs
Average bmm time: 33.777 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.566
Speedup (a @ b / grouped_gemm): 0.892
Speedup (bmm / grouped_gemm): 0.355

======================
TFLOPS (grouped_gemm): 8.459
TFLOPS (nn.Linear): 5.400
TFLOPS (a @ b): 9.483
TFLOPS (bmm): 23.842

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 120.88 MB
Max memory reserved: 184.00 MB
Average grouped_gemm time: 140.250 μs

======================
Average nn.Linear time: 145.602 μs
Average a @ b time: 90.523 μs
Average bmm time: 55.640 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.038
Speedup (a @ b / grouped_gemm): 0.645
Speedup (bmm / grouped_gemm): 0.397

======================
TFLOPS (grouped_gemm): 11.484
TFLOPS (nn.Linear): 11.062
TFLOPS (a @ b): 17.792
TFLOPS (bmm): 28.947

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 232.88 MB
Max memory reserved: 316.00 MB
Average grouped_gemm time: 184.588 μs

======================
Average nn.Linear time: 153.832 μs
Average a @ b time: 218.251 μs
Average bmm time: 86.501 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.833
Speedup (a @ b / grouped_gemm): 1.182
Speedup (bmm / grouped_gemm): 0.469

======================
TFLOPS (grouped_gemm): 17.451
TFLOPS (nn.Linear): 20.940
TFLOPS (a @ b): 14.759
TFLOPS (bmm): 37.239

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 401.88 MB
Max memory reserved: 572.00 MB
Average grouped_gemm time: 270.746 μs

======================
Average nn.Linear time: 152.314 μs
Average a @ b time: 192.738 μs
Average bmm time: 152.204 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.563
Speedup (a @ b / grouped_gemm): 0.712
Speedup (bmm / grouped_gemm): 0.562

======================
TFLOPS (grouped_gemm): 20.821
TFLOPS (nn.Linear): 37.010
TFLOPS (a @ b): 29.248
TFLOPS (bmm): 37.037

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 401.88 MB
Max memory reserved: 572.00 MB
Average grouped_gemm time: 248.492 μs

======================
Average nn.Linear time: 173.512 μs
Average a @ b time: 103.173 μs
Average bmm time: 33.026 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.698
Speedup (a @ b / grouped_gemm): 0.415
Speedup (bmm / grouped_gemm): 0.133

======================
TFLOPS (grouped_gemm): 2.161
TFLOPS (nn.Linear): 3.094
TFLOPS (a @ b): 5.204
TFLOPS (bmm): 16.256

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 401.88 MB
Max memory reserved: 572.00 MB
Average grouped_gemm time: 249.591 μs

======================
Average nn.Linear time: 174.108 μs
Average a @ b time: 103.874 μs
Average bmm time: 39.501 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.698
Speedup (a @ b / grouped_gemm): 0.416
Speedup (bmm / grouped_gemm): 0.158

======================
TFLOPS (grouped_gemm): 4.302
TFLOPS (nn.Linear): 6.167
TFLOPS (a @ b): 10.337
TFLOPS (bmm): 27.183

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 401.88 MB
Max memory reserved: 572.00 MB
Average grouped_gemm time: 250.113 μs

======================
Average nn.Linear time: 173.073 μs
Average a @ b time: 122.700 μs
Average bmm time: 64.385 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.692
Speedup (a @ b / grouped_gemm): 0.491
Speedup (bmm / grouped_gemm): 0.257

======================
TFLOPS (grouped_gemm): 8.586
TFLOPS (nn.Linear): 12.408
TFLOPS (a @ b): 17.502
TFLOPS (bmm): 33.354

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 401.88 MB
Max memory reserved: 572.00 MB
Average grouped_gemm time: 253.284 μs

======================
Average nn.Linear time: 172.913 μs
Average a @ b time: 175.531 μs
Average bmm time: 111.051 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.683
Speedup (a @ b / grouped_gemm): 0.693
Speedup (bmm / grouped_gemm): 0.438

======================
TFLOPS (grouped_gemm): 16.957
TFLOPS (nn.Linear): 24.839
TFLOPS (a @ b): 24.468
TFLOPS (bmm): 38.676

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 566.12 MB
Max memory reserved: 892.00 MB
Average grouped_gemm time: 454.690 μs

======================
Average nn.Linear time: 201.800 μs
Average a @ b time: 223.603 μs
Average bmm time: 185.533 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.444
Speedup (a @ b / grouped_gemm): 0.492
Speedup (bmm / grouped_gemm): 0.408

======================
TFLOPS (grouped_gemm): 18.892
TFLOPS (nn.Linear): 42.567
TFLOPS (a @ b): 38.416
TFLOPS (bmm): 46.299

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1120.12 MB
Max memory reserved: 1660.00 MB
Average grouped_gemm time: 662.689 μs

======================
Average nn.Linear time: 410.600 μs
Average a @ b time: 403.576 μs
Average bmm time: 337.355 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.620
Speedup (a @ b / grouped_gemm): 0.609
Speedup (bmm / grouped_gemm): 0.509

======================
TFLOPS (grouped_gemm): 25.924
TFLOPS (nn.Linear): 41.841
TFLOPS (a @ b): 42.569
TFLOPS (bmm): 50.925

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 1071.706 μs

======================
Average nn.Linear time: 673.382 μs
Average a @ b time: 665.550 μs
Average bmm time: 679.765 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.628
Speedup (a @ b / grouped_gemm): 0.621
Speedup (bmm / grouped_gemm): 0.634

======================
TFLOPS (grouped_gemm): 28.053
TFLOPS (nn.Linear): 44.647
TFLOPS (a @ b): 45.173
TFLOPS (bmm): 44.228

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 64.847 μs

======================
Average nn.Linear time: 186.529 μs
Average a @ b time: 104.544 μs
Average bmm time: 19.176 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.876
Speedup (a @ b / grouped_gemm): 1.612
Speedup (bmm / grouped_gemm): 0.296

======================
TFLOPS (grouped_gemm): 0.517
TFLOPS (nn.Linear): 0.180
TFLOPS (a @ b): 0.321
TFLOPS (bmm): 1.750

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 62.969 μs

======================
Average nn.Linear time: 181.737 μs
Average a @ b time: 105.040 μs
Average bmm time: 19.767 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.886
Speedup (a @ b / grouped_gemm): 1.668
Speedup (bmm / grouped_gemm): 0.314

======================
TFLOPS (grouped_gemm): 1.066
TFLOPS (nn.Linear): 0.369
TFLOPS (a @ b): 0.639
TFLOPS (bmm): 3.395

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 64.235 μs

======================
Average nn.Linear time: 181.913 μs
Average a @ b time: 107.810 μs
Average bmm time: 21.033 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.832
Speedup (a @ b / grouped_gemm): 1.678
Speedup (bmm / grouped_gemm): 0.327

======================
TFLOPS (grouped_gemm): 2.089
TFLOPS (nn.Linear): 0.738
TFLOPS (a @ b): 1.245
TFLOPS (bmm): 6.381

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 65.053 μs

======================
Average nn.Linear time: 181.942 μs
Average a @ b time: 105.734 μs
Average bmm time: 25.320 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.797
Speedup (a @ b / grouped_gemm): 1.625
Speedup (bmm / grouped_gemm): 0.389

======================
TFLOPS (grouped_gemm): 4.126
TFLOPS (nn.Linear): 1.475
TFLOPS (a @ b): 2.539
TFLOPS (bmm): 10.602

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 75.085 μs

======================
Average nn.Linear time: 143.156 μs
Average a @ b time: 78.011 μs
Average bmm time: 31.660 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.907
Speedup (a @ b / grouped_gemm): 1.039
Speedup (bmm / grouped_gemm): 0.422

======================
TFLOPS (grouped_gemm): 7.150
TFLOPS (nn.Linear): 3.750
TFLOPS (a @ b): 6.882
TFLOPS (bmm): 16.958

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 89.800 μs

======================
Average nn.Linear time: 146.985 μs
Average a @ b time: 83.225 μs
Average bmm time: 31.319 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.637
Speedup (a @ b / grouped_gemm): 0.927
Speedup (bmm / grouped_gemm): 0.349

======================
TFLOPS (grouped_gemm): 11.957
TFLOPS (nn.Linear): 7.305
TFLOPS (a @ b): 12.902
TFLOPS (bmm): 34.284

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 119.576 μs

======================
Average nn.Linear time: 147.095 μs
Average a @ b time: 92.599 μs
Average bmm time: 55.370 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.230
Speedup (a @ b / grouped_gemm): 0.774
Speedup (bmm / grouped_gemm): 0.463

======================
TFLOPS (grouped_gemm): 15.714
TFLOPS (nn.Linear): 12.774
TFLOPS (a @ b): 20.292
TFLOPS (bmm): 33.936

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 92.938 μs

======================
Average nn.Linear time: 183.692 μs
Average a @ b time: 104.997 μs
Average bmm time: 21.112 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.977
Speedup (a @ b / grouped_gemm): 1.130
Speedup (bmm / grouped_gemm): 0.227

======================
TFLOPS (grouped_gemm): 2.166
TFLOPS (nn.Linear): 1.096
TFLOPS (a @ b): 1.917
TFLOPS (bmm): 9.536

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 94.247 μs

======================
Average nn.Linear time: 184.133 μs
Average a @ b time: 105.681 μs
Average bmm time: 21.288 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.954
Speedup (a @ b / grouped_gemm): 1.121
Speedup (bmm / grouped_gemm): 0.226

======================
TFLOPS (grouped_gemm): 4.272
TFLOPS (nn.Linear): 2.187
TFLOPS (a @ b): 3.810
TFLOPS (bmm): 18.914

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 93.048 μs

======================
Average nn.Linear time: 146.189 μs
Average a @ b time: 78.576 μs
Average bmm time: 26.069 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.571
Speedup (a @ b / grouped_gemm): 0.844
Speedup (bmm / grouped_gemm): 0.280

======================
TFLOPS (grouped_gemm): 8.655
TFLOPS (nn.Linear): 5.509
TFLOPS (a @ b): 10.249
TFLOPS (bmm): 30.892

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 94.411 μs

======================
Average nn.Linear time: 142.212 μs
Average a @ b time: 79.408 μs
Average bmm time: 35.849 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.506
Speedup (a @ b / grouped_gemm): 0.841
Speedup (bmm / grouped_gemm): 0.380

======================
TFLOPS (grouped_gemm): 17.060
TFLOPS (nn.Linear): 11.325
TFLOPS (a @ b): 20.283
TFLOPS (bmm): 44.928

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 139.670 μs

======================
Average nn.Linear time: 143.735 μs
Average a @ b time: 91.469 μs
Average bmm time: 58.250 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.029
Speedup (a @ b / grouped_gemm): 0.655
Speedup (bmm / grouped_gemm): 0.417

======================
TFLOPS (grouped_gemm): 23.063
TFLOPS (nn.Linear): 22.411
TFLOPS (a @ b): 35.216
TFLOPS (bmm): 55.300

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 186.484 μs

======================
Average nn.Linear time: 197.914 μs
Average a @ b time: 231.674 μs
Average bmm time: 88.367 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.061
Speedup (a @ b / grouped_gemm): 1.242
Speedup (bmm / grouped_gemm): 0.474

======================
TFLOPS (grouped_gemm): 34.547
TFLOPS (nn.Linear): 32.552
TFLOPS (a @ b): 27.808
TFLOPS (bmm): 72.905

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 272.532 μs

======================
Average nn.Linear time: 151.176 μs
Average a @ b time: 191.255 μs
Average bmm time: 159.290 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.555
Speedup (a @ b / grouped_gemm): 0.702
Speedup (bmm / grouped_gemm): 0.584

======================
TFLOPS (grouped_gemm): 41.369
TFLOPS (nn.Linear): 74.577
TFLOPS (a @ b): 58.949
TFLOPS (bmm): 70.778

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 248.017 μs

======================
Average nn.Linear time: 170.777 μs
Average a @ b time: 101.414 μs
Average bmm time: 33.045 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.689
Speedup (a @ b / grouped_gemm): 0.409
Speedup (bmm / grouped_gemm): 0.133

======================
TFLOPS (grouped_gemm): 4.329
TFLOPS (nn.Linear): 6.287
TFLOPS (a @ b): 10.588
TFLOPS (bmm): 32.494

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 249.095 μs

======================
Average nn.Linear time: 173.647 μs
Average a @ b time: 106.609 μs
Average bmm time: 41.151 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.697
Speedup (a @ b / grouped_gemm): 0.428
Speedup (bmm / grouped_gemm): 0.165

======================
TFLOPS (grouped_gemm): 8.621
TFLOPS (nn.Linear): 12.367
TFLOPS (a @ b): 20.144
TFLOPS (bmm): 52.185

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 249.856 μs

======================
Average nn.Linear time: 172.021 μs
Average a @ b time: 129.488 μs
Average bmm time: 66.526 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.688
Speedup (a @ b / grouped_gemm): 0.518
Speedup (bmm / grouped_gemm): 0.266

======================
TFLOPS (grouped_gemm): 17.190
TFLOPS (nn.Linear): 24.968
TFLOPS (a @ b): 33.169
TFLOPS (bmm): 64.561

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 253.837 μs

======================
Average nn.Linear time: 176.122 μs
Average a @ b time: 172.048 μs
Average bmm time: 118.310 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.694
Speedup (a @ b / grouped_gemm): 0.678
Speedup (bmm / grouped_gemm): 0.466

======================
TFLOPS (grouped_gemm): 33.840
TFLOPS (nn.Linear): 48.773
TFLOPS (a @ b): 49.928
TFLOPS (bmm): 72.605

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3004.00 MB
Average grouped_gemm time: 456.228 μs

======================
Average nn.Linear time: 218.794 μs
Average a @ b time: 230.682 μs
Average bmm time: 192.859 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.480
Speedup (a @ b / grouped_gemm): 0.506
Speedup (bmm / grouped_gemm): 0.423

======================
TFLOPS (grouped_gemm): 37.656
TFLOPS (nn.Linear): 78.521
TFLOPS (a @ b): 74.474
TFLOPS (bmm): 89.080

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1951.12 MB
Max memory reserved: 3006.00 MB
Average grouped_gemm time: 663.822 μs

======================
Average nn.Linear time: 407.948 μs
Average a @ b time: 401.189 μs
Average bmm time: 348.279 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.615
Speedup (a @ b / grouped_gemm): 0.604
Speedup (bmm / grouped_gemm): 0.525

======================
TFLOPS (grouped_gemm): 51.760
TFLOPS (nn.Linear): 84.226
TFLOPS (a @ b): 85.645
TFLOPS (bmm): 98.656

--------------------------------------------------

Parameters: batch_size=1, sequence_length=64, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3006.00 MB
Average grouped_gemm time: 1074.033 μs

======================
Average nn.Linear time: 689.769 μs
Average a @ b time: 683.236 μs
Average bmm time: 689.354 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.642
Speedup (a @ b / grouped_gemm): 0.636
Speedup (bmm / grouped_gemm): 0.642

======================
TFLOPS (grouped_gemm): 55.985
TFLOPS (nn.Linear): 87.173
TFLOPS (a @ b): 88.007
TFLOPS (bmm): 87.226

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3006.00 MB
Average grouped_gemm time: 64.893 μs

======================
Average nn.Linear time: 184.188 μs
Average a @ b time: 107.284 μs
Average bmm time: 19.855 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.838
Speedup (a @ b / grouped_gemm): 1.653
Speedup (bmm / grouped_gemm): 0.306

======================
TFLOPS (grouped_gemm): 1.034
TFLOPS (nn.Linear): 0.364
TFLOPS (a @ b): 0.626
TFLOPS (bmm): 3.380

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3006.00 MB
Average grouped_gemm time: 64.676 μs

======================
Average nn.Linear time: 183.415 μs
Average a @ b time: 107.565 μs
Average bmm time: 21.145 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.836
Speedup (a @ b / grouped_gemm): 1.663
Speedup (bmm / grouped_gemm): 0.327

======================
TFLOPS (grouped_gemm): 2.075
TFLOPS (nn.Linear): 0.732
TFLOPS (a @ b): 1.248
TFLOPS (bmm): 6.347

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3006.00 MB
Average grouped_gemm time: 65.279 μs

======================
Average nn.Linear time: 152.078 μs
Average a @ b time: 82.865 μs
Average bmm time: 24.943 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.330
Speedup (a @ b / grouped_gemm): 1.269
Speedup (bmm / grouped_gemm): 0.382

======================
TFLOPS (grouped_gemm): 4.112
TFLOPS (nn.Linear): 1.765
TFLOPS (a @ b): 3.239
TFLOPS (bmm): 10.762

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3006.00 MB
Average grouped_gemm time: 65.069 μs

======================
Average nn.Linear time: 152.152 μs
Average a @ b time: 81.222 μs
Average bmm time: 31.977 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.338
Speedup (a @ b / grouped_gemm): 1.248
Speedup (bmm / grouped_gemm): 0.491

======================
TFLOPS (grouped_gemm): 8.251
TFLOPS (nn.Linear): 3.529
TFLOPS (a @ b): 6.610
TFLOPS (bmm): 16.789

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 77.436 μs

======================
Average nn.Linear time: 145.426 μs
Average a @ b time: 77.422 μs
Average bmm time: 44.577 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.878
Speedup (a @ b / grouped_gemm): 1.000
Speedup (bmm / grouped_gemm): 0.576

======================
TFLOPS (grouped_gemm): 13.866
TFLOPS (nn.Linear): 7.383
TFLOPS (a @ b): 13.869
TFLOPS (bmm): 24.087

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 94.559 μs

======================
Average nn.Linear time: 146.537 μs
Average a @ b time: 86.057 μs
Average bmm time: 39.504 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.550
Speedup (a @ b / grouped_gemm): 0.910
Speedup (bmm / grouped_gemm): 0.418

======================
TFLOPS (grouped_gemm): 22.710
TFLOPS (nn.Linear): 14.655
TFLOPS (a @ b): 24.954
TFLOPS (bmm): 54.362

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 123.048 μs

======================
Average nn.Linear time: 152.333 μs
Average a @ b time: 115.869 μs
Average bmm time: 63.679 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.238
Speedup (a @ b / grouped_gemm): 0.942
Speedup (bmm / grouped_gemm): 0.518

======================
TFLOPS (grouped_gemm): 30.542
TFLOPS (nn.Linear): 24.670
TFLOPS (a @ b): 32.434
TFLOPS (bmm): 59.016

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 94.202 μs

======================
Average nn.Linear time: 182.846 μs
Average a @ b time: 107.501 μs
Average bmm time: 21.808 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.941
Speedup (a @ b / grouped_gemm): 1.141
Speedup (bmm / grouped_gemm): 0.232

======================
TFLOPS (grouped_gemm): 4.274
TFLOPS (nn.Linear): 2.202
TFLOPS (a @ b): 3.746
TFLOPS (bmm): 18.463

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 94.652 μs

======================
Average nn.Linear time: 184.288 μs
Average a @ b time: 108.128 μs
Average bmm time: 26.305 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.947
Speedup (a @ b / grouped_gemm): 1.142
Speedup (bmm / grouped_gemm): 0.278

======================
TFLOPS (grouped_gemm): 8.508
TFLOPS (nn.Linear): 4.370
TFLOPS (a @ b): 7.448
TFLOPS (bmm): 30.615

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 94.740 μs

======================
Average nn.Linear time: 147.045 μs
Average a @ b time: 79.579 μs
Average bmm time: 35.617 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.552
Speedup (a @ b / grouped_gemm): 0.840
Speedup (bmm / grouped_gemm): 0.376

======================
TFLOPS (grouped_gemm): 17.000
TFLOPS (nn.Linear): 10.953
TFLOPS (a @ b): 20.239
TFLOPS (bmm): 45.220

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 94.757 μs

======================
Average nn.Linear time: 154.428 μs
Average a @ b time: 87.163 μs
Average bmm time: 49.679 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.630
Speedup (a @ b / grouped_gemm): 0.920
Speedup (bmm / grouped_gemm): 0.524

======================
TFLOPS (grouped_gemm): 33.995
TFLOPS (nn.Linear): 20.859
TFLOPS (a @ b): 36.956
TFLOPS (bmm): 64.840

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 141.952 μs

======================
Average nn.Linear time: 146.968 μs
Average a @ b time: 101.688 μs
Average bmm time: 76.845 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.035
Speedup (a @ b / grouped_gemm): 0.716
Speedup (bmm / grouped_gemm): 0.541

======================
TFLOPS (grouped_gemm): 45.385
TFLOPS (nn.Linear): 43.836
TFLOPS (a @ b): 63.355
TFLOPS (bmm): 83.837

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 187.080 μs

======================
Average nn.Linear time: 151.887 μs
Average a @ b time: 149.066 μs
Average bmm time: 100.501 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.812
Speedup (a @ b / grouped_gemm): 0.797
Speedup (bmm / grouped_gemm): 0.537

======================
TFLOPS (grouped_gemm): 68.874
TFLOPS (nn.Linear): 84.832
TFLOPS (a @ b): 86.437
TFLOPS (bmm): 128.207

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 276.875 μs

======================
Average nn.Linear time: 227.590 μs
Average a @ b time: 231.576 μs
Average bmm time: 166.655 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.822
Speedup (a @ b / grouped_gemm): 0.836
Speedup (bmm / grouped_gemm): 0.602

======================
TFLOPS (grouped_gemm): 81.439
TFLOPS (nn.Linear): 99.076
TFLOPS (a @ b): 97.370
TFLOPS (bmm): 135.301

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 248.921 μs

======================
Average nn.Linear time: 170.648 μs
Average a @ b time: 103.853 μs
Average bmm time: 35.529 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.686
Speedup (a @ b / grouped_gemm): 0.417
Speedup (bmm / grouped_gemm): 0.143

======================
TFLOPS (grouped_gemm): 8.627
TFLOPS (nn.Linear): 12.584
TFLOPS (a @ b): 20.678
TFLOPS (bmm): 60.443

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 250.244 μs

======================
Average nn.Linear time: 171.728 μs
Average a @ b time: 123.644 μs
Average bmm time: 52.698 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.686
Speedup (a @ b / grouped_gemm): 0.494
Speedup (bmm / grouped_gemm): 0.211

======================
TFLOPS (grouped_gemm): 17.163
TFLOPS (nn.Linear): 25.010
TFLOPS (a @ b): 34.737
TFLOPS (bmm): 81.502

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 251.110 μs

======================
Average nn.Linear time: 170.829 μs
Average a @ b time: 144.331 μs
Average bmm time: 97.849 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.680
Speedup (a @ b / grouped_gemm): 0.575
Speedup (bmm / grouped_gemm): 0.390

======================
TFLOPS (grouped_gemm): 34.208
TFLOPS (nn.Linear): 50.284
TFLOPS (a @ b): 59.515
TFLOPS (bmm): 87.787

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 255.699 μs

======================
Average nn.Linear time: 192.599 μs
Average a @ b time: 197.825 μs
Average bmm time: 154.705 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.753
Speedup (a @ b / grouped_gemm): 0.774
Speedup (bmm / grouped_gemm): 0.605

======================
TFLOPS (grouped_gemm): 67.188
TFLOPS (nn.Linear): 89.200
TFLOPS (a @ b): 86.844
TFLOPS (bmm): 111.049

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 458.920 μs

======================
Average nn.Linear time: 284.286 μs
Average a @ b time: 275.397 μs
Average bmm time: 269.375 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.619
Speedup (a @ b / grouped_gemm): 0.600
Speedup (bmm / grouped_gemm): 0.587

======================
TFLOPS (grouped_gemm): 74.871
TFLOPS (nn.Linear): 120.863
TFLOPS (a @ b): 124.764
TFLOPS (bmm): 127.554

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 1992.38 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 665.708 μs

======================
Average nn.Linear time: 479.305 μs
Average a @ b time: 478.256 μs
Average bmm time: 377.884 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.720
Speedup (a @ b / grouped_gemm): 0.718
Speedup (bmm / grouped_gemm): 0.568

======================
TFLOPS (grouped_gemm): 103.228
TFLOPS (nn.Linear): 143.373
TFLOPS (a @ b): 143.688
TFLOPS (bmm): 181.853

--------------------------------------------------

Parameters: batch_size=1, sequence_length=128, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 1095.788 μs

======================
Average nn.Linear time: 876.443 μs
Average a @ b time: 869.026 μs
Average bmm time: 671.048 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.800
Speedup (a @ b / grouped_gemm): 0.793
Speedup (bmm / grouped_gemm): 0.612

======================
TFLOPS (grouped_gemm): 109.747
TFLOPS (nn.Linear): 137.213
TFLOPS (a @ b): 138.384
TFLOPS (bmm): 179.211

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 68.781 μs

======================
Average nn.Linear time: 185.568 μs
Average a @ b time: 108.073 μs
Average bmm time: 20.761 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.698
Speedup (a @ b / grouped_gemm): 1.571
Speedup (bmm / grouped_gemm): 0.302

======================
TFLOPS (grouped_gemm): 1.951
TFLOPS (nn.Linear): 0.723
TFLOPS (a @ b): 1.242
TFLOPS (bmm): 6.465

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 65.827 μs

======================
Average nn.Linear time: 183.370 μs
Average a @ b time: 107.396 μs
Average bmm time: 25.084 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.786
Speedup (a @ b / grouped_gemm): 1.631
Speedup (bmm / grouped_gemm): 0.381

======================
TFLOPS (grouped_gemm): 4.078
TFLOPS (nn.Linear): 1.464
TFLOPS (a @ b): 2.500
TFLOPS (bmm): 10.701

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 65.746 μs

======================
Average nn.Linear time: 152.991 μs
Average a @ b time: 83.196 μs
Average bmm time: 32.215 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.327
Speedup (a @ b / grouped_gemm): 1.265
Speedup (bmm / grouped_gemm): 0.490

======================
TFLOPS (grouped_gemm): 8.166
TFLOPS (nn.Linear): 3.509
TFLOPS (a @ b): 6.453
TFLOPS (bmm): 16.665

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 64.468 μs

======================
Average nn.Linear time: 149.696 μs
Average a @ b time: 81.439 μs
Average bmm time: 44.014 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.322
Speedup (a @ b / grouped_gemm): 1.263
Speedup (bmm / grouped_gemm): 0.683

======================
TFLOPS (grouped_gemm): 16.655
TFLOPS (nn.Linear): 7.173
TFLOPS (a @ b): 13.185
TFLOPS (bmm): 24.395

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 82.591 μs

======================
Average nn.Linear time: 184.290 μs
Average a @ b time: 110.829 μs
Average bmm time: 74.458 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.231
Speedup (a @ b / grouped_gemm): 1.342
Speedup (bmm / grouped_gemm): 0.902

======================
TFLOPS (grouped_gemm): 26.002
TFLOPS (nn.Linear): 11.653
TFLOPS (a @ b): 19.377
TFLOPS (bmm): 28.841

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 103.014 μs

======================
Average nn.Linear time: 153.058 μs
Average a @ b time: 116.696 μs
Average bmm time: 59.350 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.486
Speedup (a @ b / grouped_gemm): 1.133
Speedup (bmm / grouped_gemm): 0.576

======================
TFLOPS (grouped_gemm): 41.693
TFLOPS (nn.Linear): 28.061
TFLOPS (a @ b): 36.805
TFLOPS (bmm): 72.367

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 137.577 μs

======================
Average nn.Linear time: 155.764 μs
Average a @ b time: 152.924 μs
Average bmm time: 94.912 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.132
Speedup (a @ b / grouped_gemm): 1.112
Speedup (bmm / grouped_gemm): 0.690

======================
TFLOPS (grouped_gemm): 54.633
TFLOPS (nn.Linear): 48.254
TFLOPS (a @ b): 49.150
TFLOPS (bmm): 79.191

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 95.942 μs

======================
Average nn.Linear time: 183.544 μs
Average a @ b time: 107.744 μs
Average bmm time: 23.484 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.913
Speedup (a @ b / grouped_gemm): 1.123
Speedup (bmm / grouped_gemm): 0.245

======================
TFLOPS (grouped_gemm): 8.394
TFLOPS (nn.Linear): 4.388
TFLOPS (a @ b): 7.474
TFLOPS (bmm): 34.291

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 96.066 μs

======================
Average nn.Linear time: 180.395 μs
Average a @ b time: 108.526 μs
Average bmm time: 31.381 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.878
Speedup (a @ b / grouped_gemm): 1.130
Speedup (bmm / grouped_gemm): 0.327

======================
TFLOPS (grouped_gemm): 16.766
TFLOPS (nn.Linear): 8.928
TFLOPS (a @ b): 14.841
TFLOPS (bmm): 51.325

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 93.915 μs

======================
Average nn.Linear time: 146.403 μs
Average a @ b time: 82.548 μs
Average bmm time: 38.922 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.559
Speedup (a @ b / grouped_gemm): 0.879
Speedup (bmm / grouped_gemm): 0.414

======================
TFLOPS (grouped_gemm): 34.299
TFLOPS (nn.Linear): 22.002
TFLOPS (a @ b): 39.023
TFLOPS (bmm): 82.761

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 97.470 μs

======================
Average nn.Linear time: 144.820 μs
Average a @ b time: 98.286 μs
Average bmm time: 55.335 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.486
Speedup (a @ b / grouped_gemm): 1.008
Speedup (bmm / grouped_gemm): 0.568

======================
TFLOPS (grouped_gemm): 66.097
TFLOPS (nn.Linear): 44.486
TFLOPS (a @ b): 65.548
TFLOPS (bmm): 116.427

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 146.849 μs

======================
Average nn.Linear time: 187.988 μs
Average a @ b time: 136.561 μs
Average bmm time: 87.957 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.280
Speedup (a @ b / grouped_gemm): 0.930
Speedup (bmm / grouped_gemm): 0.599

======================
TFLOPS (grouped_gemm): 87.742
TFLOPS (nn.Linear): 68.541
TFLOPS (a @ b): 94.352
TFLOPS (bmm): 146.490

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 197.146 μs

======================
Average nn.Linear time: 260.463 μs
Average a @ b time: 259.969 μs
Average bmm time: 137.494 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.321
Speedup (a @ b / grouped_gemm): 1.319
Speedup (bmm / grouped_gemm): 0.697

======================
TFLOPS (grouped_gemm): 130.714
TFLOPS (nn.Linear): 98.939
TFLOPS (a @ b): 99.126
TFLOPS (bmm): 187.425

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 293.345 μs

======================
Average nn.Linear time: 334.911 μs
Average a @ b time: 329.950 μs
Average bmm time: 227.995 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.142
Speedup (a @ b / grouped_gemm): 1.125
Speedup (bmm / grouped_gemm): 0.777

======================
TFLOPS (grouped_gemm): 153.734
TFLOPS (nn.Linear): 134.654
TFLOPS (a @ b): 136.679
TFLOPS (bmm): 197.799

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 256.119 μs

======================
Average nn.Linear time: 164.452 μs
Average a @ b time: 133.967 μs
Average bmm time: 47.224 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.642
Speedup (a @ b / grouped_gemm): 0.523
Speedup (bmm / grouped_gemm): 0.184

======================
TFLOPS (grouped_gemm): 16.769
TFLOPS (nn.Linear): 26.117
TFLOPS (a @ b): 32.060
TFLOPS (bmm): 90.950

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 255.964 μs

======================
Average nn.Linear time: 167.379 μs
Average a @ b time: 142.803 μs
Average bmm time: 83.969 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.654
Speedup (a @ b / grouped_gemm): 0.558
Speedup (bmm / grouped_gemm): 0.328

======================
TFLOPS (grouped_gemm): 33.559
TFLOPS (nn.Linear): 51.320
TFLOPS (a @ b): 60.152
TFLOPS (bmm): 102.299

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 254.712 μs

======================
Average nn.Linear time: 188.468 μs
Average a @ b time: 182.192 μs
Average bmm time: 120.082 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.740
Speedup (a @ b / grouped_gemm): 0.715
Speedup (bmm / grouped_gemm): 0.471

======================
TFLOPS (grouped_gemm): 67.448
TFLOPS (nn.Linear): 91.156
TFLOPS (a @ b): 94.295
TFLOPS (bmm): 143.068

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 258.672 μs

======================
Average nn.Linear time: 271.106 μs
Average a @ b time: 265.458 μs
Average bmm time: 195.501 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.048
Speedup (a @ b / grouped_gemm): 1.026
Speedup (bmm / grouped_gemm): 0.756

======================
TFLOPS (grouped_gemm): 132.831
TFLOPS (nn.Linear): 126.739
TFLOPS (a @ b): 129.436
TFLOPS (bmm): 175.752

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 467.813 μs

======================
Average nn.Linear time: 438.893 μs
Average a @ b time: 434.701 μs
Average bmm time: 373.590 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.938
Speedup (a @ b / grouped_gemm): 0.929
Speedup (bmm / grouped_gemm): 0.799

======================
TFLOPS (grouped_gemm): 146.895
TFLOPS (nn.Linear): 156.575
TFLOPS (a @ b): 158.084
TFLOPS (bmm): 183.944

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2071.62 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 701.261 μs

======================
Average nn.Linear time: 983.665 μs
Average a @ b time: 970.926 μs
Average bmm time: 627.651 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.403
Speedup (a @ b / grouped_gemm): 1.385
Speedup (bmm / grouped_gemm): 0.895

======================
TFLOPS (grouped_gemm): 195.988
TFLOPS (nn.Linear): 139.721
TFLOPS (a @ b): 141.554
TFLOPS (bmm): 218.973

--------------------------------------------------

Parameters: batch_size=1, sequence_length=256, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 1153.345 μs

======================
Average nn.Linear time: 1369.064 μs
Average a @ b time: 1363.184 μs
Average bmm time: 1250.606 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.187
Speedup (a @ b / grouped_gemm): 1.182
Speedup (bmm / grouped_gemm): 1.084

======================
TFLOPS (grouped_gemm): 208.540
TFLOPS (nn.Linear): 175.681
TFLOPS (a @ b): 176.438
TFLOPS (bmm): 192.321

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 68.545 μs

======================
Average nn.Linear time: 185.039 μs
Average a @ b time: 107.167 μs
Average bmm time: 25.947 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.700
Speedup (a @ b / grouped_gemm): 1.563
Speedup (bmm / grouped_gemm): 0.379

======================
TFLOPS (grouped_gemm): 3.916
TFLOPS (nn.Linear): 1.451
TFLOPS (a @ b): 2.505
TFLOPS (bmm): 10.345

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 66.476 μs

======================
Average nn.Linear time: 154.133 μs
Average a @ b time: 83.072 μs
Average bmm time: 31.722 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.319
Speedup (a @ b / grouped_gemm): 1.250
Speedup (bmm / grouped_gemm): 0.477

======================
TFLOPS (grouped_gemm): 8.076
TFLOPS (nn.Linear): 3.483
TFLOPS (a @ b): 6.463
TFLOPS (bmm): 16.924

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 66.776 μs

======================
Average nn.Linear time: 152.884 μs
Average a @ b time: 82.164 μs
Average bmm time: 44.956 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.289
Speedup (a @ b / grouped_gemm): 1.230
Speedup (bmm / grouped_gemm): 0.673

======================
TFLOPS (grouped_gemm): 16.080
TFLOPS (nn.Linear): 7.023
TFLOPS (a @ b): 13.068
TFLOPS (bmm): 23.884

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 82.970 μs

======================
Average nn.Linear time: 152.030 μs
Average a @ b time: 101.779 μs
Average bmm time: 71.838 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.832
Speedup (a @ b / grouped_gemm): 1.227
Speedup (bmm / grouped_gemm): 0.866

======================
TFLOPS (grouped_gemm): 25.883
TFLOPS (nn.Linear): 14.125
TFLOPS (a @ b): 21.100
TFLOPS (bmm): 29.893

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 101.497 μs

======================
Average nn.Linear time: 186.331 μs
Average a @ b time: 112.336 μs
Average bmm time: 126.340 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.836
Speedup (a @ b / grouped_gemm): 1.107
Speedup (bmm / grouped_gemm): 1.245

======================
TFLOPS (grouped_gemm): 42.316
TFLOPS (nn.Linear): 23.050
TFLOPS (a @ b): 38.233
TFLOPS (bmm): 33.995

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 137.196 μs

======================
Average nn.Linear time: 162.406 μs
Average a @ b time: 162.423 μs
Average bmm time: 93.539 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.184
Speedup (a @ b / grouped_gemm): 1.184
Speedup (bmm / grouped_gemm): 0.682

======================
TFLOPS (grouped_gemm): 62.611
TFLOPS (nn.Linear): 52.892
TFLOPS (a @ b): 52.886
TFLOPS (bmm): 91.833

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 200.701 μs

======================
Average nn.Linear time: 226.591 μs
Average a @ b time: 233.047 μs
Average bmm time: 153.193 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.129
Speedup (a @ b / grouped_gemm): 1.161
Speedup (bmm / grouped_gemm): 0.763

======================
TFLOPS (grouped_gemm): 74.899
TFLOPS (nn.Linear): 66.342
TFLOPS (a @ b): 64.504
TFLOPS (bmm): 98.127

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 94.788 μs

======================
Average nn.Linear time: 147.247 μs
Average a @ b time: 81.494 μs
Average bmm time: 31.297 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.553
Speedup (a @ b / grouped_gemm): 0.860
Speedup (bmm / grouped_gemm): 0.330

======================
TFLOPS (grouped_gemm): 16.992
TFLOPS (nn.Linear): 10.938
TFLOPS (a @ b): 19.764
TFLOPS (bmm): 51.462

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 95.422 μs

======================
Average nn.Linear time: 144.489 μs
Average a @ b time: 81.432 μs
Average bmm time: 39.163 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.514
Speedup (a @ b / grouped_gemm): 0.853
Speedup (bmm / grouped_gemm): 0.410

======================
TFLOPS (grouped_gemm): 33.758
TFLOPS (nn.Linear): 22.294
TFLOPS (a @ b): 39.557
TFLOPS (bmm): 82.253

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 97.680 μs

======================
Average nn.Linear time: 144.057 μs
Average a @ b time: 96.054 μs
Average bmm time: 53.749 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.475
Speedup (a @ b / grouped_gemm): 0.983
Speedup (bmm / grouped_gemm): 0.550

======================
TFLOPS (grouped_gemm): 65.955
TFLOPS (nn.Linear): 44.721
TFLOPS (a @ b): 67.071
TFLOPS (bmm): 119.862

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 143.325 μs

======================
Average nn.Linear time: 157.468 μs
Average a @ b time: 148.389 μs
Average bmm time: 87.183 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.099
Speedup (a @ b / grouped_gemm): 1.035
Speedup (bmm / grouped_gemm): 0.608

======================
TFLOPS (grouped_gemm): 89.900
TFLOPS (nn.Linear): 81.825
TFLOPS (a @ b): 86.832
TFLOPS (bmm): 147.792

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 191.829 μs

======================
Average nn.Linear time: 199.683 μs
Average a @ b time: 192.251 μs
Average bmm time: 150.352 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.041
Speedup (a @ b / grouped_gemm): 1.002
Speedup (bmm / grouped_gemm): 0.784

======================
TFLOPS (grouped_gemm): 134.337
TFLOPS (nn.Linear): 129.054
TFLOPS (a @ b): 134.042
TFLOPS (bmm): 171.397

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 291.989 μs

======================
Average nn.Linear time: 372.145 μs
Average a @ b time: 367.782 μs
Average bmm time: 240.438 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.275
Speedup (a @ b / grouped_gemm): 1.260
Speedup (bmm / grouped_gemm): 0.823

======================
TFLOPS (grouped_gemm): 176.512
TFLOPS (nn.Linear): 138.493
TFLOPS (a @ b): 140.136
TFLOPS (bmm): 214.357

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 484.612 μs

======================
Average nn.Linear time: 522.349 μs
Average a @ b time: 517.361 μs
Average bmm time: 417.919 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.078
Speedup (a @ b / grouped_gemm): 1.068
Speedup (bmm / grouped_gemm): 0.862

======================
TFLOPS (grouped_gemm): 186.117
TFLOPS (nn.Linear): 172.671
TFLOPS (a @ b): 174.335
TFLOPS (bmm): 215.818

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 263.813 μs

======================
Average nn.Linear time: 171.049 μs
Average a @ b time: 152.118 μs
Average bmm time: 84.333 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.648
Speedup (a @ b / grouped_gemm): 0.577
Speedup (bmm / grouped_gemm): 0.320

======================
TFLOPS (grouped_gemm): 32.561
TFLOPS (nn.Linear): 50.219
TFLOPS (a @ b): 56.469
TFLOPS (bmm): 101.857

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 257.194 μs

======================
Average nn.Linear time: 200.465 μs
Average a @ b time: 190.377 μs
Average bmm time: 120.397 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.779
Speedup (a @ b / grouped_gemm): 0.740
Speedup (bmm / grouped_gemm): 0.468

======================
TFLOPS (grouped_gemm): 66.797
TFLOPS (nn.Linear): 85.700
TFLOPS (a @ b): 90.241
TFLOPS (bmm): 142.694

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 255.961 μs

======================
Average nn.Linear time: 269.938 μs
Average a @ b time: 262.771 μs
Average bmm time: 192.158 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.055
Speedup (a @ b / grouped_gemm): 1.027
Speedup (bmm / grouped_gemm): 0.751

======================
TFLOPS (grouped_gemm): 134.238
TFLOPS (nn.Linear): 127.288
TFLOPS (a @ b): 130.759
TFLOPS (bmm): 178.810

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 467.467 μs

======================
Average nn.Linear time: 504.084 μs
Average a @ b time: 497.432 μs
Average bmm time: 366.826 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.078
Speedup (a @ b / grouped_gemm): 1.064
Speedup (bmm / grouped_gemm): 0.785

======================
TFLOPS (grouped_gemm): 147.004
TFLOPS (nn.Linear): 136.326
TFLOPS (a @ b): 138.149
TFLOPS (bmm): 187.335

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 699.375 μs

======================
Average nn.Linear time: 717.292 μs
Average a @ b time: 717.478 μs
Average bmm time: 738.075 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.026
Speedup (a @ b / grouped_gemm): 1.026
Speedup (bmm / grouped_gemm): 1.055

======================
TFLOPS (grouped_gemm): 196.517
TFLOPS (nn.Linear): 191.608
TFLOPS (a @ b): 191.558
TFLOPS (bmm): 186.213

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2227.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 1183.362 μs

======================
Average nn.Linear time: 1535.387 μs
Average a @ b time: 1506.360 μs
Average bmm time: 1346.190 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.297
Speedup (a @ b / grouped_gemm): 1.273
Speedup (bmm / grouped_gemm): 1.138

======================
TFLOPS (grouped_gemm): 232.286
TFLOPS (nn.Linear): 179.028
TFLOPS (a @ b): 182.478
TFLOPS (bmm): 204.190

--------------------------------------------------

Parameters: batch_size=1, sequence_length=512, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 2095.771 μs

======================
Average nn.Linear time: 2296.231 μs
Average a @ b time: 2283.080 μs
Average bmm time: 2570.941 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.096
Speedup (a @ b / grouped_gemm): 1.089
Speedup (bmm / grouped_gemm): 1.227

======================
TFLOPS (grouped_gemm): 229.527
TFLOPS (nn.Linear): 209.490
TFLOPS (a @ b): 210.696
TFLOPS (bmm): 187.105

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 69.635 μs

======================
Average nn.Linear time: 158.463 μs
Average a @ b time: 85.235 μs
Average bmm time: 26.441 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.276
Speedup (a @ b / grouped_gemm): 1.224
Speedup (bmm / grouped_gemm): 0.380

======================
TFLOPS (grouped_gemm): 7.710
TFLOPS (nn.Linear): 3.388
TFLOPS (a @ b): 6.299
TFLOPS (bmm): 20.305

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 67.973 μs

======================
Average nn.Linear time: 158.188 μs
Average a @ b time: 84.741 μs
Average bmm time: 31.545 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.327
Speedup (a @ b / grouped_gemm): 1.247
Speedup (bmm / grouped_gemm): 0.464

======================
TFLOPS (grouped_gemm): 15.797
TFLOPS (nn.Linear): 6.788
TFLOPS (a @ b): 12.671
TFLOPS (bmm): 34.038

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 83.354 μs

======================
Average nn.Linear time: 184.743 μs
Average a @ b time: 107.992 μs
Average bmm time: 41.878 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.216
Speedup (a @ b / grouped_gemm): 1.296
Speedup (bmm / grouped_gemm): 0.502

======================
TFLOPS (grouped_gemm): 25.764
TFLOPS (nn.Linear): 11.624
TFLOPS (a @ b): 19.886
TFLOPS (bmm): 51.279

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 99.564 μs

======================
Average nn.Linear time: 147.080 μs
Average a @ b time: 96.354 μs
Average bmm time: 64.938 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.477
Speedup (a @ b / grouped_gemm): 0.968
Speedup (bmm / grouped_gemm): 0.652

======================
TFLOPS (grouped_gemm): 43.138
TFLOPS (nn.Linear): 29.201
TFLOPS (a @ b): 44.575
TFLOPS (bmm): 66.139

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 136.456 μs

======================
Average nn.Linear time: 150.857 μs
Average a @ b time: 142.200 μs
Average bmm time: 110.006 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.106
Speedup (a @ b / grouped_gemm): 1.042
Speedup (bmm / grouped_gemm): 0.806

======================
TFLOPS (grouped_gemm): 62.950
TFLOPS (nn.Linear): 56.941
TFLOPS (a @ b): 60.407
TFLOPS (bmm): 78.086

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 210.559 μs

======================
Average nn.Linear time: 227.792 μs
Average a @ b time: 222.676 μs
Average bmm time: 158.892 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.082
Speedup (a @ b / grouped_gemm): 1.058
Speedup (bmm / grouped_gemm): 0.755

======================
TFLOPS (grouped_gemm): 81.592
TFLOPS (nn.Linear): 75.419
TFLOPS (a @ b): 77.152
TFLOPS (bmm): 108.123

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 321.810 μs

======================
Average nn.Linear time: 331.099 μs
Average a @ b time: 321.808 μs
Average bmm time: 268.314 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.029
Speedup (a @ b / grouped_gemm): 1.000
Speedup (bmm / grouped_gemm): 0.834

======================
TFLOPS (grouped_gemm): 93.424
TFLOPS (nn.Linear): 90.803
TFLOPS (a @ b): 93.425
TFLOPS (bmm): 112.051

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 96.467 μs

======================
Average nn.Linear time: 145.030 μs
Average a @ b time: 94.175 μs
Average bmm time: 39.709 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.503
Speedup (a @ b / grouped_gemm): 0.976
Speedup (bmm / grouped_gemm): 0.412

======================
TFLOPS (grouped_gemm): 33.392
TFLOPS (nn.Linear): 22.211
TFLOPS (a @ b): 34.205
TFLOPS (bmm): 81.122

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 97.747 μs

======================
Average nn.Linear time: 146.348 μs
Average a @ b time: 100.467 μs
Average bmm time: 54.810 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.497
Speedup (a @ b / grouped_gemm): 1.028
Speedup (bmm / grouped_gemm): 0.561

======================
TFLOPS (grouped_gemm): 65.910
TFLOPS (nn.Linear): 44.021
TFLOPS (a @ b): 64.125
TFLOPS (bmm): 117.541

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 146.663 μs

======================
Average nn.Linear time: 150.564 μs
Average a @ b time: 141.845 μs
Average bmm time: 86.799 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.027
Speedup (a @ b / grouped_gemm): 0.967
Speedup (bmm / grouped_gemm): 0.592

======================
TFLOPS (grouped_gemm): 87.854
TFLOPS (nn.Linear): 85.578
TFLOPS (a @ b): 90.838
TFLOPS (bmm): 148.446

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 190.635 μs

======================
Average nn.Linear time: 199.504 μs
Average a @ b time: 190.284 μs
Average bmm time: 149.109 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.047
Speedup (a @ b / grouped_gemm): 0.998
Speedup (bmm / grouped_gemm): 0.782

======================
TFLOPS (grouped_gemm): 135.179
TFLOPS (nn.Linear): 129.169
TFLOPS (a @ b): 135.428
TFLOPS (bmm): 172.825

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 288.198 μs

======================
Average nn.Linear time: 334.165 μs
Average a @ b time: 328.381 μs
Average bmm time: 275.774 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.159
Speedup (a @ b / grouped_gemm): 1.139
Speedup (bmm / grouped_gemm): 0.957

======================
TFLOPS (grouped_gemm): 178.834
TFLOPS (nn.Linear): 154.234
TFLOPS (a @ b): 156.951
TFLOPS (bmm): 186.891

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 537.398 μs

======================
Average nn.Linear time: 540.469 μs
Average a @ b time: 543.840 μs
Average bmm time: 466.716 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.006
Speedup (a @ b / grouped_gemm): 1.012
Speedup (bmm / grouped_gemm): 0.868

======================
TFLOPS (grouped_gemm): 191.812
TFLOPS (nn.Linear): 190.722
TFLOPS (a @ b): 189.540
TFLOPS (bmm): 220.861

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 908.394 μs

======================
Average nn.Linear time: 927.799 μs
Average a @ b time: 916.476 μs
Average bmm time: 828.867 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.021
Speedup (a @ b / grouped_gemm): 1.009
Speedup (bmm / grouped_gemm): 0.912

======================
TFLOPS (grouped_gemm): 198.580
TFLOPS (nn.Linear): 194.426
TFLOPS (a @ b): 196.828
TFLOPS (bmm): 217.633

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 268.605 μs

======================
Average nn.Linear time: 198.164 μs
Average a @ b time: 191.281 μs
Average bmm time: 126.135 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.738
Speedup (a @ b / grouped_gemm): 0.712
Speedup (bmm / grouped_gemm): 0.470

======================
TFLOPS (grouped_gemm): 63.960
TFLOPS (nn.Linear): 86.695
TFLOPS (a @ b): 89.815
TFLOPS (bmm): 136.202

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 260.403 μs

======================
Average nn.Linear time: 270.965 μs
Average a @ b time: 265.534 μs
Average bmm time: 193.560 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.041
Speedup (a @ b / grouped_gemm): 1.020
Speedup (bmm / grouped_gemm): 0.743

======================
TFLOPS (grouped_gemm): 131.948
TFLOPS (nn.Linear): 126.805
TFLOPS (a @ b): 129.399
TFLOPS (bmm): 177.515

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 462.759 μs

======================
Average nn.Linear time: 394.104 μs
Average a @ b time: 398.107 μs
Average bmm time: 365.226 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.852
Speedup (a @ b / grouped_gemm): 0.860
Speedup (bmm / grouped_gemm): 0.789

======================
TFLOPS (grouped_gemm): 148.500
TFLOPS (nn.Linear): 174.369
TFLOPS (a @ b): 172.616
TFLOPS (bmm): 188.156

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 684.097 μs

======================
Average nn.Linear time: 1087.122 μs
Average a @ b time: 1069.639 μs
Average bmm time: 701.966 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.589
Speedup (a @ b / grouped_gemm): 1.564
Speedup (bmm / grouped_gemm): 1.026

======================
TFLOPS (grouped_gemm): 200.906
TFLOPS (nn.Linear): 126.425
TFLOPS (a @ b): 128.491
TFLOPS (bmm): 195.791

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 1167.309 μs

======================
Average nn.Linear time: 1625.524 μs
Average a @ b time: 1598.728 μs
Average bmm time: 1372.058 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.393
Speedup (a @ b / grouped_gemm): 1.370
Speedup (bmm / grouped_gemm): 1.175

======================
TFLOPS (grouped_gemm): 235.480
TFLOPS (nn.Linear): 169.101
TFLOPS (a @ b): 171.935
TFLOPS (bmm): 200.340

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 2536.12 MB
Max memory reserved: 3012.00 MB
Average grouped_gemm time: 2318.554 μs

======================
Average nn.Linear time: 2529.070 μs
Average a @ b time: 2528.954 μs
Average bmm time: 2677.803 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.091
Speedup (a @ b / grouped_gemm): 1.091
Speedup (bmm / grouped_gemm): 1.155

======================
TFLOPS (grouped_gemm): 237.112
TFLOPS (nn.Linear): 217.375
TFLOPS (a @ b): 217.385
TFLOPS (bmm): 205.301

--------------------------------------------------

Parameters: batch_size=1, sequence_length=1024, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 3991.835 μs

======================
Average nn.Linear time: 4463.470 μs
Average a @ b time: 4398.010 μs
Average bmm time: 5041.802 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.118
Speedup (a @ b / grouped_gemm): 1.102
Speedup (bmm / grouped_gemm): 1.263

======================
TFLOPS (grouped_gemm): 241.010
TFLOPS (nn.Linear): 215.544
TFLOPS (a @ b): 218.752
TFLOPS (bmm): 190.819

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 68.190 μs

======================
Average nn.Linear time: 180.056 μs
Average a @ b time: 106.463 μs
Average bmm time: 32.856 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.641
Speedup (a @ b / grouped_gemm): 1.561
Speedup (bmm / grouped_gemm): 0.482

======================
TFLOPS (grouped_gemm): 15.746
TFLOPS (nn.Linear): 5.963
TFLOPS (a @ b): 10.086
TFLOPS (bmm): 32.680

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 83.508 μs

======================
Average nn.Linear time: 185.840 μs
Average a @ b time: 108.469 μs
Average bmm time: 42.198 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.225
Speedup (a @ b / grouped_gemm): 1.299
Speedup (bmm / grouped_gemm): 0.505

======================
TFLOPS (grouped_gemm): 25.716
TFLOPS (nn.Linear): 11.556
TFLOPS (a @ b): 19.798
TFLOPS (bmm): 50.891

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 100.019 μs

======================
Average nn.Linear time: 186.994 μs
Average a @ b time: 112.743 μs
Average bmm time: 64.371 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.870
Speedup (a @ b / grouped_gemm): 1.127
Speedup (bmm / grouped_gemm): 0.644

======================
TFLOPS (grouped_gemm): 42.942
TFLOPS (nn.Linear): 22.968
TFLOPS (a @ b): 38.095
TFLOPS (bmm): 66.722

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 136.008 μs

======================
Average nn.Linear time: 188.057 μs
Average a @ b time: 147.378 μs
Average bmm time: 107.846 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.383
Speedup (a @ b / grouped_gemm): 1.084
Speedup (bmm / grouped_gemm): 0.793

======================
TFLOPS (grouped_gemm): 63.157
TFLOPS (nn.Linear): 45.677
TFLOPS (a @ b): 58.285
TFLOPS (bmm): 79.650

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 209.115 μs

======================
Average nn.Linear time: 200.596 μs
Average a @ b time: 193.253 μs
Average bmm time: 201.437 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.959
Speedup (a @ b / grouped_gemm): 0.924
Speedup (bmm / grouped_gemm): 0.963

======================
TFLOPS (grouped_gemm): 82.155
TFLOPS (nn.Linear): 85.644
TFLOPS (a @ b): 88.899
TFLOPS (bmm): 85.286

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 345.376 μs

======================
Average nn.Linear time: 396.652 μs
Average a @ b time: 405.581 μs
Average bmm time: 292.606 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.148
Speedup (a @ b / grouped_gemm): 1.174
Speedup (bmm / grouped_gemm): 0.847

======================
TFLOPS (grouped_gemm): 99.485
TFLOPS (nn.Linear): 86.624
TFLOPS (a @ b): 84.717
TFLOPS (bmm): 117.426

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 580.058 μs

======================
Average nn.Linear time: 539.141 μs
Average a @ b time: 538.943 μs
Average bmm time: 516.603 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.929
Speedup (a @ b / grouped_gemm): 0.929
Speedup (bmm / grouped_gemm): 0.891

======================
TFLOPS (grouped_gemm): 103.661
TFLOPS (nn.Linear): 111.528
TFLOPS (a @ b): 111.569
TFLOPS (bmm): 116.394

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 101.602 μs

======================
Average nn.Linear time: 188.391 μs
Average a @ b time: 130.050 μs
Average bmm time: 55.490 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.854
Speedup (a @ b / grouped_gemm): 1.280
Speedup (bmm / grouped_gemm): 0.546

======================
TFLOPS (grouped_gemm): 63.409
TFLOPS (nn.Linear): 34.197
TFLOPS (a @ b): 49.538
TFLOPS (bmm): 116.102

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 145.266 μs

======================
Average nn.Linear time: 183.949 μs
Average a @ b time: 139.692 μs
Average bmm time: 77.784 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.266
Speedup (a @ b / grouped_gemm): 0.962
Speedup (bmm / grouped_gemm): 0.535

======================
TFLOPS (grouped_gemm): 88.699
TFLOPS (nn.Linear): 70.046
TFLOPS (a @ b): 92.238
TFLOPS (bmm): 165.650

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 189.769 μs

======================
Average nn.Linear time: 202.250 μs
Average a @ b time: 194.371 μs
Average bmm time: 132.673 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.066
Speedup (a @ b / grouped_gemm): 1.024
Speedup (bmm / grouped_gemm): 0.699

======================
TFLOPS (grouped_gemm): 135.795
TFLOPS (nn.Linear): 127.415
TFLOPS (a @ b): 132.581
TFLOPS (bmm): 194.236

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 283.997 μs

======================
Average nn.Linear time: 289.030 μs
Average a @ b time: 283.089 μs
Average bmm time: 238.063 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.018
Speedup (a @ b / grouped_gemm): 0.997
Speedup (bmm / grouped_gemm): 0.838

======================
TFLOPS (grouped_gemm): 181.479
TFLOPS (nn.Linear): 178.319
TFLOPS (a @ b): 182.062
TFLOPS (bmm): 216.495

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 536.528 μs

======================
Average nn.Linear time: 545.981 μs
Average a @ b time: 546.279 μs
Average bmm time: 460.167 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.018
Speedup (a @ b / grouped_gemm): 1.018
Speedup (bmm / grouped_gemm): 0.858

======================
TFLOPS (grouped_gemm): 192.123
TFLOPS (nn.Linear): 188.796
TFLOPS (a @ b): 188.693
TFLOPS (bmm): 224.004

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 1003.301 μs

======================
Average nn.Linear time: 1020.613 μs
Average a @ b time: 1034.319 μs
Average bmm time: 924.127 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.017
Speedup (a @ b / grouped_gemm): 1.031
Speedup (bmm / grouped_gemm): 0.921

======================
TFLOPS (grouped_gemm): 205.480
TFLOPS (nn.Linear): 201.995
TFLOPS (a @ b): 199.318
TFLOPS (bmm): 223.084

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 1760.588 μs

======================
Average nn.Linear time: 1714.649 μs
Average a @ b time: 1712.284 μs
Average bmm time: 1648.433 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.974
Speedup (a @ b / grouped_gemm): 0.973
Speedup (bmm / grouped_gemm): 0.936

======================
TFLOPS (grouped_gemm): 204.919
TFLOPS (nn.Linear): 210.409
TFLOPS (a @ b): 210.699
TFLOPS (bmm): 218.861

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 268.424 μs

======================
Average nn.Linear time: 303.872 μs
Average a @ b time: 293.276 μs
Average bmm time: 184.677 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.132
Speedup (a @ b / grouped_gemm): 1.093
Speedup (bmm / grouped_gemm): 0.688

======================
TFLOPS (grouped_gemm): 128.006
TFLOPS (nn.Linear): 113.073
TFLOPS (a @ b): 117.158
TFLOPS (bmm): 186.054

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 466.764 μs

======================
Average nn.Linear time: 435.882 μs
Average a @ b time: 430.033 μs
Average bmm time: 297.508 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.934
Speedup (a @ b / grouped_gemm): 0.921
Speedup (bmm / grouped_gemm): 0.637

======================
TFLOPS (grouped_gemm): 147.225
TFLOPS (nn.Linear): 157.656
TFLOPS (a @ b): 159.800
TFLOPS (bmm): 230.983

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 693.440 μs

======================
Average nn.Linear time: 772.693 μs
Average a @ b time: 764.813 μs
Average bmm time: 578.661 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.114
Speedup (a @ b / grouped_gemm): 1.103
Speedup (bmm / grouped_gemm): 0.834

======================
TFLOPS (grouped_gemm): 198.199
TFLOPS (nn.Linear): 177.870
TFLOPS (a @ b): 179.703
TFLOPS (bmm): 237.512

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 1167.533 μs

======================
Average nn.Linear time: 1274.862 μs
Average a @ b time: 1268.737 μs
Average bmm time: 1122.108 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.092
Speedup (a @ b / grouped_gemm): 1.087
Speedup (bmm / grouped_gemm): 0.961

======================
TFLOPS (grouped_gemm): 235.435
TFLOPS (nn.Linear): 215.614
TFLOPS (a @ b): 216.655
TFLOPS (bmm): 244.966

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 2298.832 μs

======================
Average nn.Linear time: 2375.581 μs
Average a @ b time: 2390.428 μs
Average bmm time: 2271.972 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.033
Speedup (a @ b / grouped_gemm): 1.040
Speedup (bmm / grouped_gemm): 0.988

======================
TFLOPS (grouped_gemm): 239.146
TFLOPS (nn.Linear): 231.419
TFLOPS (a @ b): 229.982
TFLOPS (bmm): 241.973

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 3160.12 MB
Max memory reserved: 4132.00 MB
Average grouped_gemm time: 4393.573 μs

======================
Average nn.Linear time: 4964.392 μs
Average a @ b time: 4931.419 μs
Average bmm time: 5428.641 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.130
Speedup (a @ b / grouped_gemm): 1.122
Speedup (bmm / grouped_gemm): 1.236

======================
TFLOPS (grouped_gemm): 250.255
TFLOPS (nn.Linear): 221.480
TFLOPS (a @ b): 222.961
TFLOPS (bmm): 202.539

--------------------------------------------------

Parameters: batch_size=1, sequence_length=2048, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 4408.12 MB
Max memory reserved: 5028.00 MB
Average grouped_gemm time: 7960.026 μs

======================
Average nn.Linear time: 8427.265 μs
Average a @ b time: 8438.745 μs
Average bmm time: 10068.457 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.059
Speedup (a @ b / grouped_gemm): 1.060
Speedup (bmm / grouped_gemm): 1.265

======================
TFLOPS (grouped_gemm): 241.726
TFLOPS (nn.Linear): 228.324
TFLOPS (a @ b): 228.013
TFLOPS (bmm): 191.106

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 4408.12 MB
Max memory reserved: 5028.00 MB
Average grouped_gemm time: 91.209 μs

======================
Average nn.Linear time: 188.012 μs
Average a @ b time: 111.339 μs
Average bmm time: 45.035 μs

======================
Speedup (nn.Linear / grouped_gemm): 2.061
Speedup (a @ b / grouped_gemm): 1.221
Speedup (bmm / grouped_gemm): 0.494

======================
TFLOPS (grouped_gemm): 23.545
TFLOPS (nn.Linear): 11.422
TFLOPS (a @ b): 19.288
TFLOPS (bmm): 47.685

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 4408.12 MB
Max memory reserved: 5028.00 MB
Average grouped_gemm time: 102.406 μs

======================
Average nn.Linear time: 146.968 μs
Average a @ b time: 111.668 μs
Average bmm time: 65.553 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.435
Speedup (a @ b / grouped_gemm): 1.090
Speedup (bmm / grouped_gemm): 0.640

======================
TFLOPS (grouped_gemm): 41.941
TFLOPS (nn.Linear): 29.224
TFLOPS (a @ b): 38.462
TFLOPS (bmm): 65.519

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 4408.12 MB
Max memory reserved: 5028.00 MB
Average grouped_gemm time: 140.872 μs

======================
Average nn.Linear time: 194.402 μs
Average a @ b time: 188.146 μs
Average bmm time: 108.097 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.380
Speedup (a @ b / grouped_gemm): 1.336
Speedup (bmm / grouped_gemm): 0.767

======================
TFLOPS (grouped_gemm): 60.977
TFLOPS (nn.Linear): 44.187
TFLOPS (a @ b): 45.656
TFLOPS (bmm): 79.465

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 4408.12 MB
Max memory reserved: 5028.00 MB
Average grouped_gemm time: 205.793 μs

======================
Average nn.Linear time: 201.256 μs
Average a @ b time: 194.576 μs
Average bmm time: 201.483 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.978
Speedup (a @ b / grouped_gemm): 0.945
Speedup (bmm / grouped_gemm): 0.979

======================
TFLOPS (grouped_gemm): 83.481
TFLOPS (nn.Linear): 85.363
TFLOPS (a @ b): 88.294
TFLOPS (bmm): 85.267

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 4408.12 MB
Max memory reserved: 5028.00 MB
Average grouped_gemm time: 341.241 μs

======================
Average nn.Linear time: 398.695 μs
Average a @ b time: 400.314 μs
Average bmm time: 381.987 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.168
Speedup (a @ b / grouped_gemm): 1.173
Speedup (bmm / grouped_gemm): 1.119

======================
TFLOPS (grouped_gemm): 100.690
TFLOPS (nn.Linear): 86.180
TFLOPS (a @ b): 85.832
TFLOPS (bmm): 89.950

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 4408.12 MB
Max memory reserved: 5028.00 MB
Average grouped_gemm time: 626.476 μs

======================
Average nn.Linear time: 608.816 μs
Average a @ b time: 606.997 μs
Average bmm time: 582.273 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.972
Speedup (a @ b / grouped_gemm): 0.969
Speedup (bmm / grouped_gemm): 0.929

======================
TFLOPS (grouped_gemm): 109.692
TFLOPS (nn.Linear): 112.874
TFLOPS (a @ b): 113.212
TFLOPS (bmm): 118.019

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 4563.62 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 1088.593 μs

======================
Average nn.Linear time: 999.889 μs
Average a @ b time: 1008.658 μs
Average bmm time: 1023.140 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.919
Speedup (a @ b / grouped_gemm): 0.927
Speedup (bmm / grouped_gemm): 0.940

======================
TFLOPS (grouped_gemm): 110.472
TFLOPS (nn.Linear): 120.272
TFLOPS (a @ b): 119.227
TFLOPS (bmm): 117.539

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 4563.62 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 152.810 μs

======================
Average nn.Linear time: 188.191 μs
Average a @ b time: 147.455 μs
Average bmm time: 83.470 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.232
Speedup (a @ b / grouped_gemm): 0.965
Speedup (bmm / grouped_gemm): 0.546

======================
TFLOPS (grouped_gemm): 84.320
TFLOPS (nn.Linear): 68.467
TFLOPS (a @ b): 87.382
TFLOPS (bmm): 154.365

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 4563.62 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 193.930 μs

======================
Average nn.Linear time: 206.809 μs
Average a @ b time: 199.256 μs
Average bmm time: 135.629 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.066
Speedup (a @ b / grouped_gemm): 1.027
Speedup (bmm / grouped_gemm): 0.699

======================
TFLOPS (grouped_gemm): 132.882
TFLOPS (nn.Linear): 124.607
TFLOPS (a @ b): 129.330
TFLOPS (bmm): 190.002

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 4563.62 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 290.160 μs

======================
Average nn.Linear time: 338.807 μs
Average a @ b time: 331.199 μs
Average bmm time: 237.155 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.168
Speedup (a @ b / grouped_gemm): 1.141
Speedup (bmm / grouped_gemm): 0.817

======================
TFLOPS (grouped_gemm): 177.625
TFLOPS (nn.Linear): 152.121
TFLOPS (a @ b): 155.615
TFLOPS (bmm): 217.325

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 4563.62 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 541.975 μs

======================
Average nn.Linear time: 531.256 μs
Average a @ b time: 536.439 μs
Average bmm time: 465.133 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.980
Speedup (a @ b / grouped_gemm): 0.990
Speedup (bmm / grouped_gemm): 0.858

======================
TFLOPS (grouped_gemm): 190.192
TFLOPS (nn.Linear): 194.029
TFLOPS (a @ b): 192.154
TFLOPS (bmm): 221.612

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 4563.62 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 1006.849 μs

======================
Average nn.Linear time: 1006.238 μs
Average a @ b time: 1011.682 μs
Average bmm time: 926.156 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.999
Speedup (a @ b / grouped_gemm): 1.005
Speedup (bmm / grouped_gemm): 0.920

======================
TFLOPS (grouped_gemm): 204.756
TFLOPS (nn.Linear): 204.880
TFLOPS (a @ b): 203.778
TFLOPS (bmm): 222.596

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 4563.62 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 1957.107 μs

======================
Average nn.Linear time: 1930.521 μs
Average a @ b time: 1957.412 μs
Average bmm time: 1850.505 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.986
Speedup (a @ b / grouped_gemm): 1.000
Speedup (bmm / grouped_gemm): 0.946

======================
TFLOPS (grouped_gemm): 210.677
TFLOPS (nn.Linear): 213.578
TFLOPS (a @ b): 210.644
TFLOPS (bmm): 222.813

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 4943.12 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 3435.295 μs

======================
Average nn.Linear time: 3360.863 μs
Average a @ b time: 3369.639 μs
Average bmm time: 3298.936 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.978
Speedup (a @ b / grouped_gemm): 0.981
Speedup (bmm / grouped_gemm): 0.960

======================
TFLOPS (grouped_gemm): 210.042
TFLOPS (nn.Linear): 214.693
TFLOPS (a @ b): 214.134
TFLOPS (bmm): 218.723

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 4943.12 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 483.057 μs

======================
Average nn.Linear time: 462.587 μs
Average a @ b time: 457.332 μs
Average bmm time: 327.146 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.958
Speedup (a @ b / grouped_gemm): 0.947
Speedup (bmm / grouped_gemm): 0.677

======================
TFLOPS (grouped_gemm): 142.259
TFLOPS (nn.Linear): 148.555
TFLOPS (a @ b): 150.262
TFLOPS (bmm): 210.057

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 4943.12 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 701.759 μs

======================
Average nn.Linear time: 788.045 μs
Average a @ b time: 783.041 μs
Average bmm time: 588.887 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.123
Speedup (a @ b / grouped_gemm): 1.116
Speedup (bmm / grouped_gemm): 0.839

======================
TFLOPS (grouped_gemm): 195.849
TFLOPS (nn.Linear): 174.405
TFLOPS (a @ b): 175.520
TFLOPS (bmm): 233.388

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 4943.12 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 1181.395 μs

======================
Average nn.Linear time: 1286.812 μs
Average a @ b time: 1291.440 μs
Average bmm time: 1135.764 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.089
Speedup (a @ b / grouped_gemm): 1.093
Speedup (bmm / grouped_gemm): 0.961

======================
TFLOPS (grouped_gemm): 232.672
TFLOPS (nn.Linear): 213.612
TFLOPS (a @ b): 212.846
TFLOPS (bmm): 242.020

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 4943.12 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 2290.840 μs

======================
Average nn.Linear time: 2390.687 μs
Average a @ b time: 2407.634 μs
Average bmm time: 2273.371 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.044
Speedup (a @ b / grouped_gemm): 1.051
Speedup (bmm / grouped_gemm): 0.992

======================
TFLOPS (grouped_gemm): 239.980
TFLOPS (nn.Linear): 229.957
TFLOPS (a @ b): 228.339
TFLOPS (bmm): 241.824

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 4943.12 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 4353.805 μs

======================
Average nn.Linear time: 4659.073 μs
Average a @ b time: 4566.619 μs
Average bmm time: 4540.622 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.070
Speedup (a @ b / grouped_gemm): 1.049
Speedup (bmm / grouped_gemm): 1.043

======================
TFLOPS (grouped_gemm): 252.540
TFLOPS (nn.Linear): 235.994
TFLOPS (a @ b): 240.771
TFLOPS (bmm): 242.150

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 4943.12 MB
Max memory reserved: 6148.00 MB
Average grouped_gemm time: 8791.540 μs

======================
Average nn.Linear time: 9098.969 μs
Average a @ b time: 9097.064 μs
Average bmm time: 10942.729 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.035
Speedup (a @ b / grouped_gemm): 1.035
Speedup (bmm / grouped_gemm): 1.245

======================
TFLOPS (grouped_gemm): 250.129
TFLOPS (nn.Linear): 241.678
TFLOPS (a @ b): 241.729
TFLOPS (bmm): 200.957

--------------------------------------------------

Parameters: batch_size=1, sequence_length=4096, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 6904.12 MB
Max memory reserved: 8836.00 MB
Average grouped_gemm time: 15749.986 μs

======================
Average nn.Linear time: 16459.868 μs
Average a @ b time: 16444.550 μs
Average bmm time: 20153.155 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.045
Speedup (a @ b / grouped_gemm): 1.044
Speedup (bmm / grouped_gemm): 1.280

======================
TFLOPS (grouped_gemm): 244.336
TFLOPS (nn.Linear): 233.798
TFLOPS (a @ b): 234.016
TFLOPS (bmm): 190.952

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 6904.12 MB
Max memory reserved: 8836.00 MB
Average grouped_gemm time: 110.650 μs

======================
Average nn.Linear time: 151.381 μs
Average a @ b time: 109.096 μs
Average bmm time: 60.129 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.368
Speedup (a @ b / grouped_gemm): 0.986
Speedup (bmm / grouped_gemm): 0.543

======================
TFLOPS (grouped_gemm): 38.816
TFLOPS (nn.Linear): 28.372
TFLOPS (a @ b): 39.369
TFLOPS (bmm): 71.429

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 6904.12 MB
Max memory reserved: 8836.00 MB
Average grouped_gemm time: 138.226 μs

======================
Average nn.Linear time: 191.443 μs
Average a @ b time: 155.137 μs
Average bmm time: 91.860 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.385
Speedup (a @ b / grouped_gemm): 1.122
Speedup (bmm / grouped_gemm): 0.665

======================
TFLOPS (grouped_gemm): 62.144
TFLOPS (nn.Linear): 44.869
TFLOPS (a @ b): 55.370
TFLOPS (bmm): 93.511

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 6904.12 MB
Max memory reserved: 8836.00 MB
Average grouped_gemm time: 213.089 μs

======================
Average nn.Linear time: 215.178 μs
Average a @ b time: 208.383 μs
Average bmm time: 155.880 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.010
Speedup (a @ b / grouped_gemm): 0.978
Speedup (bmm / grouped_gemm): 0.732

======================
TFLOPS (grouped_gemm): 80.623
TFLOPS (nn.Linear): 79.840
TFLOPS (a @ b): 82.444
TFLOPS (bmm): 110.212

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 6904.12 MB
Max memory reserved: 8836.00 MB
Average grouped_gemm time: 333.269 μs

======================
Average nn.Linear time: 336.883 μs
Average a @ b time: 331.609 μs
Average bmm time: 297.942 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.011
Speedup (a @ b / grouped_gemm): 0.995
Speedup (bmm / grouped_gemm): 0.894

======================
TFLOPS (grouped_gemm): 103.099
TFLOPS (nn.Linear): 101.993
TFLOPS (a @ b): 103.615
TFLOPS (bmm): 115.324

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 6904.12 MB
Max memory reserved: 8836.00 MB
Average grouped_gemm time: 628.450 μs

======================
Average nn.Linear time: 766.308 μs
Average a @ b time: 776.474 μs
Average bmm time: 581.965 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.219
Speedup (a @ b / grouped_gemm): 1.236
Speedup (bmm / grouped_gemm): 0.926

======================
TFLOPS (grouped_gemm): 109.348
TFLOPS (nn.Linear): 89.676
TFLOPS (a @ b): 88.502
TFLOPS (bmm): 118.082

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 6904.12 MB
Max memory reserved: 10884.00 MB
Average grouped_gemm time: 1196.768 μs

======================
Average nn.Linear time: 1485.865 μs
Average a @ b time: 1502.748 μs
Average bmm time: 1192.808 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.242
Speedup (a @ b / grouped_gemm): 1.256
Speedup (bmm / grouped_gemm): 0.997

======================
TFLOPS (grouped_gemm): 114.842
TFLOPS (nn.Linear): 92.498
TFLOPS (a @ b): 91.458
TFLOPS (bmm): 115.223

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 9059.62 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 2108.057 μs

======================
Average nn.Linear time: 2491.207 μs
Average a @ b time: 2520.640 μs
Average bmm time: 2031.100 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.182
Speedup (a @ b / grouped_gemm): 1.196
Speedup (bmm / grouped_gemm): 0.963

======================
TFLOPS (grouped_gemm): 114.095
TFLOPS (nn.Linear): 96.547
TFLOPS (a @ b): 95.419
TFLOPS (bmm): 118.418

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 9059.62 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 206.878 μs

======================
Average nn.Linear time: 239.847 μs
Average a @ b time: 233.073 μs
Average bmm time: 138.478 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.159
Speedup (a @ b / grouped_gemm): 1.127
Speedup (bmm / grouped_gemm): 0.669

======================
TFLOPS (grouped_gemm): 124.565
TFLOPS (nn.Linear): 107.443
TFLOPS (a @ b): 110.565
TFLOPS (bmm): 186.093

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 9059.62 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 295.210 μs

======================
Average nn.Linear time: 345.328 μs
Average a @ b time: 339.715 μs
Average bmm time: 243.733 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.170
Speedup (a @ b / grouped_gemm): 1.151
Speedup (bmm / grouped_gemm): 0.826

======================
TFLOPS (grouped_gemm): 174.586
TFLOPS (nn.Linear): 149.248
TFLOPS (a @ b): 151.714
TFLOPS (bmm): 211.459

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 9059.62 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 534.830 μs

======================
Average nn.Linear time: 630.436 μs
Average a @ b time: 616.152 μs
Average bmm time: 467.331 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.179
Speedup (a @ b / grouped_gemm): 1.152
Speedup (bmm / grouped_gemm): 0.874

======================
TFLOPS (grouped_gemm): 192.733
TFLOPS (nn.Linear): 163.505
TFLOPS (a @ b): 167.295
TFLOPS (bmm): 220.570

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 9059.62 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 993.237 μs

======================
Average nn.Linear time: 1014.671 μs
Average a @ b time: 1018.929 μs
Average bmm time: 929.601 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.022
Speedup (a @ b / grouped_gemm): 1.026
Speedup (bmm / grouped_gemm): 0.936

======================
TFLOPS (grouped_gemm): 207.562
TFLOPS (nn.Linear): 203.178
TFLOPS (a @ b): 202.328
TFLOPS (bmm): 221.771

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 9059.62 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 1939.814 μs

======================
Average nn.Linear time: 1975.594 μs
Average a @ b time: 1976.233 μs
Average bmm time: 1850.717 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.018
Speedup (a @ b / grouped_gemm): 1.019
Speedup (bmm / grouped_gemm): 0.954

======================
TFLOPS (grouped_gemm): 212.555
TFLOPS (nn.Linear): 208.705
TFLOPS (a @ b): 208.638
TFLOPS (bmm): 222.788

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 9059.62 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 3845.229 μs

======================
Average nn.Linear time: 3812.566 μs
Average a @ b time: 3818.879 μs
Average bmm time: 3647.969 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.992
Speedup (a @ b / grouped_gemm): 0.993
Speedup (bmm / grouped_gemm): 0.949

======================
TFLOPS (grouped_gemm): 214.456
TFLOPS (nn.Linear): 216.294
TFLOPS (a @ b): 215.936
TFLOPS (bmm): 226.053

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 9518.12 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 6807.384 μs

======================
Average nn.Linear time: 6621.032 μs
Average a @ b time: 6600.084 μs
Average bmm time: 6619.415 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.973
Speedup (a @ b / grouped_gemm): 0.970
Speedup (bmm / grouped_gemm): 0.972

======================
TFLOPS (grouped_gemm): 211.992
TFLOPS (nn.Linear): 217.958
TFLOPS (a @ b): 218.650
TFLOPS (bmm): 218.012

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 9518.12 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 724.051 μs

======================
Average nn.Linear time: 802.386 μs
Average a @ b time: 797.331 μs
Average bmm time: 625.548 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.108
Speedup (a @ b / grouped_gemm): 1.101
Speedup (bmm / grouped_gemm): 0.864

======================
TFLOPS (grouped_gemm): 189.819
TFLOPS (nn.Linear): 171.288
TFLOPS (a @ b): 172.374
TFLOPS (bmm): 219.710

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 9518.12 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 1204.085 μs

======================
Average nn.Linear time: 1332.116 μs
Average a @ b time: 1334.105 μs
Average bmm time: 1202.078 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.106
Speedup (a @ b / grouped_gemm): 1.108
Speedup (bmm / grouped_gemm): 0.998

======================
TFLOPS (grouped_gemm): 228.288
TFLOPS (nn.Linear): 206.347
TFLOPS (a @ b): 206.039
TFLOPS (bmm): 228.669

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 9518.12 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 2306.602 μs

======================
Average nn.Linear time: 2472.959 μs
Average a @ b time: 2497.478 μs
Average bmm time: 2301.445 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.072
Speedup (a @ b / grouped_gemm): 1.083
Speedup (bmm / grouped_gemm): 0.998

======================
TFLOPS (grouped_gemm): 238.340
TFLOPS (nn.Linear): 222.307
TFLOPS (a @ b): 220.124
TFLOPS (bmm): 238.874

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 9518.12 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 4350.016 μs

======================
Average nn.Linear time: 4757.755 μs
Average a @ b time: 4672.778 μs
Average bmm time: 4550.369 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.094
Speedup (a @ b / grouped_gemm): 1.074
Speedup (bmm / grouped_gemm): 1.046

======================
TFLOPS (grouped_gemm): 252.760
TFLOPS (nn.Linear): 231.099
TFLOPS (a @ b): 235.302
TFLOPS (bmm): 241.631

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 9518.12 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 8734.543 μs

======================
Average nn.Linear time: 9158.533 μs
Average a @ b time: 9143.786 μs
Average bmm time: 9298.747 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.049
Speedup (a @ b / grouped_gemm): 1.047
Speedup (bmm / grouped_gemm): 1.065

======================
TFLOPS (grouped_gemm): 251.762
TFLOPS (nn.Linear): 240.107
TFLOPS (a @ b): 240.494
TFLOPS (bmm): 236.486

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 9518.12 MB
Max memory reserved: 14468.00 MB
Average grouped_gemm time: 17680.786 μs

======================
Average nn.Linear time: 17679.372 μs
Average a @ b time: 17676.811 μs
Average bmm time: 22126.243 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.000
Speedup (a @ b / grouped_gemm): 1.000
Speedup (bmm / grouped_gemm): 1.251

======================
TFLOPS (grouped_gemm): 248.747
TFLOPS (nn.Linear): 248.767
TFLOPS (a @ b): 248.803
TFLOPS (bmm): 198.771

--------------------------------------------------

Parameters: batch_size=1, sequence_length=8192, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 11896.12 MB
Max memory reserved: 16260.00 MB
Average grouped_gemm time: 31522.591 μs

======================
Average nn.Linear time: 32929.726 μs
Average a @ b time: 32895.391 μs
Average bmm time: 40323.806 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.045
Speedup (a @ b / grouped_gemm): 1.044
Speedup (bmm / grouped_gemm): 1.279

======================
TFLOPS (grouped_gemm): 244.161
TFLOPS (nn.Linear): 233.727
TFLOPS (a @ b): 233.971
TFLOPS (bmm): 190.869

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 11896.12 MB
Max memory reserved: 16260.00 MB
Average grouped_gemm time: 148.108 μs

======================
Average nn.Linear time: 171.306 μs
Average a @ b time: 161.884 μs
Average bmm time: 96.343 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.157
Speedup (a @ b / grouped_gemm): 1.093
Speedup (bmm / grouped_gemm): 0.650

======================
TFLOPS (grouped_gemm): 57.998
TFLOPS (nn.Linear): 50.144
TFLOPS (a @ b): 53.062
TFLOPS (bmm): 89.160

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 11896.12 MB
Max memory reserved: 16260.00 MB
Average grouped_gemm time: 217.144 μs

======================
Average nn.Linear time: 220.110 μs
Average a @ b time: 214.114 μs
Average bmm time: 160.258 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.014
Speedup (a @ b / grouped_gemm): 0.986
Speedup (bmm / grouped_gemm): 0.738

======================
TFLOPS (grouped_gemm): 79.117
TFLOPS (nn.Linear): 78.051
TFLOPS (a @ b): 80.237
TFLOPS (bmm): 107.201

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 11896.12 MB
Max memory reserved: 16260.00 MB
Average grouped_gemm time: 348.399 μs

======================
Average nn.Linear time: 350.106 μs
Average a @ b time: 343.266 μs
Average bmm time: 300.736 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.005
Speedup (a @ b / grouped_gemm): 0.985
Speedup (bmm / grouped_gemm): 0.863

======================
TFLOPS (grouped_gemm): 98.622
TFLOPS (nn.Linear): 98.141
TFLOPS (a @ b): 100.097
TFLOPS (bmm): 114.252

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 11896.12 MB
Max memory reserved: 16260.00 MB
Average grouped_gemm time: 612.228 μs

======================
Average nn.Linear time: 794.713 μs
Average a @ b time: 791.230 μs
Average bmm time: 586.300 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.298
Speedup (a @ b / grouped_gemm): 1.292
Speedup (bmm / grouped_gemm): 0.958

======================
TFLOPS (grouped_gemm): 112.245
TFLOPS (nn.Linear): 86.471
TFLOPS (a @ b): 86.851
TFLOPS (bmm): 117.209

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 11896.12 MB
Max memory reserved: 16260.00 MB
Average grouped_gemm time: 1193.194 μs

======================
Average nn.Linear time: 1470.017 μs
Average a @ b time: 1478.159 μs
Average bmm time: 1181.386 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.232
Speedup (a @ b / grouped_gemm): 1.239
Speedup (bmm / grouped_gemm): 0.990

======================
TFLOPS (grouped_gemm): 115.186
TFLOPS (nn.Linear): 93.495
TFLOPS (a @ b): 92.980
TFLOPS (bmm): 116.337

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 11896.12 MB
Max memory reserved: 20356.00 MB
Average grouped_gemm time: 2368.405 μs

======================
Average nn.Linear time: 2877.104 μs
Average a @ b time: 2923.050 μs
Average bmm time: 2379.103 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.215
Speedup (a @ b / grouped_gemm): 1.234
Speedup (bmm / grouped_gemm): 1.005

======================
TFLOPS (grouped_gemm): 116.060
TFLOPS (nn.Linear): 95.540
TFLOPS (a @ b): 94.038
TFLOPS (bmm): 115.538

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 18052.50 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 4154.725 μs

======================
Average nn.Linear time: 4849.722 μs
Average a @ b time: 4847.159 μs
Average bmm time: 4049.852 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.167
Speedup (a @ b / grouped_gemm): 1.167
Speedup (bmm / grouped_gemm): 0.975

======================
TFLOPS (grouped_gemm): 115.781
TFLOPS (nn.Linear): 99.188
TFLOPS (a @ b): 99.241
TFLOPS (bmm): 118.779

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 18052.50 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 309.951 μs

======================
Average nn.Linear time: 361.691 μs
Average a @ b time: 357.039 μs
Average bmm time: 250.640 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.167
Speedup (a @ b / grouped_gemm): 1.152
Speedup (bmm / grouped_gemm): 0.809

======================
TFLOPS (grouped_gemm): 166.283
TFLOPS (nn.Linear): 142.496
TFLOPS (a @ b): 144.353
TFLOPS (bmm): 205.632

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 18052.50 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 556.443 μs

======================
Average nn.Linear time: 560.417 μs
Average a @ b time: 565.758 μs
Average bmm time: 485.113 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.007
Speedup (a @ b / grouped_gemm): 1.017
Speedup (bmm / grouped_gemm): 0.872

======================
TFLOPS (grouped_gemm): 185.247
TFLOPS (nn.Linear): 183.933
TFLOPS (a @ b): 182.197
TFLOPS (bmm): 212.485

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 18052.50 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 997.074 μs

======================
Average nn.Linear time: 1056.106 μs
Average a @ b time: 1052.144 μs
Average bmm time: 945.072 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.059
Speedup (a @ b / grouped_gemm): 1.055
Speedup (bmm / grouped_gemm): 0.948

======================
TFLOPS (grouped_gemm): 206.763
TFLOPS (nn.Linear): 195.206
TFLOPS (a @ b): 195.941
TFLOPS (bmm): 218.140

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 18052.50 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 1922.369 μs

======================
Average nn.Linear time: 1941.166 μs
Average a @ b time: 1949.072 μs
Average bmm time: 1852.455 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.010
Speedup (a @ b / grouped_gemm): 1.014
Speedup (bmm / grouped_gemm): 0.964

======================
TFLOPS (grouped_gemm): 214.484
TFLOPS (nn.Linear): 212.407
TFLOPS (a @ b): 211.545
TFLOPS (bmm): 222.579

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 18052.50 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 3822.484 μs

======================
Average nn.Linear time: 3769.369 μs
Average a @ b time: 3771.040 μs
Average bmm time: 3643.947 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.986
Speedup (a @ b / grouped_gemm): 0.987
Speedup (bmm / grouped_gemm): 0.953

======================
TFLOPS (grouped_gemm): 215.732
TFLOPS (nn.Linear): 218.772
TFLOPS (a @ b): 218.675
TFLOPS (bmm): 226.302

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 18052.50 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 7616.682 μs

======================
Average nn.Linear time: 7434.983 μs
Average a @ b time: 7396.386 μs
Average bmm time: 7329.674 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.976
Speedup (a @ b / grouped_gemm): 0.971
Speedup (bmm / grouped_gemm): 0.962

======================
TFLOPS (grouped_gemm): 216.534
TFLOPS (nn.Linear): 221.825
TFLOPS (a @ b): 222.983
TFLOPS (bmm): 225.012

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 18672.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 13512.430 μs

======================
Average nn.Linear time: 13287.299 μs
Average a @ b time: 13275.678 μs
Average bmm time: 13193.488 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.983
Speedup (a @ b / grouped_gemm): 0.982
Speedup (bmm / grouped_gemm): 0.976

======================
TFLOPS (grouped_gemm): 213.597
TFLOPS (nn.Linear): 217.216
TFLOPS (a @ b): 217.406
TFLOPS (bmm): 218.761

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 18672.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 1244.314 μs

======================
Average nn.Linear time: 1443.963 μs
Average a @ b time: 1450.400 μs
Average bmm time: 1250.503 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.160
Speedup (a @ b / grouped_gemm): 1.166
Speedup (bmm / grouped_gemm): 1.005

======================
TFLOPS (grouped_gemm): 220.907
TFLOPS (nn.Linear): 190.364
TFLOPS (a @ b): 189.519
TFLOPS (bmm): 219.814

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 18672.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 2363.780 μs

======================
Average nn.Linear time: 2540.016 μs
Average a @ b time: 2574.899 μs
Average bmm time: 2349.672 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.075
Speedup (a @ b / grouped_gemm): 1.089
Speedup (bmm / grouped_gemm): 0.994

======================
TFLOPS (grouped_gemm): 232.575
TFLOPS (nn.Linear): 216.438
TFLOPS (a @ b): 213.506
TFLOPS (bmm): 233.971

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 18672.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 4422.469 μs

======================
Average nn.Linear time: 4860.988 μs
Average a @ b time: 4851.682 μs
Average bmm time: 4514.427 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.099
Speedup (a @ b / grouped_gemm): 1.097
Speedup (bmm / grouped_gemm): 1.021

======================
TFLOPS (grouped_gemm): 248.619
TFLOPS (nn.Linear): 226.191
TFLOPS (a @ b): 226.625
TFLOPS (bmm): 243.555

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 18672.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 8705.595 μs

======================
Average nn.Linear time: 9185.755 μs
Average a @ b time: 9176.359 μs
Average bmm time: 9005.921 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.055
Speedup (a @ b / grouped_gemm): 1.054
Speedup (bmm / grouped_gemm): 1.034

======================
TFLOPS (grouped_gemm): 252.599
TFLOPS (nn.Linear): 239.395
TFLOPS (a @ b): 239.640
TFLOPS (bmm): 244.175

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 18672.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 17371.650 μs

======================
Average nn.Linear time: 17730.000 μs
Average a @ b time: 17708.905 μs
Average bmm time: 18717.084 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.021
Speedup (a @ b / grouped_gemm): 1.019
Speedup (bmm / grouped_gemm): 1.077

======================
TFLOPS (grouped_gemm): 253.174
TFLOPS (nn.Linear): 248.057
TFLOPS (a @ b): 248.352
TFLOPS (bmm): 234.975

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 18672.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 35524.194 μs

======================
Average nn.Linear time: 35290.704 μs
Average a @ b time: 35268.559 μs
Average bmm time: 44632.783 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.993
Speedup (a @ b / grouped_gemm): 0.993
Speedup (bmm / grouped_gemm): 1.256

======================
TFLOPS (grouped_gemm): 247.609
TFLOPS (nn.Linear): 249.247
TFLOPS (a @ b): 249.403
TFLOPS (bmm): 197.077

--------------------------------------------------

Parameters: batch_size=1, sequence_length=16384, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 21880.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 63369.179 μs

======================
Average nn.Linear time: 65372.093 μs
Average a @ b time: 65379.844 μs
Average bmm time: 80647.693 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.032
Speedup (a @ b / grouped_gemm): 1.032
Speedup (bmm / grouped_gemm): 1.273

======================
TFLOPS (grouped_gemm): 242.912
TFLOPS (nn.Linear): 235.470
TFLOPS (a @ b): 235.442
TFLOPS (bmm): 190.869

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=256
Iterations: 100
Max memory allocated: 21880.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 233.092 μs

======================
Average nn.Linear time: 249.939 μs
Average a @ b time: 240.810 μs
Average bmm time: 166.147 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.072
Speedup (a @ b / grouped_gemm): 1.033
Speedup (bmm / grouped_gemm): 0.713

======================
TFLOPS (grouped_gemm): 73.704
TFLOPS (nn.Linear): 68.736
TFLOPS (a @ b): 71.342
TFLOPS (bmm): 103.402

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=512
Iterations: 100
Max memory allocated: 21880.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 352.929 μs

======================
Average nn.Linear time: 421.929 μs
Average a @ b time: 412.524 μs
Average bmm time: 299.840 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.196
Speedup (a @ b / grouped_gemm): 1.169
Speedup (bmm / grouped_gemm): 0.850

======================
TFLOPS (grouped_gemm): 97.356
TFLOPS (nn.Linear): 81.435
TFLOPS (a @ b): 83.292
TFLOPS (bmm): 114.594

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=1024
Iterations: 100
Max memory allocated: 21880.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 636.163 μs

======================
Average nn.Linear time: 795.944 μs
Average a @ b time: 795.946 μs
Average bmm time: 592.136 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.251
Speedup (a @ b / grouped_gemm): 1.251
Speedup (bmm / grouped_gemm): 0.931

======================
TFLOPS (grouped_gemm): 108.022
TFLOPS (nn.Linear): 86.337
TFLOPS (a @ b): 86.337
TFLOPS (bmm): 116.053

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=2048
Iterations: 100
Max memory allocated: 21880.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 1170.988 μs

======================
Average nn.Linear time: 1502.161 μs
Average a @ b time: 1511.121 μs
Average bmm time: 1186.676 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.283
Speedup (a @ b / grouped_gemm): 1.290
Speedup (bmm / grouped_gemm): 1.013

======================
TFLOPS (grouped_gemm): 117.370
TFLOPS (nn.Linear): 91.494
TFLOPS (a @ b): 90.952
TFLOPS (bmm): 115.818

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=4096
Iterations: 100
Max memory allocated: 21880.12 MB
Max memory reserved: 27524.00 MB
Average grouped_gemm time: 2348.082 μs

======================
Average nn.Linear time: 2866.726 μs
Average a @ b time: 2921.891 μs
Average bmm time: 2365.184 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.221
Speedup (a @ b / grouped_gemm): 1.244
Speedup (bmm / grouped_gemm): 1.007

======================
TFLOPS (grouped_gemm): 117.065
TFLOPS (nn.Linear): 95.886
TFLOPS (a @ b): 94.075
TFLOPS (bmm): 116.218

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=8192
Iterations: 100
Max memory allocated: 21880.12 MB
Max memory reserved: 35716.00 MB
Average grouped_gemm time: 4763.515 μs

======================
Average nn.Linear time: 5540.199 μs
Average a @ b time: 5537.117 μs
Average bmm time: 4741.638 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.163
Speedup (a @ b / grouped_gemm): 1.162
Speedup (bmm / grouped_gemm): 0.995

======================
TFLOPS (grouped_gemm): 115.410
TFLOPS (nn.Linear): 99.230
TFLOPS (a @ b): 99.286
TFLOPS (bmm): 115.942

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=128, ffn_dim=14336
Iterations: 100
Max memory allocated: 36037.50 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 8344.290 μs

======================
Average nn.Linear time: 9627.120 μs
Average a @ b time: 9637.041 μs
Average bmm time: 8083.930 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.154
Speedup (a @ b / grouped_gemm): 1.155
Speedup (bmm / grouped_gemm): 0.969

======================
TFLOPS (grouped_gemm): 115.297
TFLOPS (nn.Linear): 99.934
TFLOPS (a @ b): 99.831
TFLOPS (bmm): 119.011

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=256
Iterations: 100
Max memory allocated: 36037.50 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 574.038 μs

======================
Average nn.Linear time: 603.471 μs
Average a @ b time: 609.643 μs
Average bmm time: 510.650 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.051
Speedup (a @ b / grouped_gemm): 1.062
Speedup (bmm / grouped_gemm): 0.890

======================
TFLOPS (grouped_gemm): 179.569
TFLOPS (nn.Linear): 170.811
TFLOPS (a @ b): 169.081
TFLOPS (bmm): 201.859

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=512
Iterations: 100
Max memory allocated: 36037.50 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 1014.121 μs

======================
Average nn.Linear time: 1055.207 μs
Average a @ b time: 1066.656 μs
Average bmm time: 983.782 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.041
Speedup (a @ b / grouped_gemm): 1.052
Speedup (bmm / grouped_gemm): 0.970

======================
TFLOPS (grouped_gemm): 203.288
TFLOPS (nn.Linear): 195.372
TFLOPS (a @ b): 193.275
TFLOPS (bmm): 209.557

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=1024
Iterations: 100
Max memory allocated: 36037.50 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 1945.560 μs

======================
Average nn.Linear time: 2064.767 μs
Average a @ b time: 2058.303 μs
Average bmm time: 1907.945 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.061
Speedup (a @ b / grouped_gemm): 1.058
Speedup (bmm / grouped_gemm): 0.981

======================
TFLOPS (grouped_gemm): 211.927
TFLOPS (nn.Linear): 199.692
TFLOPS (a @ b): 200.319
TFLOPS (bmm): 216.105

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=2048
Iterations: 100
Max memory allocated: 36037.50 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 3783.007 μs

======================
Average nn.Linear time: 3785.162 μs
Average a @ b time: 3800.669 μs
Average bmm time: 3704.152 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.001
Speedup (a @ b / grouped_gemm): 1.005
Speedup (bmm / grouped_gemm): 0.979

======================
TFLOPS (grouped_gemm): 217.984
TFLOPS (nn.Linear): 217.860
TFLOPS (a @ b): 216.971
TFLOPS (bmm): 222.624

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=4096
Iterations: 100
Max memory allocated: 36037.50 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 7615.576 μs

======================
Average nn.Linear time: 7403.142 μs
Average a @ b time: 7405.078 μs
Average bmm time: 7307.613 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.972
Speedup (a @ b / grouped_gemm): 0.972
Speedup (bmm / grouped_gemm): 0.960

======================
TFLOPS (grouped_gemm): 216.565
TFLOPS (nn.Linear): 222.779
TFLOPS (a @ b): 222.721
TFLOPS (bmm): 225.692

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=8192
Iterations: 100
Max memory allocated: 36037.50 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 15181.479 μs

======================
Average nn.Linear time: 14711.299 μs
Average a @ b time: 14714.711 μs
Average bmm time: 14592.252 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.969
Speedup (a @ b / grouped_gemm): 0.969
Speedup (bmm / grouped_gemm): 0.961

======================
TFLOPS (grouped_gemm): 217.274
TFLOPS (nn.Linear): 224.218
TFLOPS (a @ b): 224.166
TFLOPS (bmm): 226.047

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=768, ffn_dim=14336
Iterations: 100
Max memory allocated: 36975.12 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 26849.062 μs

======================
Average nn.Linear time: 26458.776 μs
Average a @ b time: 26404.729 μs
Average bmm time: 26394.989 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.985
Speedup (a @ b / grouped_gemm): 0.983
Speedup (bmm / grouped_gemm): 0.983

======================
TFLOPS (grouped_gemm): 214.996
TFLOPS (nn.Linear): 218.167
TFLOPS (a @ b): 218.614
TFLOPS (bmm): 218.694

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=256
Iterations: 100
Max memory allocated: 36975.12 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 2451.129 μs

======================
Average nn.Linear time: 2681.184 μs
Average a @ b time: 2708.733 μs
Average bmm time: 2449.410 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.094
Speedup (a @ b / grouped_gemm): 1.105
Speedup (bmm / grouped_gemm): 0.999

======================
TFLOPS (grouped_gemm): 224.287
TFLOPS (nn.Linear): 205.042
TFLOPS (a @ b): 202.957
TFLOPS (bmm): 224.444

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=512
Iterations: 100
Max memory allocated: 36975.12 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 4503.450 μs

======================
Average nn.Linear time: 4769.402 μs
Average a @ b time: 4714.687 μs
Average bmm time: 4681.673 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.059
Speedup (a @ b / grouped_gemm): 1.047
Speedup (bmm / grouped_gemm): 1.040

======================
TFLOPS (grouped_gemm): 244.149
TFLOPS (nn.Linear): 230.535
TFLOPS (a @ b): 233.210
TFLOPS (bmm): 234.854

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=1024
Iterations: 100
Max memory allocated: 36975.12 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 8829.410 μs

======================
Average nn.Linear time: 9165.006 μs
Average a @ b time: 9143.653 μs
Average bmm time: 8985.178 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.038
Speedup (a @ b / grouped_gemm): 1.036
Speedup (bmm / grouped_gemm): 1.018

======================
TFLOPS (grouped_gemm): 249.057
TFLOPS (nn.Linear): 239.937
TFLOPS (a @ b): 240.497
TFLOPS (bmm): 244.739

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=2048
Iterations: 100
Max memory allocated: 36975.12 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 17318.592 μs

======================
Average nn.Linear time: 17690.032 μs
Average a @ b time: 17665.596 μs
Average bmm time: 17978.883 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.021
Speedup (a @ b / grouped_gemm): 1.020
Speedup (bmm / grouped_gemm): 1.038

======================
TFLOPS (grouped_gemm): 253.949
TFLOPS (nn.Linear): 248.617
TFLOPS (a @ b): 248.961
TFLOPS (bmm): 244.623

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=4096
Iterations: 100
Max memory allocated: 36975.12 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 35284.498 μs

======================
Average nn.Linear time: 35340.579 μs
Average a @ b time: 35335.262 μs
Average bmm time: 37521.591 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.002
Speedup (a @ b / grouped_gemm): 1.001
Speedup (bmm / grouped_gemm): 1.063

======================
TFLOPS (grouped_gemm): 249.291
TFLOPS (nn.Linear): 248.895
TFLOPS (a @ b): 248.932
TFLOPS (bmm): 234.428

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=8192
Iterations: 100
Max memory allocated: 36975.12 MB
Max memory reserved: 50052.00 MB
Average grouped_gemm time: 71913.023 μs

======================
Average nn.Linear time: 70237.544 μs
Average a @ b time: 70193.093 μs
Average bmm time: 89561.565 μs

======================
Speedup (nn.Linear / grouped_gemm): 0.977
Speedup (a @ b / grouped_gemm): 0.976
Speedup (bmm / grouped_gemm): 1.245

======================
TFLOPS (grouped_gemm): 244.631
TFLOPS (nn.Linear): 250.467
TFLOPS (a @ b): 250.626
TFLOPS (bmm): 196.426

--------------------------------------------------

Parameters: batch_size=1, sequence_length=32768, hidden_size=4096, ffn_dim=14336
Iterations: 100
Max memory allocated: 41848.12 MB
Max memory reserved: 57220.00 MB
Average grouped_gemm time: 127029.653 μs

======================
Average nn.Linear time: 130341.132 μs
Average a @ b time: 130384.619 μs
Average bmm time: 161307.733 μs

======================
Speedup (nn.Linear / grouped_gemm): 1.026
Speedup (a @ b / grouped_gemm): 1.026
Speedup (bmm / grouped_gemm): 1.270

======================
TFLOPS (grouped_gemm): 242.355
TFLOPS (nn.Linear): 236.198
TFLOPS (a @ b): 236.119
TFLOPS (bmm): 190.855

--------------------------------------------------

